SELECT [Status]='A' And [Win_EXN]<>0 And Not ([Win_Exn]>=95 And [Win_EXN]<=100) And AwardPrize.Type<>'S' AS WinnersOnly, FixWinExn([TEAM],[TeamEx],[xAwards Linked Data (All)].[EXN],[Stud_Num],[F_ORD]) AS Win_EXN, FixWinExn([TEAM],[TeamEx],[xAwards Linked Data (All)].[EXN],[Stud_Num],[F_ORD]) AS EXN, IIf([Win_EXN]>100,IIf([xAwards Linked Data (All)].TYPE='T',[ThSAL],[SAL]),[SWSAL]) AS WinSAL, IIf([Win_EXN]>100,IIf([xAwards Linked Data (All)].TYPE='T',[ThFN],Persons.FNAME),[SWFN]) AS WinFN, IIf([Win_EXN]>100,IIf([xAwards Linked Data (All)].TYPE='T',[ThMI],Persons.MI),[SWMI]) AS WinMI, IIf([Win_EXN]>100,IIf([xAwards Linked Data (All)].TYPE='T',[ThLN],Persons.LNAME),[SWLN]) AS WinLN, IIf(IsNull([WinLN])," N/A ",[WinLN] & ", ") & IIf(IsNull([WinSAL]),"",[WinSAL] & " ") & [WinFN] & IIf(IsNull([WinMI]),""," " & [WinMI]) AS WinNameLNFirst, IIf(IsNull([WinSAL]),"",[WinSAL] & " ") & [WinFN] & IIf(IsNull([WinMI]),""," " & [WinMI]) & IIf(IsNull([WinLN])," N/A "," " & [WinLN]) AS WinNameFNFirst, [WinNameLNFirst] & [Win_EXN] AS WinLNSort, [xAwards Linked Data (All)].AwardMaster.AN AS AwdAN, [xAwards Linked Data (All)].GrpGN, [xAwards Linked Data (All)].PrzGN, [xAwards Linked Data (All)].PrzAN, [xAwards Linked Data (All)].AwardMaster.AN, [xAwards Linked Data (All)].Status, [xAwards Linked Data (All)].Award_Name, [xAwards Linked Data (All)].Description, [xAwards Linked Data (All)].Sponsor, [xAwards Linked Data (All)].Level, [xAwards Linked Data (All)].Benefactor, [xAwards Linked Data (All)].C_Assem, [xAwards Linked Data (All)].C_Assem_Sort, [xAwards Linked Data (All)].[J/S_Assem_Sort], [xAwards Linked Data (All)].Alpha_Sort, [xAwards Linked Data (All)].AwardMaster.News_Sort, [xAwards Linked Data (All)].Judges, [xAwards Linked Data (All)].Paid_by, [xAwards Linked Data (All)].First_YR, [xAwards Linked Data (All)].Num_YR, [xAwards Linked Data (All)].Last_YR, [xAwards Linked Data (All)].Annual_Notes, [xAwards Linked Data (All)].Award_Details, [xAwards Linked Data (All)].Skip_Names_Script, [xAwards Linked Data (All)].Skip_Names_News, [xAwards Linked Data (All)].Temp AS Expr1, [xAwards Linked Data (All)].AwardGroup.GID, [xAwards Linked Data (All)].AwardGroup.AN, [xAwards Linked Data (All)].G_Div, [xAwards Linked Data (All)].G_Desc, [xAwards Linked Data (All)].AwardPrize.GID, [xAwards Linked Data (All)].PN, [xAwards Linked Data (All)].Stud_Num, [xAwards Linked Data (All)].Place, [xAwards Linked Data (All)].Prize, [xAwards Linked Data (All)].Type, [xAwards Linked Data (All)].Details, [xAwards Linked Data (All)].Value, [xAwards Linked Data (All)].Assembly, [xAwards Linked Data (All)].Script_Sort, [xAwards Linked Data (All)].AwardPrize.News_Sort, ExhibitData.EXN AS E_EXN, ExhibitStudents.EXN AS ES_EXN, SpecialWinners.RXN, Persons.FNAME, Persons.MI, Persons.LNAME, Persons.ADDR1, Persons.ADDR2, Persons.CITY, Persons.STATE, Persons.ZIP, Schools.SCHOOL AS ExSch, Schools_1.SCHOOL AS SWSch, IIf([Win_Exn]<=100,[SWSch],[ExSch]) AS SCHOOL, IIf([Win_Exn]>100,Schools.ADDR,Schools_1.AddR) AS SchAdd, IIf([Win_EXN]>100,Schools.CITY,Schools_1.CITY) AS SchCity, IIf([Win_EXN]>100,Schools.STATE,Schools_1.STATE) AS SchState, IIf([Win_EXN]>100,Schools.ZIP,Schools_1.ZIP) AS SchZIP, Persons_1.FNAME AS ThFN, Persons_1.MI AS ThMI, Persons_1.LNAME AS ThLN, Persons_1.SALUTATION AS ThSAL, Persons_2.SALUTATION AS SWSAL, Persons_2.FNAME AS SWFN, Persons_2.MI AS SWMI, Persons_2.LNAME AS SWLN, Students.LAST_FAIR, ExhibitData.NCAT, Mid(Exhibitdata.NCAT,1,1) AS ExDiv, Mid(SpecialWinners.NCAT,1,1) AS SWDiv, IIf(IsNull([ExDiv]) And IsNull([SWDiv]) And IsNull([G_Div]),"X",IIf([ExDiv]="S" Or [ExDiv]="J",[ExDiv],IIf([SWDiv]="S" Or [SWDiv]="J",[SWDiv],IIf([G_Div]="S" Or [G_Div]="J",[G_Div],"X")))) AS Win_Div, IIf([Status]='A' And [Win_EXN]=0,"X",IIf([C_Assem]=True,"C",IIf(IsNull([Win_Div]),[G_Div],[Win_Div]))) AS ScriptAssy, IIf([C_Assem]=True,"C",IIf(IsNull([Win_Div]) Or [Win_Div]="X",IIf(IsNull([G_Div]),"X",[G_Div]),[Win_Div])) AS TestScriptAssy, IIf([ScriptAssy]="C",[C_Assem_Sort],[J/S_Assem_Sort]) & [PrzAN] AS AssySort, IIf([TestScriptAssy]="C",[C_Assem_Sort],[J/S_Assem_Sort]) & [PrzAN] AS TestAssySort, ExhibitStudents.F_ORD, SpecialWinners.Desc_FN, SpecialWinners.Desc_LN, ExhibitData.EXHB_TITLE, Students.GRADE, Students.SEX, SpecialWinners.EXHB_TITLE AS S_EXHB_TITLE, IIf(Not IsNull([win_EXN])," Win_EXN <> 98 OR Win_exn <> 99","") AS testScriptSelect, Persons.SALUTATION AS SAL, FairInfo.JUDGING_DATE, Categories.Sponsor AS CatSponsor, Categories.CATNAME, Categories.TEAM, [xAwards Linked Data (All)].Sponsor AS AwdSponsor, [WinnersOnly]=True And Not (AwardMaster.AN>=500 And AwardMaster.AN<=527) And AwardMaster.AN<>260 AS Criteria_SFCert, Students.SSN, Persons.HOME_PHONE, Persons_2.ADDR1 AS SWADDR1, Persons_2.ADDR2 AS SWADDR2, Persons_2.CITY AS SWCity, Persons_2.STATE AS SWState, Persons_2.ZIP AS SWZip, Persons_2.HOME_PHONE AS SWHome_Phone, Students.SSN AS StudentSSN, Persons.HOME_PHONE AS StudentHOME_PHONE, Persons.ADDR1 AS StudentADDR1, Persons.ADDR2 AS StudentADDR2, Persons.CITY AS StudentCITY, Persons.STATE AS StudentSTATE, Persons.ZIP AS StudentZIP, Schools_1.SCH_CODE AS SWSch_Code, Schools_1.PHONE AS SWSchoolPhone, Schools_1.ADDR AS SWSchoolADDR, Schools_1.CITY AS SWSchoolCity, Schools_1.STATE AS SWSchoolState, Schools_1.ZIP AS SWSchoolZIP, Schools.PHONE AS ExhibitSchoolPhone, Schools.ADDR AS ExhibitSchoolADDR, Schools.CITY AS ExhibitSchoolCITY, Schools.STATE AS ExhibitSchoolSTATE, Schools.ZIP AS ExhibitSchoolZIP, Schools_2.PHONE AS ExhTeachSchoolPhone, Schools_2.ADDR AS ExhTeachSchoolADDR, Schools_2.CITY AS ExhTeachSchoolCITY, Schools_2.STATE AS ExhTeachSchoolSTATE, Schools_2.ZIP AS ExhTeachSchoolZIP, Persons_1.HOME_PHONE AS ExThPHome_Phone, Persons_1.ADDR1 AS ExThPADDR1, Persons_1.ADDR2 AS ExThPADDR2, Persons_1.CITY AS ExThPCITY, Persons_1.STATE AS ExThPSTATE, Persons_1.ZIP AS ExThPZIP, [xAwards Linked Data (All)].SplitPrize, ExhibitData.TeamEx
FROM ((Teachers LEFT JOIN Persons AS Persons_1 ON Teachers.PID=Persons_1.PID) LEFT JOIN Schools AS Schools_2 ON Teachers.SCH_CODE=Schools_2.SCH_CODE) RIGHT JOIN ((Persons RIGHT JOIN Students ON (Persons.PID=Students.PID) AND (Persons.PID=Students.PID) AND (Persons.PID=Students.PID)) RIGHT JOIN ((Categories RIGHT JOIN (Schools RIGHT JOIN ExhibitData ON Schools.SCH_CODE=ExhibitData.SCH_CODE) ON Categories.NCAT=ExhibitData.NCAT) RIGHT JOIN ((([xAwards Linked Data (All)] LEFT JOIN ExhibitStudents ON [xAwards Linked Data (All)].EXN=ExhibitStudents.EXN) LEFT JOIN ((SpecialWinners LEFT JOIN Persons AS Persons_2 ON SpecialWinners.PID=Persons_2.PID) LEFT JOIN Schools AS Schools_1 ON SpecialWinners.SCH_CODE=Schools_1.SCH_CODE) ON [xAwards Linked Data (All)].EXN=SpecialWinners.RXN) LEFT JOIN FairInfo ON ExhibitStudents.FYR=FairInfo.FAIR_YEAR) ON ExhibitData.EXN=ExhibitStudents.EXN) ON Students.STID=ExhibitStudents.STID) ON Teachers.TID=ExhibitData.TID;

