Version =20
VersionRequired =20
Checksum =56553894
Begin Form
    RecordSelectors = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    DefaultView =0
    ScrollBars =0
    TabularFamily =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =7800
    DatasheetFontHeight =10
    ItemSuffix =63
    Top =165
    Right =7800
    Bottom =9060
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0xe0a618fdc66ee340
    End
    GUID = Begin
        0x7b1bcc9b5fbaa04fbef1a15164d13c54
    End
    Caption ="Web Site Import Process"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010400069c00f42153ff000001000100ea0a6f08640001000f00580201000100 ,
        0x5802030001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x020000001b010000ffffffff0000000000000000000000000000000044494e55 ,
        0x22006807a4095018f9eb89280000000000000000000000000000000000000000 ,
        0x0000000000000000470000000000000000000000000000000000000000000000 ,
        0x0000000000000000180000000000000000000300000002000000010002000000 ,
        0x0000000000000000000000000100000001000100010000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000010000000100 ,
        0x0000000000000000000000000000000000000000010000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000001000000000000000000000068070000534d544a ,
        0x0000000010005807480050002000500053004300200031003500300030002000 ,
        0x7300650072006900650073000000496e70757442696e00464f524d534f555243 ,
        0x4500524553444c4c00556e69726573444c4c004850507265416e616c79736973 ,
        0x0046616c7365004d53507265416e616c797369730046616c7365004850526570 ,
        0x6f727453796d6d65747269634d617267696e730046616c73650048504d696e69 ,
        0x6d697a654d617267696e730046616c7365004850416c69676e4d617267696e73 ,
        0x466f724d4400547275650048505072696e74507265766965770046616c736500 ,
        0x48504f76657253707261794f7074696f6e004175746f6d617469630048504f76 ,
        0x6572537072617900313030004850426f726465724c65737350686f746f004661 ,
        0x6c7365004850426f726465724c6573734175746f4669740046616c7365004850 ,
        0x437573746f6d426f726465726c65737300547275650048504f75747075744f72 ,
        0x64657252657665727365005472756500506170657253697a65004c4554544552 ,
        0x004f7269656e746174696f6e00504f52545241495400485053656e645072656c ,
        0x6f6164436f6d6d616e6400545255450048504e55736544696666466972737450 ,
        0x61676543686f696365005472756500485044727954696d654f7074696f6e0041 ,
        0x75746f6d6174696300485044727954696d650030004850496e6b566f6c756d65 ,
        0x4f7074696f6e004175746f6d61746963004850496e6b566f6c756d65004e6f72 ,
        0x6d616c0048505072696e74496e477261795363616c650046616c736500507269 ,
        0x6e745175616c697479004e6f726d616c005072696e745175616c69747947726f ,
        0x757000505147726f75705f32004850436f6c6f724d6f646500434f4c4f525f4d ,
        0x4f444500485050444c547970650050444c5f50434c33004850584d4c46696c65 ,
        0x557365640068706f31353030742e786d6c004850506f737465725072696e7469 ,
        0x6e670046616c7365004850506f737465725072696e74696e674f7074696f6e00 ,
        0x504f535445525f3200436f6c6f724d6f646500436f6c6f723234005465787441 ,
        0x73426c61636b0046616c7365004d65646961576964746853656e736f7200496e ,
        0x7374616c6c6564004d6564696154797065004155544f4d41544943005265736f ,
        0x6c7574696f6e0036303064706900505144504900496e7374616c6c6564004850 ,
        0x4175746f4475706c65785363616c696e6700547275650048505072696e744f6e ,
        0x426f746853696465734d616e75616c6c790046616c73650048504d616e75616c ,
        0x4475706c65784469616c6f674974656d7300496e737472756374696f6e49445f ,
        0x30315f4641434555502d4e4f524f544154450048504d616e75616c4475706c65 ,
        0x7850616765526f746174650055736572526f746174650048504d616e75616c46 ,
        0x6565644f7269656e746174696f6e0046414345555000485053706565644d6563 ,
        0x68004661737444726166740048504d616e75616c4475706c65784469616c6f67 ,
        0x4d6f64656c004d6f64616c0048504d616e75616c4475706c6578506167654f72 ,
        0x646572004f6464506167657346697273740048504d61704d616e75616c466565 ,
        0x64546f54726179310046616c7365005053416c69676e6d656e7446696c650048 ,
        0x505a33416c686e00505353657276696365734f7074696f6e004c61756e636854 ,
        0x6f6f6c426f78004850436c65616e696e6746696c6573446174610048505f436c ,
        0x65616e5f5465737450616765004850436f6e73756d6572437573746f6d506170 ,
        0x6572004850437573746f6d004a6f6255490054727565004850436f6c6f725365 ,
        0x6c656374696f6e466f7248504100456e61626c6564004850426f726e4f6e4461 ,
        0x7465004850424f44004850496e707574436f6c6f72537061636500434f4c4f52 ,
        0x534d415254004850437573746f6d53697a65436f6d6d616e6400545255450048 ,
        0x50524553444c4c4e616d65004850465245533530004850526564457965526564 ,
        0x756374696f6e004f6e0048504469676974616c496d6167696e67004850486f6d ,
        0x655072696e74696e67004850536d617274466f637573004f6e004850436f6e74 ,
        0x72617374004f66660048504469676974616c466c617368004f66660048505368 ,
        0x6172706e657373004f6666004850536d6f6f7468696e67004f66660048504a70 ,
        0x6567506e67506173737468726f75676800547275650048504854444c4c4e616d ,
        0x650048504649476c686e0048504d48444c4c4e616d6500485046494d45353000 ,
        0x485048504146696c7465720054727565004850416476616e636564436f6c6f72 ,
        0x53657474696e670054727565004850435244436f6d6d616e6400547275650048 ,
        0x504d6972726f725072696e740046616c736500485053656e64556e69744d6561 ,
        0x73757265436f6d6d616e640054525545004850486167616b695072696e74696e ,
        0x6700545255450000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x5018000049555048100011000000000002000000040000000100000000000000 ,
        0x0000000003000000000000000100000001000100640001000100020002000000 ,
        0x01000000020000004c0065007400740065007200000000000000000000000000 ,
        0x0000000000000000000000000100ea0a6f080000ffffffffffffffffffffffff ,
        0x0100000006000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000001000000000000000100000000000000000000000000000000000000 ,
        0x00000000000000000000000020005b006e006f006e0065005d00000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000020005b006e006f006e0065005d00000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000041007200690061006c0000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000003400000050000000000000000100000000000000 ,
        0xc0c0c00000000000c0c0c0000000000000000000000000000000000001000000 ,
        0x01000000640000000000000000000000000000000000803f0000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000000000000 ,
        0x000000000f0000000f0000000100000000000000010000000000000000000000 ,
        0x0000000000000000440045004e004e0049005300000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000003c004100750074006f006d0061007400690063003e00 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000010000000000000000000000010000000f0000001b01000000000000 ,
        0x0f0000001b010000000000000200000000000000000000000f0000001b010000 ,
        0x0f0000001b01000000000000000000000000000052bb0d003408000034080000 ,
        0x0000000000000000360030003000640070006900000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000001b0100001b01000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0100000043007500730074006f006d0020005000720069006e00740020005300 ,
        0x65007400740069006e0067007300000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000001000000020000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000064000000010000005000720069006e00 ,
        0x74002000640072006900760065007200200068006f0073007400200066006f00 ,
        0x7200200033003200620069007400200061007000700000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000002000440065006600 ,
        0x610075006c00740020005000720069006e007400200053006500740074006900 ,
        0x6e00670073000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000078000000420c000078000000420c000000000000 ,
        0x00000000000000000000000074000000490c00007b000000430c000000000000 ,
        0x0000000000000000000000006d000000fa0b000075000000440c000002000000 ,
        0xffffffff73706c776f7736342e65786500000000010000000100000001000000 ,
        0x0100000001000000010000000100000001000000010000000100000001000000 ,
        0x0100000001000000010000000100000001000000010000000100000001000000 ,
        0x0100000001000000010000000100000001000000010000000f0000001b010000 ,
        0x0f0000001b0100000f0000001b0100000f0000001b0100000000000000000000 ,
        0x000000001a0100000000000000000000000000000000000043003a005c005700 ,
        0x69006e0064006f00770073005c00730070006c0077006f007700360034002e00 ,
        0x6500780065000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x08001b002e000100000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000055534230303100
    End
    OnLoad ="[Event Procedure]"
    FilterOnLoad =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DisplayOnSharePointSite =0
    AllowLayoutView =0
    DatasheetGridlinesColor12 =12632256
    UnknownProp = {419 ,0 ,0 ,0 ,2121 } Begin
        0x0000ffff0ae45778568e0530341aac0000000000b80d9430e80d943000000000 ,
        0x24e39830381aac00c19e05308c1ace9a000200002e041b002e041b00c19e0530 ,
        0x01042140dc006d0753ff00000100010000000000640001000f00580201000100 ,
        0x5802030001000000d4850d300000000098000000d4850d300100000001000000 ,
        0x04000000f0850d30f0850d302be3577854139430c00d9430a019ac0094000000 ,
        0xb04b890688850000000000000000000000000000000000000000000001000000 ,
        0x0300000001000000010000000000000000000000000000000000000042836587 ,
        0x0000000000000000000000000000000000000008880800088808000000000000 ,
        0x0000000000000000520300004c04000000640000010000000000000000000000 ,
        0x0000000100070000000000000000000000000000000036000000000000000100 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0041007200690061006c00000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000038000000c201000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000f2b100004283658701ccdaba000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000ccdaba6800700020007000730063 ,
        0x0020003100320030003000200073006500720069006500730000006500720069 ,
        0x00650073002c004c006f00630061006c004f006e006c0079002c004400720076 ,
        0x0043006f006e0076006500720074000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000010000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000
    End
    UnknownProp = {420 ,0 ,0 ,0 ,162 } Begin
        0x040017002a000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000550053004200300030003100 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000
    End
    Begin
        Begin Label
            BackStyle =0
            FontName ="Tahoma"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Tahoma"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            UnknownProp = {324 ,0 ,0 ,0 ,1 } Begin
                0x00
            End
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            OldBorderStyle =0
            FontName ="Tahoma"
            AsianLineBreak =255
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            ShowDatePicker =1
        End
        Begin FormHeader
            Height =8280
            BackColor =-2147483633
            Name ="FormHeader"
            GUID = Begin
                0x8352d82cb871634cb3317f334a9c4702
            End
            Begin
                Begin Label
                    OverlapFlags =85
                    Left =420
                    Top =1140
                    Width =4440
                    Height =420
                    FontSize =10
                    FontWeight =700
                    ForeColor =16737843
                    Name ="Label0"
                    Caption ="Import Web Site Judge Registrations "
                    GUID = Begin
                        0x605c4ae47c3e764ba0cb7804452c356c
                    End
                    LayoutCachedLeft =420
                    LayoutCachedTop =1140
                    LayoutCachedWidth =4860
                    LayoutCachedHeight =1560
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =5280
                    Top =1140
                    Width =1680
                    Height =480
                    FontWeight =700
                    ForeColor =16737843
                    Name ="CmdUpdtJudges"
                    Caption =" Import Judges"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Update Judges from 'JudgeData' table entries on web site."
                    GUID = Begin
                        0x5aa5c7c1fc67074a98c7a04e8fba53c4
                    End

                    LayoutCachedLeft =5280
                    LayoutCachedTop =1140
                    LayoutCachedWidth =6960
                    LayoutCachedHeight =1620
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =180
                    Top =180
                    Width =5460
                    Height =420
                    FontSize =12
                    FontWeight =700
                    ForeColor =16737843
                    Name ="Label2"
                    Caption ="Research Challenge Web Synchronization"
                    GUID = Begin
                        0xf70b69027ad8fe43820f3bb56c689772
                    End
                    LayoutCachedLeft =180
                    LayoutCachedTop =180
                    LayoutCachedWidth =5640
                    LayoutCachedHeight =600
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =93
                    Left =2280
                    Top =719
                    Width =150
                    Height =300
                    BackColor =8388736
                    Name ="a"
                    Caption =" "
                    GUID = Begin
                        0x678197abe4518746a51864eb9d7b4845
                    End
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =223
                    Left =2400
                    Top =720
                    Width =150
                    Height =300
                    BackColor =8388736
                    Name ="b"
                    Caption =" "
                    GUID = Begin
                        0x34f017e8cae6a843911350ee1df2182d
                    End
                    LayoutCachedLeft =2400
                    LayoutCachedTop =720
                    LayoutCachedWidth =2550
                    LayoutCachedHeight =1020
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =93
                    Left =2640
                    Top =719
                    Width =150
                    Height =300
                    BackColor =8388736
                    Name ="d"
                    Caption =" "
                    GUID = Begin
                        0x78ba605eeccb71448ae88407d14ac8b8
                    End
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =223
                    Left =2520
                    Top =719
                    Width =150
                    Height =300
                    BackColor =8388736
                    Name ="c"
                    Caption =" "
                    GUID = Begin
                        0xde184af3fe4a8d4aa53a861c6064edb8
                    End
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =223
                    Left =2760
                    Top =719
                    Width =150
                    Height =300
                    BackColor =8388736
                    Name ="e"
                    Caption =" "
                    GUID = Begin
                        0x24dca25c2511c945b974acdfddc4f82f
                    End
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =223
                    Left =2880
                    Top =719
                    Width =150
                    Height =300
                    BackColor =8388736
                    Name ="f"
                    Caption =" "
                    GUID = Begin
                        0xcde1619b50f84447b3697ad508943a94
                    End
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =223
                    Left =3000
                    Top =719
                    Width =150
                    Height =300
                    BackColor =8388736
                    Name ="g"
                    Caption =" "
                    GUID = Begin
                        0x2a826ed03124d5499f6399e2e738a847
                    End
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =223
                    Left =3120
                    Top =719
                    Width =150
                    Height =300
                    BackColor =8388736
                    Name ="h"
                    Caption =" "
                    GUID = Begin
                        0xbaee63d6b21c564dbf2fdfb450a822e3
                    End
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =223
                    Left =3240
                    Top =719
                    Width =150
                    Height =300
                    BackColor =8388736
                    Name ="i"
                    Caption =" "
                    GUID = Begin
                        0x2f891f1a699b6f4ea34cbc3f4db71f06
                    End
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =223
                    Left =3360
                    Top =719
                    Width =150
                    Height =300
                    BackColor =8388736
                    Name ="j"
                    Caption =" "
                    GUID = Begin
                        0x9f349ea4013e9b41aab0d560c393a6fd
                    End
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =223
                    Left =3480
                    Top =719
                    Width =150
                    Height =300
                    BackColor =8388736
                    Name ="k"
                    Caption =" "
                    GUID = Begin
                        0x549ad0078c4edc4785d550a7f777e482
                    End
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =223
                    Left =3600
                    Top =719
                    Width =150
                    Height =300
                    BackColor =8388736
                    Name ="L"
                    Caption =" "
                    GUID = Begin
                        0xc26c892600c89443b7184c9f3a438fa5
                    End
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =223
                    Left =3720
                    Top =719
                    Width =150
                    Height =300
                    BackColor =8388736
                    Name ="m"
                    Caption =" "
                    GUID = Begin
                        0x6ff11a3b9f525847b2bb3cee00007667
                    End
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =223
                    Left =3840
                    Top =719
                    Width =150
                    Height =300
                    BackColor =8388736
                    Name ="n"
                    Caption =" "
                    GUID = Begin
                        0xe7aa3f4820bc924d80e8c9e078da6fb1
                    End
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =223
                    Left =3960
                    Top =719
                    Width =150
                    Height =300
                    BackColor =8388736
                    Name ="o"
                    Caption =" "
                    GUID = Begin
                        0xd92dbd88d259454792dd656887f0481b
                    End
                End
                Begin Rectangle
                    Visible = NotDefault
                    OverlapFlags =223
                    Left =2280
                    Top =660
                    Width =2520
                    Height =420
                    Name ="BX"
                    GUID = Begin
                        0xa90a1632da93e248aee0395959ab11e0
                    End
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =223
                    Left =4080
                    Top =719
                    Width =150
                    Height =300
                    BackColor =8388736
                    Name ="p"
                    Caption =" "
                    GUID = Begin
                        0xb7a0e73687a39a4cbd360f0fd792f730
                    End
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =223
                    Left =4200
                    Top =719
                    Width =150
                    Height =300
                    BackColor =8388736
                    Name ="q"
                    Caption =" "
                    GUID = Begin
                        0x91f9959f26d51543a0e25c5bd700813e
                    End
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =223
                    Left =4320
                    Top =719
                    Width =150
                    Height =300
                    BackColor =8388736
                    Name ="r"
                    Caption =" "
                    GUID = Begin
                        0x7ce9971e12595944b5ec00cb0178c0a1
                    End
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =223
                    Left =4440
                    Top =719
                    Width =150
                    Height =300
                    BackColor =8388736
                    Name ="s"
                    Caption =" "
                    GUID = Begin
                        0x8fdf5da3b753f24281bc2ae5c15792e2
                    End
                End
                Begin Label
                    Visible = NotDefault
                    BackStyle =1
                    OverlapFlags =215
                    Left =4590
                    Top =719
                    Width =150
                    Height =300
                    BackColor =8388736
                    Name ="t"
                    Caption =" "
                    GUID = Begin
                        0xa52a6148d0c95b4ea8d04d77bd798029
                    End
                End
                Begin Label
                    OverlapFlags =215
                    Left =3000
                    Top =780
                    Width =1200
                    Height =240
                    FontSize =9
                    FontWeight =700
                    BackColor =16711680
                    Name ="LblPERCENT"
                    GUID = Begin
                        0x2fe7c78c84322b40a0c6eb6bf35ca38c
                    End
                    LayoutCachedLeft =3000
                    LayoutCachedTop =780
                    LayoutCachedWidth =4200
                    LayoutCachedHeight =1020
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =5280
                    Top =2580
                    Width =1680
                    Height =480
                    FontWeight =700
                    TabIndex =1
                    ForeColor =16737843
                    Name ="CmdExh"
                    Caption ="Import Exhibits"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Update Exhibits from 'EntryFormData' table entries on web site."
                    GUID = Begin
                        0x03a7eeaad91ab647aa6ffaf041cfccbc
                    End

                    LayoutCachedLeft =5280
                    LayoutCachedTop =2580
                    LayoutCachedWidth =6960
                    LayoutCachedHeight =3060
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =420
                    Top =2580
                    Width =4440
                    Height =420
                    FontSize =10
                    FontWeight =700
                    ForeColor =16737843
                    Name ="Label38"
                    Caption ="Import Web Site Exhibits Entries."
                    GUID = Begin
                        0x3ea4e4dea95b3645851df8657106ca54
                    End
                    LayoutCachedLeft =420
                    LayoutCachedTop =2580
                    LayoutCachedWidth =4860
                    LayoutCachedHeight =3000
                End
                Begin TextBox
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =5820
                    Top =180
                    Width =1620
                    ColumnOrder =0
                    TabIndex =2
                    Name ="Rev"
                    ControlSource ="=Revision()"
                    GUID = Begin
                        0xc585ce428235e249a5cb2c8e5573a116
                    End

                    LayoutCachedLeft =5820
                    LayoutCachedTop =180
                    LayoutCachedWidth =7440
                    LayoutCachedHeight =420
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =5280
                    Top =3300
                    Width =1680
                    Height =480
                    FontWeight =700
                    TabIndex =3
                    ForeColor =16737843
                    Name ="btnSchTeach"
                    Caption ="Update Schools and Teachers"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Upload current Schools and Teachers data to the web site."
                    GUID = Begin
                        0x9d9c4a025f19f742a07cecb01da30269
                    End

                    LayoutCachedLeft =5280
                    LayoutCachedTop =3300
                    LayoutCachedWidth =6960
                    LayoutCachedHeight =3780
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =420
                    Top =3300
                    Width =4800
                    Height =420
                    FontWeight =700
                    ForeColor =16737843
                    Name ="Label45"
                    Caption ="Update SciFairWebData Schools and Teachers Tables.\015\012  (Used for selections"
                        " in Exhibits registration)"
                    GUID = Begin
                        0x61506ea08276e742aadd72c45a857568
                    End
                    LayoutCachedLeft =420
                    LayoutCachedTop =3300
                    LayoutCachedWidth =5220
                    LayoutCachedHeight =3720
                End
                Begin Label
                    OverlapFlags =85
                    Left =420
                    Top =3960
                    Width =4320
                    Height =600
                    FontWeight =700
                    ForeColor =16737843
                    Name ="Label46"
                    Caption ="Update Web Site Categories Data.\015\012  (Judging categories and National Categ"
                        "ories)  "
                    GUID = Begin
                        0x150ff79bbea18b4f9e065a13b74d517d
                    End
                    LayoutCachedLeft =420
                    LayoutCachedTop =3960
                    LayoutCachedWidth =4740
                    LayoutCachedHeight =4560
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =5280
                    Top =4020
                    Width =1680
                    Height =480
                    FontWeight =700
                    TabIndex =5
                    ForeColor =16737843
                    Name ="btnCats"
                    Caption ="Update\015\012Categories"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Upload current data to Categories.xml file and NatCategories table."
                    GUID = Begin
                        0x90cbd1aa2d680d4b890d772887c2d906
                    End

                    LayoutCachedLeft =5280
                    LayoutCachedTop =4020
                    LayoutCachedWidth =6960
                    LayoutCachedHeight =4500
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =5280
                    Top =1860
                    Width =1680
                    Height =480
                    FontWeight =700
                    TabIndex =4
                    ForeColor =16737843
                    Name ="btnJudgeUD"
                    Caption ="Update Judges"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Upload current judge data to 'Judges' table on web site."
                    GUID = Begin
                        0x8f47e4c71ebb3b41a9f7da8050287b01
                    End

                    LayoutCachedLeft =5280
                    LayoutCachedTop =1860
                    LayoutCachedWidth =6960
                    LayoutCachedHeight =2340
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =420
                    Top =1860
                    Width =4800
                    Height =420
                    FontWeight =700
                    ForeColor =16737843
                    Name ="Label49"
                    Caption ="Update SciFairWebData Judge table (Do after Import) \015\012  (Used to preload d"
                        "ata for returning judges) "
                    GUID = Begin
                        0x48c6ac46cd2c864492e435fbc19b06e4
                    End
                    LayoutCachedLeft =420
                    LayoutCachedTop =1860
                    LayoutCachedWidth =5220
                    LayoutCachedHeight =2280
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =5280
                    Top =5280
                    Width =1680
                    Height =540
                    FontWeight =700
                    TabIndex =6
                    ForeColor =16737843
                    Name ="btnUpdateScores"
                    Caption ="Upload Scores and Status "
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Upload current scores and staus from score scanning process."
                    GUID = Begin
                        0xce856a6bc274674c970a4ae97bb2f00c
                    End

                    LayoutCachedLeft =5280
                    LayoutCachedTop =5280
                    LayoutCachedWidth =6960
                    LayoutCachedHeight =5820
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =420
                    Top =5280
                    Width =4440
                    Height =540
                    FontWeight =700
                    ForeColor =16737843
                    Name ="Label52"
                    Caption ="Upload Scores and Status For Chairs' Review and Edits.  DO OFTEN while scanning "
                        "Judge Score Forms."
                    GUID = Begin
                        0xb234978b83e45e4b96c08142bc588e70
                    End
                    LayoutCachedLeft =420
                    LayoutCachedTop =5280
                    LayoutCachedWidth =4860
                    LayoutCachedHeight =5820
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =5280
                    Top =6060
                    Width =1680
                    Height =540
                    FontWeight =700
                    TabIndex =7
                    ForeColor =16737843
                    Name ="btUpdateScoresFinal"
                    Caption ="Final Upload Scores + Status "
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Upload Final Scores and Status from the scanning process."
                    GUID = Begin
                        0x8ee0305a4e6d5b48a36fc1d64bc3ce73
                    End
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =5280
                    LayoutCachedTop =6060
                    LayoutCachedWidth =6960
                    LayoutCachedHeight =6600
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =420
                    Top =6000
                    Width =4560
                    Height =600
                    FontWeight =700
                    ForeColor =16737843
                    Name ="Label55"
                    Caption ="Upload Scores and Status.  Do AFTER All judge Score Forms have been scanned and "
                        "entered. Informs the Chairs that all forms have been scanned."
                    GUID = Begin
                        0x4ab0dd7a37e6164ba650bbcd94c77a24
                    End
                    LayoutCachedLeft =420
                    LayoutCachedTop =6000
                    LayoutCachedWidth =4980
                    LayoutCachedHeight =6600
                End
                Begin Label
                    OverlapFlags =85
                    Left =420
                    Top =6780
                    Width =4560
                    Height =600
                    FontWeight =700
                    ForeColor =16737843
                    Name ="Label57"
                    Caption ="DownLoad Chairs Final Scores, Top of Category awards and recommendations for To "
                        "State and ISEF.  Downloads if 'Final' and not already downloaded. "
                    GUID = Begin
                        0x56b04ec37709fa49906caab559ee6a18
                    End
                    LayoutCachedLeft =420
                    LayoutCachedTop =6780
                    LayoutCachedWidth =4980
                    LayoutCachedHeight =7380
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =5280
                    Top =6840
                    Width =1680
                    Height =540
                    FontWeight =700
                    TabIndex =8
                    ForeColor =16737843
                    Name ="btnDownLoadChairFinal"
                    Caption ="DOWNLOAD Category Finals"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Download Chairs Final Category results."
                    GUID = Begin
                        0xb2a3eb1a190b6b4daeecbd36553cfbbb
                    End
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =5280
                    LayoutCachedTop =6840
                    LayoutCachedWidth =6960
                    LayoutCachedHeight =7380
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =5280
                    Top =7620
                    Width =1680
                    Height =540
                    FontWeight =700
                    TabIndex =9
                    ForeColor =16737843
                    Name ="btnClearExhScores"
                    Caption ="Clear + Reset Web ExhibitScores"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Caution: DO ONLY ONCE prior to scanning judge score forms."
                    GUID = Begin
                        0x2fed3ac66f5b594c86d78f4216f2b83f
                    End
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =5280
                    LayoutCachedTop =7620
                    LayoutCachedWidth =6960
                    LayoutCachedHeight =8160
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =420
                    Top =7620
                    Width =4560
                    Height =540
                    FontWeight =700
                    ForeColor =16737843
                    Name ="Label60"
                    Caption ="Clears Website ExhibitScores Table then uploads Current Exhibits Data  DO ONCE B"
                        "efore Scanning. "
                    GUID = Begin
                        0xa285a77bc896cb4f92c00dc46dd4d764
                    End
                    LayoutCachedLeft =420
                    LayoutCachedTop =7620
                    LayoutCachedWidth =4980
                    LayoutCachedHeight =8160
                End
                Begin Line
                    LineSlant = NotDefault
                    OverlapFlags =85
                    Left =240
                    Top =4740
                    Width =7200
                    Name ="Line61"
                    GUID = Begin
                        0x656a17f1286e20458a250d41e2c98a8c
                    End
                    LeftPadding =30
                    TopPadding =30
                    RightPadding =30
                    BottomPadding =30
                    GridlineStyleLeft =0
                    GridlineStyleTop =0
                    GridlineStyleRight =0
                    GridlineStyleBottom =0
                    GridlineWidthLeft =1
                    GridlineWidthTop =1
                    GridlineWidthRight =1
                    GridlineWidthBottom =1
                    LayoutCachedLeft =240
                    LayoutCachedTop =4740
                    LayoutCachedWidth =7440
                    LayoutCachedHeight =4740
                End
                Begin Label
                    OverlapFlags =85
                    Left =1020
                    Top =4920
                    Width =5595
                    Height =240
                    Name ="Label62"
                    Caption ="Actions below for Fair day only.  Use only if opened from JudgeScores Entry "
                    GUID = Begin
                        0x734d27a2c819e745afedeaf83f7db324
                    End
                    LayoutCachedLeft =1020
                    LayoutCachedTop =4920
                    LayoutCachedWidth =6615
                    LayoutCachedHeight =5160
                End
            End
        End
        Begin Section
            Height =840
            BackColor =-2147483633
            Name ="Detail"
            GUID = Begin
                0x5c78684fedc65c448dda2137e2f06f31
            End
            Begin
                Begin CommandButton
                    OverlapFlags =85
                    Left =6120
                    Top =180
                    Width =1560
                    Height =480
                    FontWeight =700
                    ForeColor =16737843
                    Name ="btnClose"
                    Caption ="Close"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Update Judges"
                    GUID = Begin
                        0x5effbf058e452a4b90d55d2d41bf7e61
                    End

                    LayoutCachedLeft =6120
                    LayoutCachedTop =180
                    LayoutCachedWidth =7680
                    LayoutCachedHeight =660
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
            End
        End
        Begin FormFooter
            Height =0
            BackColor =-2147483633
            Name ="FormFooter"
            GUID = Begin
                0x99d95ef770ff5b45942655b668502d8a
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'    SciFairMaster.mdb  (All class objects and modules)
'
'    Copyright (C) 2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,
'                  2014  Dennis e.Spanogle
'
'    This program is free software: you can redistribute it and/or modify
'    it under the terms of the GNU General Public License as published by
'    the Free Software Foundation, either version 3 of the License, or
'    (at your option) any later version.
'
'    This program is distributed in the hope that it will be useful,
'    but WITHOUT ANY WARRANTY; without even the implied warranty of
'    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
'    GNU General Public License for more details.
'
'    You should have received a copy of the GNU General Public License
'    along with this program.  If not, see <http://www.gnu.org/licenses/>.
'
'   This code completly Redone by Dennis Spanogle DES revision 4.0.4  December 2008 to rev 5.x.x
' Work to do
'
'
'
Option Compare Database '  This compares strings and is NOT case sensitive  i.e. 'Chaves' is same as 'chAVes'
                        '   in data base find first, find next  where name = 'chAveS'   etc.
                        '  If you were to want to compare case sensitvie you you do Option Compare Binary
                        ' or use strcomp(a,b,0)
Public mykt As Integer
'
Public MyWebDbname As String
Public webdb As Workspace
Public SQLstr As String
Public SQlStrJ As String  'Sql for Seleting Available Judge numbers
Public MYJun As Integer
'Public GBLPID As Integer
Public My100 As index
Public Mypbar As Integer
Public db As DAO.Database
Public Dbs As DAO.Database
Public rs As DAO.Recordset
Public RSTExhibitData As DAO.Recordset
Public RSTSch As DAO.Recordset
Public RSTPerson As DAO.Recordset
Public RSTTeachers As DAO.Recordset
Public RSTStu As DAO.Recordset
Public RSTExbitStu As DAO.Recordset
Public RSTExbit As DAO.Recordset
Public RSTJudgeTypes As DAO.Recordset
Public MyEXN As Long
Public mytmpID As Integer
Public rsStuPer As DAO.Recordset
Public rsStuPerDblCk As DAO.Recordset  ' rev 5.2.2   used to double check if real duplicate student.
Public PersonError As Boolean
Public StudentError As Boolean
Public ExhibitError As Boolean
Public ExhStudError As Boolean
Public UpdateEXN As Long  ' Used to hold the Exhibit number of exhibits being re-imported. Same LName, FName and
                          ' Re-entry by student or the export flag was unchecked.
Public NumExhUpdated As Integer
Public ErrorNumber As Integer
Public TeamDupStud As Boolean

'SELECT Persons.LNAME, Persons.FNAME, Persons.MI, Persons.SALUTATION, Students.STID, Students.GRADE, Students.SSN, Students.SEX, Students.PID, Students.S_SCH AS SCH_CODE, Students.S_TID AS TID, Students.Temp, Schools.SCHOOL, Persons.PID AS P_PID, Persons.TP, Persons.HOME_PHONE, Persons.CID, Persons.WORK_PHONE, Persons.EXTENSION, Persons.ADDR1, Persons.ADDR2, Persons.CITY, Persons.STATE, Persons.ZIP, Persons.LAST_CHG, Persons.EMAIL, Persons.CELL_PHONE, Persons.FAX_PHONE, Persons.MAILPREF, Persons.SPECIAL, Persons.COMMENTS AS P_Comments, Persons.Temp AS P_Temp, Students.LAST_FAIR
'FROM ((Students LEFT JOIN Teachers ON Students.S_TID = Teachers.TID) LEFT JOIN Persons ON Students.PID = Persons.PID) LEFT JOIN Schools ON Students.S_SCH = Schools.SCH_CODE
'ORDER BY Persons.LNAME, Persons.FNAME, Persons.MI, Persons.SALUTATION;
Dim TPValue As String    'DES used to set Person!TP
Dim IsTeam As Boolean    ' DES Set to true for exhibits that are team exhibits
Dim teamID As Integer    ' DES For team exhibits only
Dim erst As String       ' The Error string for the log table
Dim ErCnt As Integer     ' How many error in the error log
Dim ExSkipped As Integer  ' Have Exported flag set to yes - already imported
Dim ExImported As Integer  '  New Exhibits processed this import
Dim ExWithBad As Integer    ' Exhibits that fail CheckExhibits
Dim ExBadImported As Integer  ' Exhbits that pass checkexhibits but have DETECTABLE errors and get loaded anyway
Dim rsErr As DAO.Recordset     ' The WebErrorLog table
Dim RSTJudgeTypeCategories As DAO.Recordset  ' used to find the NCAT given and Exhibits JCAT
Dim RSTFairInfo As DAO.Recordset    ' used to get first exhbit number to use in adding exhibits.
Dim RSAllLocalJudges As DAO.Recordset   ' DES 4.0.4
Dim NxtAvailJUN As Integer
Dim StuPerCkOK As Boolean    ''  DES 4.0.4
Dim UpDateSTID As Long
Dim UpdatePID As Long
Private WebJudgeList As DAO.Recordset    ' DES 4.0.4
'  Variables used in the calles to do exhibit scores process.
Dim doClearWeb As Boolean     ' DES 5.3.1
Dim doWebDownload As Boolean
Dim doWebUpload As Boolean    ' Not implemented at this time
Dim doSimpleUpload As Boolean
Dim dlCAT    ' the category for downloading data
Dim LastWebAcc   ' date or null or empty
Dim WebDataFinal As Boolean
Dim isFinalUpload As Boolean
Dim CheckLocExh As Boolean ' rev 5.3.5 used to do exhscores upload checks only on clear and update
Dim DoCatUpdateNoMsg As Boolean '
' rev 540   count tshirt sizes
 Dim TShirtSize() As String     ' allow for unknown sizes (text) and 2 = count
 Dim TShirtSzCnt() As Integer    ' count for tshirts for same index as TShirtSize
 Dim TShirtTotal As Integer       ' number of different sizes


 '-----------
Private Sub CountTShirts(Size As String)
'Youth Medium
'Youth Large
'
'Adult Small
'Adult Medium
'Adult Large
'Adult X - Large
'Adult XX - Large
'Adult XXX - Large


   Dim idx As Integer
   Dim fnd As Boolean
   On Error GoTo ErrorSub
   If TShirtTotal = 0 Then
      ReDim Preserve TShirtSize(0)
      ReDim Preserve TShirtSzCnt(0)
      TShirtSize(0) = Size
      TShirtSzCnt(0) = 1
      TShirtTotal = 1
      ReDim Preserve TShirtSize(1)
      ReDim Preserve TShirtSzCnt(1)
   Else
     fnd = False
     For idx = 0 To TShirtTotal
       If TShirtSize(idx) = Size Then
         TShirtSzCnt(idx) = TShirtSzCnt(idx) + 1
         fnd = True
       End If
     Next
     If fnd = False Then
        TShirtSize(TShirtTotal) = Size
        TShirtSzCnt(TShirtTotal) = 1
        TShirtTotal = TShirtTotal + 1
        ReDim Preserve TShirtSize(TShirtTotal)
        ReDim Preserve TShirtSzCnt(TShirtTotal)
     End If
   End If
   
   Exit Sub
ErrorSub:
   MsgBox "CountTShirts " & Err.Description
End Sub

Public Function ConvertPh(Phonenum As String) As String
   ' DES  convert 123-123-1234 web format to (123) 123-1234
   On Error GoTo ErrorLeave
   ConvertPh = Phonenum
   ' If not right lenght do nothing
   If Len(Phonenum) = 12 Then
     Phonenum = "(" & Mid(Phonenum, 1, 3) & ") " & Mid(Phonenum, 5, 8)
     ConvertPh = Phonenum
   End If
   Exit Function
ErrorLeave:
  MsgBox "ConvertPh: " & Err.Description
End Function

Sub GetNCAT()  '  Fill in the NCAT for and Exhibit since the web usese JCAT list for exhibits.
  RSTJudgeTypeCategories.MoveFirst
  RSTJudgeTypeCategories.FindFirst ("JCAT = '" & RSTExbit!JCAT & "'")
  If RSTJudgeTypeCategories.NoMatch Then
    MsgBox "Error:  jcat not in JudgeTypeCategories table"
  Else
    RSTExbit!NCAT = RSTJudgeTypeCategories!NCAT
  End If
End Sub
Sub DoLog()
'  DES 4.0.4   Add a record to the WebErrorLog Table
  On Error GoTo ErrorLeave
  Dim teamNu As String
  teamNu = ""
  If teamID = 2 Then
    teamNu = " in Team Member 2"
  End If
  If teamID = 3 Then
    teamNu = " in Team Member 3"
  End If
  Set rsErr = db.OpenRecordset("Select * from WebErrorLog")
  rsErr.AddNew
    rsErr!RecordID = ErrorNumber & " LName: " & RSTExhibitData!exlastname & teamNu
    rsErr!ErrorTy = erst
  rsErr.Update
  rsErr.Close
  ErrorNumber = ErrorNumber + 1
  ErCnt = ErCnt + 1
  Exit Sub
ErrorLeave:
MsgBox "DoLog: " & Err.Description
End Sub

Public Function CheckExhibit() As Boolean
'  DES 4.0.4   Check the data in the ExhibitData record for possible errors that will cause a problem
  Dim tl As Integer  ' text length of a field
  On Error GoTo ErrorLeave
  CheckExhibit = True  ' assume OK until find error
  ' --------Check that data that is required in SciFairData is in the record----------------
  ' Note: The Web Entry Form forces the student to add all data for primary student.
  '       But does not force the team member data at this time.
TryAgain:
  If RSTExbit.RecordCount > 0 Then
    RSTExbit.MoveFirst  ' see if the exhibit number we are about to use exists
                      ' IT MUST NOT if this has not been imported
    RSTExbit.FindFirst ("EXN = " & MyEXN)
    If RSTExbit.NoMatch Then
    Else
     MsgBox "PROGRAM ERROR: EXN was not incremented correctly: This would replace an existing exhibit with " & vbCrLf & _
     "  a new record from the Web. This will not be allowed for now.  This may be a program error." & vbCrLf & _
     " "
     MyEXN = MyEXN + 1
     CheckExhibit = False
     Exit Function
     'find a different exhibit number
     'GoTo TryAgain
    End If
  End If
  If IsTeam Then
    ' LNAME is a required field in SciFairData
    ' Note that no other data is required so I just put Nulls if the Web text is 0 length or null
    If IIf(IsNull(RSTExhibitData!TM2lastname), 0, Len(RSTExhibitData!TM2lastname)) = 0 Then
      erst = "Skipped: TM2lastname is Required! "
      Call DoLog
      CheckExhibit = False
    End If
    ' At this point, there is no way to know if there is a 3rd team member except
    ' to check if a lastname is entered.  If it is, then assume there is one
    ' This is all done in the ProcessPersons routine.
  End If ' is team
  ' ----- Check TID Teacher ID in SciFairData
  RSTTeachers.MoveFirst
  RSTTeachers.FindFirst ("TID = " & RSTExhibitData!TID)
  If RSTTeachers.NoMatch Then   '' not found
    erst = "Skipped: " & RSTExhibitData!TID & " TID not in Teachers Table!"
    DoLog
    CheckExhibit = False
  End If
  '----- Check Category  is in JudgeType Table
  RSTJudgeTypes.MoveFirst
  RSTJudgeTypes.FindFirst ("JCAT = '" & RSTExhibitData!Category & "'")
  If RSTJudgeTypes.NoMatch Then   '' not found
      erst = "Skipped: " & RSTExhibitData!Category & " Category not in JudgeTypes Table!"
      DoLog
      CheckExhibit = False
  End If
 ' ----- Check School code is in Schools table
 ' ---- Check Lengths of records so they do not exceed lengths in SciFairData
 '       IF so, truncate --- Not sure what to do here, perhaps trim all inputs ----
 '        but that gives no warning ??
 Exit Function
ErrorLeave:
   MsgBox " Error in CheckExhibit Function: " & Err.Description
End Function
Public Function ProcessStuPer() As Boolean
  ' In this routine, I check if the student/Person exists as a student in SciFairData. (Local database)
  ' If  this routine runs OK without error then
  '    StuPerCkOK is set true and
  ' If a student/person is found and is OK to update then
  '     UpDateSTID and UpDatePID are set to the STID and PID to use
  '       and   Processpersons and ProcessStudents should NOT DO ANY SEARCH
  '            (they may find a person who is NOT a student)
  '       and do the update useing STID and PID
  ' Else if a student is not found to update then
  '       UpDateSTID and UpDatePID are set to 0
  '       Processpersons and Process students should NOT SEARCH and should just
  '         ADD new records.
  '
  '
 Dim FStr As String   ' Find String
 Dim StrMI As String    '  The current Importing data record value
 Dim StrPhone As String
 Dim StrAddr As String
 Dim StrCity As String
 Dim FStrMI As String        ' FIRST Found values in StudentPerson Query
 Dim FStrPhone As String    ' Used in case find duplicate name
 Dim FStrAddr As String
 Dim FStrCity As String
 Dim FStrSTID As String
 Dim FStrPID As String
 Dim FirstInExhStu As Boolean
 
 On Error GoTo ErrorExit
  ' rev 5.0.1
 FirstInExhStu = False
 PersonError = False
 StudentError = False
 ' --
 StuPerCkOK = True         ' assume we do not have error
 UpDateSTID = 0           ' assume we find no match to student
 UpdatePID = 0            '  and person (joined)
 ProcessStuPer = True       ' assume all works unless set false
 If teamID = 1 Then
     ' debug
    ' If RSTExhibitData!exfirstname = "Reilly" Then  ' last name = O'Rear  (with apposterphy)
    '     teamID = teamID
    ' End If
      FStr = "[Fname] = """ & RSTExhibitData!exfirstname & _
                       """ AND [Lname] = """ & RSTExhibitData!exlastname & """"
      ' These should never be null because web form requires and entry
      StrMI = IIf(IsNull(RSTExhibitData!exMidinit), "", RSTExhibitData!exMidinit)
      StrPhone = IIf(IsNull(RSTExhibitData!exPHONE), "", RSTExhibitData!exPHONE)
      StrAddr = IIf(IsNull(RSTExhibitData!exADDRESS), "", RSTExhibitData!exADDRESS)
      StrCity = IIf(IsNull(RSTExhibitData!exCITY), "", RSTExhibitData!exCITY)
 End If
 If teamID = 2 Then
      FStr = "[Fname] = """ & RSTExhibitData!TM2Firstname & _
                       """ AND [Lname] = """ & RSTExhibitData!TM2lastname & """"
      ' These can be null because Web Form does not require and enty
      StrMI = IIf(IsNull(RSTExhibitData!TM2Midinit), "", RSTExhibitData!TM2Midinit)
      StrPhone = IIf(IsNull(RSTExhibitData!TM2PHONE), "", RSTExhibitData!TM2PHONE)
      StrAddr = IIf(IsNull(RSTExhibitData!TM2ADDRESS), "", RSTExhibitData!TM2ADDRESS)
      StrCity = IIf(IsNull(RSTExhibitData!TM2CITY), "", RSTExhibitData!TM2CITY)
 End If
 If teamID = 3 Then
      FStr = "[Fname] = """ & RSTExhibitData!TM3Firstname & _
                       """ AND [Lname] = """ & RSTExhibitData!TM3lastname & """"
      ' These can be null because Web Form does not require and enty
      StrMI = IIf(IsNull(RSTExhibitData!TM3Midinit), "", RSTExhibitData!TM3Midinit)
      StrPhone = IIf(IsNull(RSTExhibitData!TM3PHONE), "", RSTExhibitData!TM3PHONE)
      StrAddr = IIf(IsNull(RSTExhibitData!TM3ADDRESS), "", RSTExhibitData!TM3ADDRESS)
      StrCity = IIf(IsNull(RSTExhibitData!TM3CITY), "", RSTExhibitData!TM3CITY)
 End If
   ' ----------   SEE If student JOINED with Persons exists Then.   --------------------
 rsStuPer.FindFirst (FStr)         ' NOTE FindFirst is NOT case sensitive i.e. Chaves = cHAVES
 If rsStuPer.NoMatch = False Then  ' If 1  ***********  FOUND A MATCH SO POSSIBLE UPDATE BUT DO MORE CHECKS
      '  ----------   At least one student with the same last name and first name already exists
      ' SEE if there is another entry (duplicates already exist)
      ' First Check if the first student found is in ExhibitStudents Table
      RSTExbitStu.FindFirst ("STID= " & rsStuPer!STID)
      If RSTExbitStu.NoMatch = False Then    ' found this one in ExhibitStudents
        FirstInExhStu = True
      End If
      '  Hold these values for messages in case duplicate found
      FStrMI = IIf(IsNull(rsStuPer!MI), "", rsStuPer!MI)           ' FIRST found MI etc
      FStrPhone = IIf(IsNull(rsStuPer!HOME_PHONE), "", rsStuPer!HOME_PHONE)
      FStrAddr = IIf(IsNull(rsStuPer!ADDR1), "", rsStuPer!ADDR1)
      FStrCity = IIf(IsNull(rsStuPer!CITY), "", rsStuPer!CITY)
      FStrSTID = rsStuPer!STID
      FStrPID = rsStuPer!PID
      '  Rev 5.3.5 535  This area needs work in case have two web entries with same first last name and
      '       only one local entry  Prior to 5.3.5 only checked if duplicates in local exhibit students.
      ' At this time we could just update the record - unless there are duplicates.
      ' See if another match in local data - IF YES and team we will use the second record found if user agrees!
      UpDateSTID = rsStuPer!STID       ' Always update the first found records unless this is changed below
      UpdatePID = rsStuPer!PID         ' so set these before do the FIND NExt
      rsStuPer.FindNext (FStr)   '**************   FIND THE NEXT RECORD WITH THIS Fname and LName
      If rsStuPer.NoMatch = False Then '  If 2  FOUND more than one match with LName and FName
         ' so see if at least one other field matches - thus it is a real duplicate
         ' if last four digits phone same  OR   MI same or Address the same then this is same person
         ' if none are the same then ask operator??  if not same go update the first match.
        If Len(FStrMI) > 0 Then     ' is a MI and is the same then IS DUPLICATE
           If FStrMI = IIf(IsNull(rsStuPer!MI), "", rsStuPer!MI) Then GoTo IsDuplicate
        End If
        If Len(FStrPhone) > 4 Then   ' if both have phone number and last 4 digits the same then isDuplicate
          Dim ph2 As String
          ph2 = IIf(IsNull(rsStuPer!HOME_PHONE), "", rsStuPer!HOME_PHONE)
          If Len(ph2) > 4 Then
            If Right(FStrPhone, 4) = Right(ph2, 4) Then GoTo IsDuplicate
          End If
        End If
        ' if address the same then is duplicate
        If FStrAddr = IIf(IsNull(rsStuPer!ADDR1), "", rsStuPer!ADDR1) Then GoTo IsDuplicate
        ' IF GET HERE THEN these two persons are probably NOT the same person but just have same FName and LName
        ' so, Find out Which one matches the Web Data.
        If Len(FStrMI) > 0 Then    ' compare first found with web data
           If FStrMI = StrMI Then GoTo UpDateFirst  ' using first record STID and PID set above
        End If
        If Len(FStrPhone) > 4 Then   ' if both have phone number and last 4 digits the same then isDuplicate
          If Len(StrPhone) > 4 Then
            If Right(FStrPhone, 4) = Right(StrPhone, 4) Then GoTo UpDateFirst
          End If
        End If
        If FStrAddr = StrAddr Then GoTo UpDateFirst
        ' IF GET HERE get here then the first found record does not match the webdata record in at least one other field
        '   so second record found should match the webdata
        If Len(StrMI) > 0 Then     ' is a MI and is the same then
           If StrMI = IIf(IsNull(rsStuPer!MI), "", rsStuPer!MI) Then GoTo UpDateSecond
        End If
        If Len(StrPhone) > 4 Then   ' if both have phone number and last 4 digits the same then isDuplicate
          Dim ph2c As String
          ph2c = IIf(IsNull(rsStuPer!HOME_PHONE), "", rsStuPer!HOME_PHONE)
          If Len(ph2c) > 4 Then
             If Right(StrPhone, 4) = Right(ph2c, 4) Then GoTo UpDateSecond
          End If
        End If
        If StrAddr = IIf(IsNull(rsStuPer!ADDR1), "", rsStuPer!ADDR1) Then GoTo UpDateSecond
        ' IF GET HERE THEN then we have two NONE Duplicate records in local data with same Lname and Fname and...
        ' a third record in web.   Neither of current records match the web data so...   WE WILL ADD With a MESSAGE.
        MsgBox "Adding a student that MAY BE a duplicate? Student has different Phone, MI and address. " & vbCrLf & _
              "This will cause Multiple students with Name = " & rsStuPer!FNAME & " " & rsStuPer!LNAME & " But, each has a " & vbCrLf & _
              "different phone number, address and or MI so they may be or may NOT be duplicats - Research after import!" & vbCrLf & _
              " " & vbCrLf & _
              "Importing NEW Student with Phone = " & StrPhone & " Address: " & StrAddr & " MI= " & StrMI
        erst = "Imported Third Student with name= " & rsStuPer!FNAME & " " & rsStuPer!LNAME & vbCrLf & _
        " But MI= " & StrMI & " Phone= " & StrPhone & "  Address = " & StrAddr & "!  Are These All different persons?"
        DoLog
        GoTo AddStudent
UpDateFirst:   'Put Info only message in log
        erst = "Info Only - Similar Students Assumed to be 'Different' Students: " & rsStuPer!FNAME & " " & rsStuPer!LNAME & _
              " Updated STID = " & FStrSTID & "  Other N/A this web record"
        DoLog
        GoTo DoTheUpdate
UpDateSecond:
        UpDateSTID = rsStuPer!STID   ' set to second record
        UpdatePID = rsStuPer!PID
        'Put Info only message in Log
        erst = "Info Only - 'Similar' Students Assumed to be 'Different' Students: " & rsStuPer!FNAME & " " & rsStuPer!LNAME & _
              " Updated STID = " & UpDateSTID & "  Other N/A this web record"
        DoLog
        GoTo DoTheUpdate
IsDuplicate:
        '  Actual Duplicate so need to give opereator messages
        '  Must handle team members 2 and 3 differently because we already have an 'exhibit' record
        '    and are now just trying to add one more 'exhbitstudent' record
        If teamID = 1 Then    '  Never import the record if duplicates on teamID = 1  - just give messages
           RSTExbitStu.FindFirst ("STID = " & rsStuPer!STID)
           If RSTExbitStu.NoMatch = False Then    'THE SECOND Student IS IN ExhibitStudents
               If FirstInExhStu = True Then  ' YES have duplicate students AND exhibitstudent,  no update.  error and message
                  MsgBox "There are Multiple Students AND Multiple ExhibitStudent table entries for " & vbCrLf & _
                        rsStuPer!FNAME & " " & rsStuPer!LNAME & " with different STIDs" & vbCrLf & _
                       "This record will be Skipped for now. Suggest: Delete Unwanted Exhibit and Student then re-import", vbCritical, "Duplicate Entries"
                  erst = "Duplicate Students AND Exhibits? STIDs = " & FStrSTID & " and " & CStr(rsStuPer!STID) & _
                        " (Update Skipped)  Suggest: Delete Unwanted Exhibit,Student and Person " & rsStuPer!FNAME & " " & rsStuPer!LNAME
                  Call DoLog
               Else   '  Second Found STUDENT IS ONLY one in ExhibitStudents NO update it  error message
                 MsgBox "There are Multiple Students and ONE ExhibitStudent table entries for " & vbCrLf & _
                       rsStuPer!FNAME & " " & rsStuPer!LNAME & " with different STIDs" & vbCrLf & _
                       "This record will be Skipped for now. Suggest: Delete STID " & FStrSTID & " (Student with no ExhibitStudent record) then re-import", vbCritical, "Duplicate Entries"
                 erst = "Duplicate Students? STIDs = " & FStrSTID & " and " & CStr(rsStuPer!STID) & " (Update Skipped)" & _
                        "Suggest Delete STID " & FStrSTID & " " & rsStuPer!FNAME & " " & rsStuPer!LNAME
                 Call DoLog
               End If
           Else    ' NO record in ExhibitStudents for the second found
             If FirstInExhStu = True Then ' THE FIRST FOUND student is THE ONLY one in exhibitStudents NO update. error message
                 MsgBox "There are Multiple Students and ONE ExhibitStudent table entries for " & vbCrLf & _
                       rsStuPer!FNAME & " " & rsStuPer!LNAME & " with different STIDs" & vbCrLf & _
                       "This record will be Skipped for now. Suggest: Delete STID " & CStr(rsStuPer!STID) & " (Student with no ExhibitStudent record) then re-import", vbCritical, "Duplicate Entries"
                 erst = "Duplicate Students? STIDs = " & FStrSTID & " and " & CStr(rsStuPer!STID) & " (Update Skipped)" & _
                        "Suggest Delete STID " & CStr(rsStuPer!STID) & " " & rsStuPer!FNAME & " " & rsStuPer!LNAME
                 Call DoLog
             Else   ' no record in Exhibit Students for either BUT NO update message delete either one  I choose the FIRST one found.
                 MsgBox "There are Multiple Students and NO ExhibitStudent table entries for " & vbCrLf & _
                       rsStuPer!FNAME & " " & rsStuPer!LNAME & " with different STIDs" & vbCrLf & _
                       "This record will be Skipped for now. Delete Unwanted Student locally then re-import", vbCritical, "Duplicate Entries"
                 erst = "Duplicate Students? STIDs = " & FStrSTID & " and " & CStr(rsStuPer!STID) & " (Update Skipped)" & _
                        "Suggest: Delete one Student, Person then re-import" & " " & rsStuPer!FNAME & " " & rsStuPer!LNAME
                 Call DoLog
             End If
           End If
          ' RSTExbitStu.Close
           ProcessStuPer = False  ' will cause this record to be skipped
           UpDateSTID = 0         ' duplicates on teamID 1 will never use these but set anyway
           UpdatePID = 0
           Exit Function
        End If   ' (if teamid = 1)
       ' Note UpdateStid and UpdatePID are set to the first found record at this point
       ' ******** GET HERE IF TEAMID = 2 or 3 and have duplicate students in the local data base already
        MsgBox "Possible Duplicate team # " & teamID & " Student: " & rsStuPer!FNAME & " " & rsStuPer!LNAME & vbCrLf & _
                  "       " & vbCrLf & _
                  "                        STID,    PID,  Phone, City,   Address" & vbCrLf & _
                  "STUDENT:                " & FStrSTID & ", " & FStrPID & ", " & FStrPhone & ", " & FStrCity & ", " & FStrAddr & vbCrLf & _
                  "Duplicate STUDENT: " & CStr(rsStuPer!STID) & ", " & CStr(rsStuPer!PID) & ", " & _
                        IIf(IsNull(rsStuPer!HOME_PHONE), "", rsStuPer!HOME_PHONE) & ", " & _
                        IIf(IsNull(rsStuPer!CITY), "", rsStuPer!CITY) & ", " & _
                        IIf(IsNull(rsStuPer!ADDR1), "", rsStuPer!ADDR1) & vbCrLf & _
                  "WEB Data:                                       " & StrPhone & ", " & StrCity & ", " & StrAddr & vbCrLf & _
                  " " & vbCrLf & _
               " Must continue - AND Web Data will UPDATE team member with STID = " & FStrSTID
        erst = "TeamMember " & teamID & " Duplicate Student " & rsStuPer!FNAME & " " & rsStuPer!LNAME & _
                " UPDATED STID: " & FStrSTID & _
                " Suggest: Check, then DELETE? STID: " & CStr(rsStuPer!STID)
        Call DoLog
        ProcessStuPer = False   ' set this so a message gets created in CmdExh() loop
        TeamDupStud = True      ' this stops the  team error message in CmdExh()
        Exit Function           ' Exit when have duplicate team 2 or 3 students.
      Else     '  --Rev 5.3.5 IF  2  check for 2nd entry in local student data failed   0nly one entry so far in local data.
         ' Rev 535 5.3.5 3/1/2010   This could be a duplicate student or a new student
         ' rev 5.3.5  at this point we either have a new student or... COULD still have a second web entry that has
         '    same first and last name but is really a different person and different exhibit.  That situation has
         '    NOT Yet Been checked.   To do this I should check phone number address age etc and see if seems different
         '    if this seems to be a new student we need to jump to AddStudent:
         '  Note this code will not work for teams
         
         '-----------Start added code rev 5.3.5 -----------------------------------------
        If teamID = 1 Then
         Dim Different_Count As Integer
         Different_Count = 0
         If Not FStrMI = StrMI Then Different_Count = Different_Count + 1
         If Not FStrPhone = StrPhone Then Different_Count = Different_Count + 1
         If Not FStrAddr = StrAddr Then Different_Count = Different_Count + 1
         If Not FStrCity = StrCity Then Different_Count = Different_Count + 1
         If Different_Count > 2 Then
           '  FStrSTID   ??see if this local student is ALSO in the ExhibitStudent table - it will be normally.
           ' Then the student we found locally is different and has an exhibit already. So the different one
           '  is probably a new entry for a new exhibit - just similar name
            RSTExbitStu.FindFirst ("STID = " & FStrSTID)
            If RSTExbitStu.NoMatch = False Then    'THE Student in local students table IS IN ExhibitStudents
                  If MsgBox("Web student entry " & RSTExhibitData!exfirstname & " " & RSTExhibitData!exlastname & _
                        " SEEMS different than an existing student (Exn = " & RSTExbitStu!EXN & ") with same First and Last Name!" & vbCrLf & _
                        IIf(FStrMI = StrMI, "", "Web MI = " & StrMI & "        Existing MI = " & FStrMI & vbCrLf) & _
                        "Web Phone = " & StrPhone & "       Exisiting Phone = " & FStrPhone & vbCrLf & _
                        "Web Addr = " & StrAddr & "         Exisiting Addr = " & FStrAddr & vbCrLf & _
                        "Web City = " & StrCity & "         Exisiting City = " & FStrCity & vbCrLf & _
                        "Web Phone = " & StrPhone & "       Exisiting Phone = " & FStrPhone & vbCrLf & vbCrLf & _
                       "Do you want to import web entry as a New Student / Exhibit??  (No will update Existing)", vbYesNo, "duplicate") = vbYes Then
                       
                       
                        erst = "Similar Student " & RSTExhibitData!exfirstname & " " & RSTExhibitData!exlastname & _
                            " - New Exhibit Added (Verify: Could have been an Update entry on web)"
                       Call DoLog
                       GoTo AddStudent
                  Else
                       erst = "Similar Student " & RSTExhibitData!exfirstname & " " & RSTExhibitData!exlastname & _
                           " - Current Exhibit Updated (Verify: Could have been a new web exhibit entry)"
                       Call DoLog
                    ' do nothing
                  End If
            End If
         End If   ' Differetn_Count > 2
        End If   ' Team = 1
        '  I do not know how to handle team 2 and 3 at this time.
        
        
        ' ----------End added code rev 5.3.5   ------------------------------
         
      End If    ' --IF 2 -- end of check for second entry of student in local data
    ' ----------  teamID = 1 or 2 or 3  Has only one Match in local  - SO OK TO UPDATE
    UpDateSTID = rsStuPer!STID
    UpdatePID = rsStuPer!PID
DoTheUpdate:      '   This assumes the person exists, the student exists
    StuPerCkOK = True
    ProcessPersons   ' do this for now
    If PersonError = True Then GoTo ErrorExit
    ProcessStudents  ' do this for now
    If StudentError = True Then GoTo ErrorExit
 Else   ' ----IF 1  -------------NO MATCH - add a persons record then a Students record---------
AddStudent:
      UpdatePID = 0
      UpDateSTID = 0
      StuPerCkOK = True
      ProcessPersons   ' this will add the new person
      If PersonError = True Then GoTo ErrorExit
      ProcessStudents  ' this will add the new student
      If StudentError = True Then GoTo ErrorExit
 End If       ' -IF 1 --------    End if ---------------------------------------------------
   
   ' At this point we have either skipped the record or.. we have the student and persons tables added or updated
   ' So we are ready to CHECK if the exhibit exits in ExhibitStudents table - The top level table for exhibits.
   
   Exit Function
ErrorExit:
   MsgBox "Error in Process" & IIf(PersonError = False And StudentError = False, "ProcessSTuPer Function", _
           IIf(PersonError = True, "ProcessPersons Sub", IIf(StudentError = True, "ProcessStudent Sub", _
           "Other ProcessstudPer"))) & ": " & Err.Description & vbCrLf & _
           "  *** The Web Record will be skipped.  Check data in Web database for records Not Exported!"
   ProcessStuPer = False
   TeamDupStud = False   ' make error message happen in CmdExh()
   StuPerCkOK = False
   UpDateSTID = 0   ' force add if somehow get to processstudent
   UpdatePID = 0
End Function
Public Sub ProcessPersons()
On Error GoTo ErrorLeave
Dim Quotes As String
quote = """"
'If teamID = 1 Then
'SQlStr = "SELECT [Fname] & [lname] AS [key], * FROM Persons WHERE ([Fname] & [lname])=" & quote & RSTExhibitData!exfirstname & RSTExhibitData!exlastname & """"
'End If
'If teamID = 2 Then
'SQlStr = "SELECT [Fname] & [lname] AS [key], * FROM Persons WHERE ([Fname] & [lname])=" & quote & RSTExhibitData!TM2Firstname & RSTExhibitData!TM2lastname & """"
'End If
'If teamID = 3 Then
'SQlStr = "SELECT [Fname] & [lname] AS [key], * FROM Persons WHERE ([Fname] & [lname])=" & quote & RSTExhibitData!TM3Firstname & RSTExhibitData!TM3lastname & """"
'End If
' Above obsolete - This is new because we now have UpdatePID = 0 for new and UpDatePID > 0 for update
If UpdatePID > 0 Then
   SQLstr = "SELECT * FROM Persons WHERE [PID] = " & UpdatePID
Else
   SQLstr = "SELECT * FROM Persons WHERE [PID] = -1"  '  should never find this one
End If
' -------------------------
Set RSTPerson = db.OpenRecordset(SQLstr)
' NEED to make sure if we find FNAME and LNAME that it is not a person of TP NOT ES .  so
' IF FIND name and ES <> ES make a manual decision.
If teamID = 1 Then   ' This is and individual OR a team project.
  ' Web form forces most data to be entered, so not many checks are required
  If RSTPerson.RecordCount = 0 Then ' Add a new person
        RSTPerson.AddNew
        RSTPerson!LNAME = Left(RSTExhibitData!exlastname, 20)
        RSTPerson!FNAME = RSTExhibitData!exfirstname
        RSTPerson!MI = IIf(IsNull(RSTExhibitData!exMidinit), Null, _
                          IIf(Len(RSTExhibitData!exMidinit) = 0, Null, Left(RSTExhibitData!exMidinit, 2)))
        'RSTPerson!MI = IIf(Len(RSTExhibitData!ExMidInit) = 0, " ", Left(RSTExhibitData!ExMidInit, 1))
        RSTPerson!ZIP = RSTExhibitData!exZIP
        RSTPerson!ADDR1 = Left(RSTExhibitData!exADDRESS, 30)
        RSTPerson!CITY = RSTExhibitData!exCITY
        RSTPerson!STATE = RSTExhibitData!exSTATE
        RSTPerson!HOME_PHONE = IIf(IsNull(RSTExhibitData!exPHONE), Null, _
                          IIf(Len(RSTExhibitData!exPHONE) = 0, Null, RSTExhibitData!exPHONE))
        'RSTPerson!HOME_PHONE = IIf(Len(RSTExhibitData!exphone) = 0, "9999999999", RSTExhibitData!exphone)
        RSTPerson!EMAIL = IIf(IsNull(RSTExhibitData!ExEMAIL), Null, _
                          IIf(Len(RSTExhibitData!ExEMAIL) = 0, Null, RSTExhibitData!ExEMAIL))
        'RSTPerson!EMAIL = IIf(Len(RSTExhibitData!exEMAIL) = 0, " ", RSTExhibitData!exEMAIL)
        TPValue = IIf(IsNull(RSTPerson!TP), "", RSTPerson!TP)
        Call setFieldTP(TPValue, "ES")   ' adds ES to TP ( at end if already has one or more TP)
        RSTPerson!TP = TPValue
        RSTPerson!LAST_CHG = RSTExhibitData!DateSubmitted  '  Not the Import date = 'Date'
        RSTPerson!Temp = "GETPID"
        RSTPerson.Update
        Set RSTPerson = db.OpenRecordset("SELECT * FROM persons Where TEMP='" & "GETPID'")
        RSTPerson.Edit
        RSTPerson!Temp = Null
        RSTPerson.Update
         
  Else                   '  found the person with the PID that is set
       RSTPerson.Edit
       RSTPerson!LNAME = Left(RSTExhibitData!exlastname, 20)
       RSTPerson!FNAME = RSTExhibitData!exfirstname
       RSTPerson!MI = IIf(IsNull(RSTExhibitData!exMidinit), Null, _
                          IIf(Len(RSTExhibitData!exMidinit) = 0, Null, Left(RSTExhibitData!exMidinit, 2)))
       'RSTPerson!MI = IIf(Len(RSTExhibitData!ExMidInit) = 0, " ", Left(RSTExhibitData!ExMidInit, 1))
       RSTPerson!ZIP = RSTExhibitData!exZIP
       TPValue = IIf(IsNull(RSTPerson!TP), "", RSTPerson!TP)  ' DES 4.0.4  Just in case not yet set
       Call setFieldTP(TPValue, "ES")   ' adds ES to TP ( at end if already has one or more TP)
       RSTPerson!TP = TPValue
       RSTPerson!ADDR1 = Left(RSTExhibitData!exADDRESS, 30)
       RSTPerson!CITY = RSTExhibitData!exCITY
       RSTPerson!STATE = RSTExhibitData!exSTATE
       RSTPerson!HOME_PHONE = IIf(IsNull(RSTExhibitData!exPHONE), Null, _
                          IIf(Len(RSTExhibitData!exPHONE) = 0, Null, RSTExhibitData!exPHONE))
       'RSTPerson!HOME_PHONE = IIf(Len(RSTExhibitData!Exphone) = 0, "9999999999", RSTExhibitData!Exphone)
        RSTPerson!EMAIL = IIf(IsNull(RSTExhibitData!ExEMAIL), Null, _
                          IIf(Len(RSTExhibitData!ExEMAIL) = 0, Null, RSTExhibitData!ExEMAIL))
       'RSTPerson!EMAIL = IIf(Len(RSTExhibitData!ExEMAIL) = 0, " ", RSTExhibitData!ExEMAIL)
       RSTPerson!LAST_CHG = RSTExhibitData!DateSubmitted 'not the Import date = 'Date'
       RSTPerson.Update
  End If
 End If
 If teamID = 2 Then  ' This is a Team project. Last name has been verified for TM2 but rest
                    ' of data could be missing.  SciFairData does not allow zero length Strings
                    ' so if the data is missing or null in the Web, I must store a Null in SciFairData
  If RSTPerson.RecordCount = 0 Then
        RSTPerson.AddNew
        RSTPerson!LNAME = Left(RSTExhibitData!TM2lastname, 20)
        RSTPerson!FNAME = IIf(IsNull(RSTExhibitData!TM2Firstname), Null, _
                          IIf(Len(RSTExhibitData!TM2Firstname) = 0, Null, RSTExhibitData!TM2Firstname))
        RSTPerson!MI = IIf(IsNull(RSTExhibitData!TM2Midinit), Null, _
                          IIf(Len(RSTExhibitData!TM2Midinit) = 0, Null, Left(RSTExhibitData!TM2Midinit, 2)))
        RSTPerson!ADDR1 = IIf(IsNull(RSTExhibitData!TM2ADDRESS), Null, _
                          IIf(Len(RSTExhibitData!TM2ADDRESS) = 0, Null, Left(RSTExhibitData!TM2ADDRESS, 30)))
        RSTPerson!CITY = IIf(IsNull(RSTExhibitData!TM2CITY), Null, _
                          IIf(Len(RSTExhibitData!TM2CITY) = 0, Null, RSTExhibitData!TM2CITY))
        RSTPerson!STATE = IIf(IsNull(RSTExhibitData!TM2STATE), Null, _
                          IIf(Len(RSTExhibitData!TM2STATE) = 0, Null, RSTExhibitData!TM2STATE))
        RSTPerson!ZIP = IIf(IsNull(RSTExhibitData!TM2ZIP), Null, _
                          IIf(Len(RSTExhibitData!TM2ZIP) = 0, Null, RSTExhibitData!TM2ZIP))
        RSTPerson!HOME_PHONE = IIf(IsNull(RSTExhibitData!TM2PHONE), Null, _
                          IIf(Len(RSTExhibitData!TM2PHONE) = 0, Null, RSTExhibitData!TM2PHONE))
        RSTPerson!EMAIL = IIf(IsNull(RSTExhibitData!TM2EMAIL), Null, _
                          IIf(Len(RSTExhibitData!TM2EMAIL) = 0, Null, RSTExhibitData!TM2EMAIL))
        TPValue = IIf(IsNull(RSTPerson!TP), "", RSTPerson!TP)
        Call setFieldTP(TPValue, "ES")   ' adds ES to TP ( at end if already has one or more TP)
        RSTPerson!TP = TPValue
        RSTPerson!LAST_CHG = RSTExhibitData!DateSubmitted
        RSTPerson!Temp = "GETPID"
        RSTPerson.Update
        ' This makes sure we have the current person when set up the Student
        Set RSTPerson = db.OpenRecordset("SELECT * FROM persons Where TEMP='" & "GETPID'")
        RSTPerson.Edit
        RSTPerson!Temp = Null
        RSTPerson.Update
  Else
       RSTPerson.Edit
       RSTPerson!LNAME = Left(RSTExhibitData!TM2lastname, 20)
        RSTPerson!FNAME = IIf(IsNull(RSTExhibitData!TM2Firstname), Null, _
                          IIf(Len(RSTExhibitData!TM2Firstname) = 0, Null, RSTExhibitData!TM2Firstname))
        ' 5.0.1  added Left() to select first char only
        RSTPerson!MI = IIf(IsNull(RSTExhibitData!TM2Midinit), Null, _
                          IIf(Len(RSTExhibitData!TM2Midinit) = 0, Null, Left(RSTExhibitData!TM2Midinit, 2)))
        RSTPerson!ADDR1 = IIf(IsNull(RSTExhibitData!TM2ADDRESS), Null, _
                          IIf(Len(RSTExhibitData!TM2ADDRESS) = 0, Null, Left(RSTExhibitData!TM2ADDRESS, 30)))
        RSTPerson!CITY = IIf(IsNull(RSTExhibitData!TM2CITY), Null, _
                          IIf(Len(RSTExhibitData!TM2CITY) = 0, Null, RSTExhibitData!TM2CITY))
        RSTPerson!STATE = IIf(IsNull(RSTExhibitData!TM2STATE), Null, _
                          IIf(Len(RSTExhibitData!TM2STATE) = 0, Null, RSTExhibitData!TM2STATE))
        RSTPerson!ZIP = IIf(IsNull(RSTExhibitData!TM2ZIP), Null, _
                          IIf(Len(RSTExhibitData!TM2ZIP) = 0, Null, RSTExhibitData!TM2ZIP))
        RSTPerson!HOME_PHONE = IIf(IsNull(RSTExhibitData!TM2PHONE), Null, _
                          IIf(Len(RSTExhibitData!TM2PHONE) = 0, Null, RSTExhibitData!TM2PHONE))
        RSTPerson!EMAIL = IIf(IsNull(RSTExhibitData!TM2EMAIL), Null, _
                          IIf(Len(RSTExhibitData!TM2EMAIL) = 0, Null, RSTExhibitData!TM2EMAIL))
       TPValue = IIf(IsNull(RSTPerson!TP), "", RSTPerson!TP)  '  Just in case not yet set
       Call setFieldTP(TPValue, "ES")   ' adds ES to TP ( at end if already has one or more TP)
       RSTPerson!TP = TPValue
       RSTPerson!LAST_CHG = RSTExhibitData!DateSubmitted
       RSTPerson.Update
  End If
End If
If teamID = 3 Then
  If RSTPerson.RecordCount = 0 Then
        RSTPerson.AddNew
        RSTPerson!LNAME = Left(RSTExhibitData!TM3lastname, 20)
        RSTPerson!FNAME = IIf(IsNull(RSTExhibitData!TM3Firstname), Null, _
                          IIf(Len(RSTExhibitData!TM3Firstname) = 0, Null, RSTExhibitData!TM3Firstname))
        ' 5.0.1  added Left() to select first char only
        RSTPerson!MI = IIf(IsNull(RSTExhibitData!TM3Midinit), Null, _
                          IIf(Len(RSTExhibitData!TM3Midinit) = 0, Null, Left(RSTExhibitData!TM3Midinit, 2)))
        RSTPerson!ADDR1 = IIf(IsNull(RSTExhibitData!TM3ADDRESS), Null, _
                          IIf(Len(RSTExhibitData!TM3ADDRESS) = 0, Null, Left(RSTExhibitData!TM3ADDRESS, 30)))
        RSTPerson!CITY = IIf(IsNull(RSTExhibitData!TM3CITY), Null, _
                          IIf(Len(RSTExhibitData!TM3CITY) = 0, Null, RSTExhibitData!TM3CITY))
        RSTPerson!STATE = IIf(IsNull(RSTExhibitData!TM3STATE), Null, _
                          IIf(Len(RSTExhibitData!TM3STATE) = 0, Null, RSTExhibitData!TM3STATE))
        RSTPerson!ZIP = IIf(IsNull(RSTExhibitData!TM3ZIP), Null, _
                          IIf(Len(RSTExhibitData!TM3ZIP) = 0, Null, RSTExhibitData!TM3ZIP))
        RSTPerson!HOME_PHONE = IIf(IsNull(RSTExhibitData!TM3PHONE), Null, _
                          IIf(Len(RSTExhibitData!TM3PHONE) = 0, Null, RSTExhibitData!TM3PHONE))
        RSTPerson!EMAIL = IIf(IsNull(RSTExhibitData!TM3EMAIL), Null, _
                          IIf(Len(RSTExhibitData!TM3EMAIL) = 0, Null, RSTExhibitData!TM3EMAIL))
        TPValue = IIf(IsNull(RSTPerson!TP), "", RSTPerson!TP)
        Call setFieldTP(TPValue, "ES")   ' adds ES to TP ( at end if already has one or more TP)
        RSTPerson!TP = TPValue
        RSTPerson!LAST_CHG = RSTExhibitData!DateSubmitted
        RSTPerson!Temp = "GETPID"
        RSTPerson.Update
        Set RSTPerson = db.OpenRecordset("SELECT * FROM persons Where TEMP='" & "GETPID'")
        RSTPerson.Edit
        RSTPerson!Temp = Null
        RSTPerson.Update
         
  Else
       RSTPerson.Edit
       RSTPerson!LNAME = Left(RSTExhibitData!TM3lastname, 20)
        RSTPerson!FNAME = IIf(IsNull(RSTExhibitData!TM3Firstname), Null, _
                          IIf(Len(RSTExhibitData!TM3Firstname) = 0, Null, RSTExhibitData!TM3Firstname))
        RSTPerson!MI = IIf(IsNull(RSTExhibitData!TM3Midinit), Null, _
                          IIf(Len(RSTExhibitData!TM3Midinit) = 0, Null, Left(RSTExhibitData!TM3Midinit, 2)))
        RSTPerson!ADDR1 = IIf(IsNull(RSTExhibitData!TM3ADDRESS), Null, _
                          IIf(Len(RSTExhibitData!TM3ADDRESS) = 0, Null, Left(RSTExhibitData!TM3ADDRESS, 30)))
        RSTPerson!CITY = IIf(IsNull(RSTExhibitData!TM3CITY), Null, _
                          IIf(Len(RSTExhibitData!TM3CITY) = 0, Null, RSTExhibitData!TM3CITY))
        RSTPerson!STATE = IIf(IsNull(RSTExhibitData!TM3STATE), Null, _
                          IIf(Len(RSTExhibitData!TM3STATE) = 0, Null, RSTExhibitData!TM3STATE))
        RSTPerson!ZIP = IIf(IsNull(RSTExhibitData!TM3ZIP), Null, _
                          IIf(Len(RSTExhibitData!TM3ZIP) = 0, Null, RSTExhibitData!TM3ZIP))
        RSTPerson!HOME_PHONE = IIf(IsNull(RSTExhibitData!TM3PHONE), Null, _
                          IIf(Len(RSTExhibitData!TM3PHONE) = 0, Null, RSTExhibitData!TM3PHONE))
        RSTPerson!EMAIL = IIf(IsNull(RSTExhibitData!TM3EMAIL), Null, _
                          IIf(Len(RSTExhibitData!TM3EMAIL) = 0, Null, RSTExhibitData!TM3EMAIL))
       TPValue = IIf(IsNull(RSTPerson!TP), "", RSTPerson!TP)  ' DES 4.0.4  Just in case not yet set
       Call setFieldTP(TPValue, "ES")   ' adds ES to TP ( at end if already has one or more TP)
       RSTPerson!TP = TPValue
       RSTPerson!LAST_CHG = RSTExhibitData!DateSubmitted
       RSTPerson.Update
  End If
 End If
 Exit Sub
ErrorLeave:
 If teamID > 1 Then
  MsgBox "READ THIS CAREFULLY. Error in ProcessPersons Subroutine: " & vbCrLf & _
  Err.Description & vbCrLf & _
  "You will see one more Messages after this one   " & vbCrLf & _
  "IMPORTANT: YOU NOW HAVE have an ExhibitData Record & ExhibitStudents Record for an exhibit " & MyEXN & vbCrLf & _
  " You will have to delete both manually , fix the Data in the Web (persons type entries) and try again   " & vbCrLf & _
  " Student Last name = " & RSTPerson!LNAME & " team member: " & teamID
 Else
  MsgBox "Error in ProcessPersons Subroutine: " & vbCrLf & _
    "See Next Message"
 End If
 PersonError = True
End Sub
Public Sub ProcessStudents()
' THE GBLPID is found or set in ProcessPersons
' What Happens if a new record at Web site for same exhibit with new team members ???
'GBLPID = RSTPerson!PID
On Error GoTo ErrorLeave
'Check to see if this person is on the students table
 'If teamID = 1, 2,3 Not needed in this routine since RSTPerson is already setup for the correct team member
  Set RSTStu = db.OpenRecordset("SELECT * FROM Students where PID=" & RSTPerson!PID)
 ' Note do not need to use UpdateSTID  but check for debug purposes
  If RSTStu.RecordCount > 0 Then
    If UpDateSTID > 0 And UpDateSTID <> RSTStu!STID Then
     MsgBox "Error STID found in ProcessStuPer not same as STID in ProcessStudents"
    End If
  End If
  If teamID = 1 Then
            If RSTStu.RecordCount = 0 Then
              RSTStu.AddNew 'add information  table
              RSTStu!PID = RSTPerson!PID
              RSTStu!GRADE = RSTExhibitData!GRADE    '   All students are assumed to be in the same grade
              RSTStu!SEX = IIf(IsNull(RSTExhibitData!ExGender), Null, _
                          IIf(Len(RSTExhibitData!ExGender) = 0, Null, RSTExhibitData!ExGender))
              RSTStu!SSN = IIf(IsNull(RSTExhibitData!ExSSN), Null, _
                          IIf(Len(RSTExhibitData!ExSSN) = 0, Null, RSTExhibitData!ExSSN))
              RSTStu!Temp = "GETSTUID"
              RSTStu.Update
              ' This sets the student record current for the ExhibitStudents table entry
              Set RSTStu = db.OpenRecordset("SELECT * FROM Students where Temp='" & "GETSTUID" & "'")
              RSTStu.Edit
              RSTStu!Temp = Null
              RSTStu.Update
           Else
           RSTStu.Edit
              RSTStu!GRADE = RSTExhibitData!GRADE
              RSTStu!SEX = IIf(IsNull(RSTExhibitData!ExGender), Null, _
                          IIf(Len(RSTExhibitData!ExGender) = 0, Null, RSTExhibitData!ExGender))
              RSTStu!SSN = IIf(IsNull(RSTExhibitData!ExSSN), Null, _
                          IIf(Len(RSTExhibitData!ExSSN) = 0, Null, RSTExhibitData!ExSSN))
           RSTStu.Update
           End If
  End If ' team id 1
  If teamID = 2 Then
            If RSTStu.RecordCount = 0 Then
              RSTStu.AddNew 'add information  table
              RSTStu!PID = RSTPerson!PID
              RSTStu!GRADE = RSTExhibitData!GRADE   ' All students are assumed to be in the same grade
              RSTStu!SEX = IIf(IsNull(RSTExhibitData!TM2Gender), Null, _
                          IIf(Len(RSTExhibitData!TM2Gender) = 0, Null, RSTExhibitData!TM2Gender))
              RSTStu!SSN = IIf(IsNull(RSTExhibitData!TM2SSN), Null, _
                          IIf(Len(RSTExhibitData!TM2SSN) = 0, Null, RSTExhibitData!TM2SSN))
              RSTStu!Temp = "GETSTUID"
              RSTStu.Update
              ' This sets the student record current for the ExhibitStudents table entry
              Set RSTStu = db.OpenRecordset("SELECT * FROM Students where Temp='" & "GETSTUID" & "'")
              RSTStu.Edit
              RSTStu!Temp = Null
              RSTStu.Update
           Else
           RSTStu.Edit
              RSTStu!GRADE = RSTExhibitData!GRADE
              RSTStu!SEX = IIf(IsNull(RSTExhibitData!TM2Gender), Null, _
                          IIf(Len(RSTExhibitData!TM2Gender) = 0, Null, RSTExhibitData!TM2Gender))
              RSTStu!SSN = IIf(IsNull(RSTExhibitData!TM2SSN), Null, _
                          IIf(Len(RSTExhibitData!TM2SSN) = 0, Null, RSTExhibitData!TM2SSN))
           RSTStu.Update
           End If
  End If ' team id 2
  If teamID = 3 Then
            If RSTStu.RecordCount = 0 Then
              RSTStu.AddNew 'add information  table
              RSTStu!PID = RSTPerson!PID
              RSTStu!GRADE = RSTExhibitData!GRADE   ' All students are assumed to be in the same grade
              RSTStu!SEX = IIf(IsNull(RSTExhibitData!TM3Gender), Null, _
                          IIf(Len(RSTExhibitData!TM3Gender) = 0, Null, RSTExhibitData!TM3Gender))
              RSTStu!SSN = IIf(IsNull(RSTExhibitData!TM3SSN), Null, _
                          IIf(Len(RSTExhibitData!TM3SSN) = 0, Null, RSTExhibitData!TM3SSN))
              RSTStu!Temp = "GETSTUID"
              RSTStu.Update
              ' This sets the student record current for the ExhibitStudents table entry
              Set RSTStu = db.OpenRecordset("SELECT * FROM Students where Temp='" & "GETSTUID" & "'")
              RSTStu.Edit
              RSTStu!Temp = Null
              RSTStu.Update
           Else
           RSTStu.Edit
              RSTStu!GRADE = RSTExhibitData!GRADE
              RSTStu!SEX = IIf(IsNull(RSTExhibitData!TM3Gender), Null, _
                          IIf(Len(RSTExhibitData!TM3Gender) = 0, Null, RSTExhibitData!TM3Gender))
              RSTStu!SSN = IIf(IsNull(RSTExhibitData!TM3SSN), Null, _
                          IIf(Len(RSTExhibitData!TM3SSN) = 0, Null, RSTExhibitData!TM3SSN))
           RSTStu.Update
           End If
  
  End If ' team id 3
  Exit Sub
ErrorLeave:
  If teamID > 1 Then
     MsgBox "READ THIS CAREFULLY. Error in ProcessStudents Subroutine: " & vbCrLf & _
     Err.Description & vbCrLf & _
    "You will see one more Message after this one   " & vbCrLf & _
  "IMPORTANT: YOU NOW HAVE have an ExhibitData Record & ExhibitStudents Record for an exhibit " & MyEXN & vbCrLf & _
  " You will have to delete both records manually, fix the Data in the Web (Student type entries) and try again." & vbCrLf & _
  " Student Last name = " & RSTPerson!LNAME & " team member: " & teamID
  Else
   MsgBox "Error in ProcessStudents Subroutine: " & Err.Description & vbCrLf & _
     " See Next Message"
  End If
  StudentError = True
End Sub
Public Sub ExbitStudent(teamID As Integer)
'  FILLS in the ExhibitStudents Table records - one for each team member.
On Error GoTo ErrorLeave
' First check if the STID already exists in the ExhibitStudents Table - If so, this is definitly a re-entry in
'   the web data by the student (idividual or Team) so we know NOT to add a new exhibit  (go to Else below)
'Set RSTExbitStu = db.OpenRecordset("SELECT * FROM ExhibitStudents WHERE STID=" & RSTStu!STID)
RSTExbitStu.FindFirst ("STID = " & RSTStu!STID)
If RSTExbitStu.NoMatch = True Then
'If RSTExbitStu.RecordCount = 0 Then
      '  REV 5.2.2 Do I need some more tests to see if this is already entered.
      '    If the FName, LName match student person then I have the STID so when would there Already be an entry
      '    but not under that STID
      '  ANSWER if there are duplicate student records for the same student/person then there COULD be an exhibitStudent
      '     table entry for the one or both duplicate students.   We found that duplicate in the check StudPer routine and
      '     the code there always skips the entry for student #1 or individuals (Never get here)
      '     In case of duplicate team #2 or 3  code has updated one student record (First found) and so we will be      '     to add or update the Exhibit Student Record also.
      '     adding or updating an ExhibitStudent table record for that student PERIOD!!  There could be another
      '     ExhibitStudent Record for the duplicate student STID.
      '     many messages have been give so I do not try to resolve any more in the code until later perhaps.
   RSTExbitStu.AddNew
   RSTExbitStu!F_ORD = teamID
   RSTExbitStu!STID = RSTStu!STID
   If teamID > 1 Then  ' Rev 5.2.1  never use MyExn on team members
      If UpdateEXN > 0 Then   '  If 0 then must be some type error in my program logic
         RSTExbitStu!EXN = UpdateEXN
      Else
        MsgBox "Error in program logic ExbitStudent teamID > 1 and UpdateEXN still 0 "
      End If
   Else    ' TeamID = 1 and add new so use next available EXN
     RSTExbitStu!EXN = MyEXN     ' Are adding the first student and did not exist so use next avail EXN\
     UpdateEXN = MyEXN       '  rev 5.2.1   Team members 2 and 3  Always Use UpdateEXN
   End If
   RSTExbitStu!FYR = FairYear()  'Use stored Fair year in SciFairMaster, not current year and not value in Web Data Base
   ' Note:  .Update is done in ExhbitRecord() Next routine
 Else
UpdateExOnly:
 ' EDIT   If we have a match, then there us a duplicate record in the web site (re-entry by this student or..
 '      The export flag has been unchecked and it is the same record being re-imported.
 '   This is possible if student does a back arrow on the web and ignored the warning about sending the record again
 '   or if there is an error in the record for teams after the first student, exhibitstudent and exhibit records are added
 '   or if the exported flag has been unchecked
 '   If I find a record in Exhibit Students then I must USE the Exhibit number there, NOT MyExn
   RSTExbitStu.Edit
   'RSTExbitStu!STID = RSTStu!STID   ' No need to change, we found this
   RSTExbitStu!F_ORD = teamID        ' ?? Did the Team student change
   If teamID = 1 Then
     NumExhUpdated = NumExhUpdated + 1
     UpdateEXN = RSTExbitStu!EXN   '  Rev 5.2.1    attempt to fix team reentries (students add new record or ??)
   End If
  ' RSTExbitStu!EXN = MyEXN       ' Especially DO NOT CHANGE THIS because we have incremented the EXN
   'RSTExbitStu!FYR = FairYear()    ' No need to change - exhibitstudents record is cleared each new year
   ' NOTE   .Update is done in ExhibitRecord()
  End If
  Exit Sub
ErrorLeave:
  MsgBox "ExbitStudent: " & Err.Description
End Sub
Public Sub ExhibitRecord()
 On Error GoTo ErrInExhibitData
' See if EXN and student in current ExhibitStudent record has a matching ExhibitData
' NOTTE:  For team member 2 and 3.  This is not even called!
' So what happens if double entry in web data.  WE do not change the Exn above so
'  NOW the select finds the Previous Exhibit record and only edits.
'  This prevents two exhibit records for the same ExhbitStudent Record.
  Dim Temp As String
  Dim CrLfLoc As Integer
  Dim FndCrLf As Boolean
  FndCrLf = False
  Temp = RSTExhibitData!projTitle  ' get first 100 characters
LookAgain:   ' This was done when title was a 'memo' field. Changed from memo to text type for title.
             ' So this is probably not needed any more.   I leave code anyway - does not hurt
  CrLfLoc = InStr(1, Temp, vbCrLf)
  If CrLfLoc > 0 Then
     Temp = Mid(Temp, 1, CrLfLoc - 1) & " - " & Mid(Temp, CrLfLoc + 2, Len(Temp))
     FndCrLf = True
     GoTo LookAgain
  End If
  If FndCrLf = True Then
     MsgBox "Exhibit " & RSTExbitStu!EXN & ": Title had 'New Line'(CR/LF) in Title! Replaced with ' - '"
     erst = "CR/LF (New Line) in Title! Replaced by ' - ' Exn= " & RSTExbitStu!EXN
     Call DoLog
  End If
  ' ***********   See if the exhibit exists.   It should if this is a re-entry
  Set RSTExbit = db.OpenRecordset("SELECT * FROM ExhibitData where EXN= " & RSTExbitStu!EXN)
     ' record count is not accurate unless movelast then movefirst unless... it is 0 which is accurate
      If RSTExbit.RecordCount = 0 Then
              'Add
              RSTExbit.AddNew
              RSTExbit!EXN = RSTExbitStu!EXN
              RSTExbit!FYR = FairYear()
              RSTExbit!JCAT = RSTExhibitData!Category
              Call GetNCAT  ' Get the National Category from the JCAT
              RSTExbit!EXHB_TITLE = Left(Temp, 100)  ' the project title cleared of CRLF and trimmed
              RSTExbit!Abstract = RSTExhibitData!Abstract
              RSTExbit!FLOOR = RSTExhibitData!FLOOR
              RSTExbit!SCH_CODE = RSTExhibitData!SCH_CODE
              'add the TID
              RSTExbit!TID = RSTExhibitData!TID
             ' ----- Added these  4.0.4
              RSTExbit!ENTRY_DATE = RSTExhibitData!DateSubmitted
              ' Rev 5.4.0 note only  Note I set TeamEx if web entry is team.
              '   Note if is a team category - TEAM is set in Categories table.
              RSTExbit!TeamEx = IsTeam  ' Set this but is probably not used in SciFairMaster
                ' ------------
              RSTExbit.Update
              RSTExbitStu.Update   '   Note. the data was changed in ExbitStudent() routine - waited til here to update
        Else
             'EDIT
              RSTExbit.Edit
             RSTExbit!JCAT = RSTExhibitData!Category
             Call GetNCAT   ' get National category from the JCAT.
             ' RSTExbit!FYR = FairYear()   ' Not really need to change
             RSTExbit!EXHB_TITLE = Left(Temp, 100)
             RSTExbit!Abstract = RSTExhibitData!Abstract
             RSTExbit!FLOOR = RSTExhibitData!FLOOR
             RSTExbit!TID = RSTExhibitData!TID
            ' ----- Added these  4.0.4
             RSTExbit!ENTRY_DATE = RSTExhibitData!DateSubmitted
             RSTExbit!TeamEx = IsTeam
           ' ------------
             RSTExbit.Update
             RSTExbitStu.Update  ' NOTE the data was changed in ExbitStudent() routine - waited til here to update
       End If
       Dim StrTP As String
       StrTP = IIf(IsNull(RSTTeachers!TP), "", RSTTeachers!TP)
       Call setFieldTP(StrTP, "ET")
       RSTTeachers.MoveFirst
       'this findfirst is probably not required since it was found in exhibit check
       RSTTeachers.FindFirst ("TID = " & RSTExhibitData!TID)
       If RSTTeachers.NoMatch Then   '' not found
          'This should never happen - it was found in exhibitcheck.
       Else  ' found it
         RSTTeachers.Edit
         RSTTeachers!TP = StrTP
         RSTTeachers.Update
       End If
       Exit Sub
ErrInExhibitData:
'  This should never be called after I fix up the CheckExhibit() function.
'  DES Fixed this up to handle most problems searching the error string for info
'  judgetypes, or teachers,  then set the appropriate JCAT or TID to null and put data in errorTable
AnotherErr:     '  if both type errors we return here
  If Err = 3201 Then
   MsgBox "Error not found in CheckExhibit - Record Imported as noted in WebErrorLog Table!"
   If InStr(Err.Description, "JudgeTypes") <> 0 Then
      erst = "Imported" & RSTExhibitData!Category & " JCAT Bad-TID & JCAT Both Set NULL!"
   End If
   If InStr(Err.Description, "Teachers") <> 0 Then
      erst = "Imported" & RSTExhibitData!TID & " TID Bad-JCAT & TID Both Set NULL!!"
    End If
    Call DoLog
    ExBadImported = ExBadImported + 1
   ' sometimes a record has both errors this is the only fix I can do for now
    RSTExbit!TID = Null
    RSTExbit!JCAT = Null  '   Remove when figure out how to fix both problems
   '-----    Sometimes a record has both errors
   RSTExbit.Update  '  NEED TO FIX THIS UP SO IT WORKS IF BOTH JCAT AND TID do not exist in SciFairData
   Resume Next   ' This will pickup the RSTExbitStu.Update
  End If  ' error 3201
  '  Note here I do not update the ExhibitStudent Record so things are left in a mess.
  
ErrorLeave:
  MsgBox "ExhibitData Record Error: " & Err.Description & vbCrLf & _
        " Local ExhibitStudent table data for Exn = " & RSTExbitStu!EXN & " may not have a cooresponding ExhibitData Record" & vbCrLf & _
        " You will have to manually clean up the local data, fix up the cooresponding web record and re-import" & vbCrLf & _
        " Exhibit Title = " & RSTExhibitData!projTitle
        
End Sub
Public Sub ProcessSchool()
On Error GoTo ErrorLeave
Set RSTRSTSch = db.OpenRecordset("SELECT * FROM Schools where SCH_CODE=" & RSTExhibitData!SCH_CODE)
'  This should never fail to find the school if updates are done regularly etc.  And..  if the school does not
'    exist we have already skipped the record.  I will leave this as a good check.
   If RSTRSTSch.RecordCount = 0 Then
     'Add
     '
     MsgBox "Added a new School - SCH_CODE not in SciFairData- should never happen" & vbCrLf & _
            "Exhibit Title " & RSTExhibitData!projTitle
     erst = "Added SCH_CODE: " & RSTExhibitData!SCH_CODE
     Call DoLog
     '
     RSTRSTSch.AddNew
     RSTRSTSch!P_PID = RSTPerson!PID
     RSTRSTSch!SCH_CODE = RSTExhibitData!SCH_CODE
     RSTRSTSch!SCHOOL = RSTExhibitData!SCHOOL
     RSTRSTSch.Update
   End If
   Exit Sub
ErrorLeave:
  MsgBox "ProcessSchool :" & Err.Description
End Sub

Private Sub btnCats_Click()
 ' Rev 531 5.3.1 Added update to NatCategories in Web site and eliminated the select for Categories.xml
 On Error GoTo SubError
 Dim RSTFairInfo As Recordset
 Dim RSTISEFVotes As Recordset  ' rev 5.3.7
 Dim MyWebdbPath As String
 Dim InitPath As String
 Dim db As DAO.Database
 Dim JudgeTypes As Recordset
 Dim SQLstr As String
 Dim Cnt As Integer
 Dim FileName As String
 Dim Strfilter As String
 Dim i As Integer
 Dim clearRTS As Boolean
 Rev.SetFocus
 btnCats.Enabled = False
 btnClose.Enabled = False
 Set db = CurrentDb
 Set RSTFairInfo = db.OpenRecordset("SELECT * FROM FairInfo WHERE Fair_Year = " & FairYear())
 MyWebdbPath = RSTFairInfo!WebdbPath
 RSTFairInfo.Close
 For i = Len(MyWebdbPath) To 1 Step -1  '  Find the last '\' which is befor the SciFairWebData.mdb part.
  If Mid(MyWebdbPath, i, 1) = "\" Or Mid(MyWebdbPath, i, 1) = "/" Then Exit For
 Next i
 InitPath = Mid(MyWebdbPath, 1, i - 1)  ' This is full path with App_Data but does not have '\' at the end
 clearRTS = False  ' rev 5.3.3  do not clear the final scores process flags
 If Not IsNull(Me.OpenArgs) Then  ' Rev 5.3.3 5.3.7 do a different message if called from Judge Scores Entry
   clearRTS = True    ' called once only from the Judges Scores Entry so clear the final scores process flags
   If MsgBox("CAUTION Are you sure! This clears most fields in the Categories table AND the WebCategoies table" & vbCrLf & _
         "Do this only once before starting scanning. Do NOT do this after scanning starts!" & vbCrLf & _
         " Clears LocFinal, S_TO_STATE, S_ALT in local categories table.  Clears InputFinal, LastAcc, LastUpd, " & vbCrLf & _
         "  FinalUpld, RecToState, LocFinal, FinalToState,FinalAlt, RecAlt in NatCategories table (web)" & vbCrLf & _
         " Delets all data in ISEFVotes (web)", _
         vbYesNo, "Clear ALL Category Data") = vbNo Then
         btnCats.Enabled = True
         btnClose.Enabled = True
         MsgBox "Aborted"
         DoCmd.Close acForm, Me.Form.Name
         Exit Sub
   End If
 Else
 If DoCatUpdateNoMsg = False Then
  If MsgBox("DO ANYTIME! REQUIRED if Categories, Judge Categories, N_TO_STATE or N_ALT Change!" & vbCrLf & _
   "This Uploads Judge Categories from JudgeTypes table to 'Categories.xml' on the Web Site" & vbCrLf & _
   " It Also Uploads data from 'Categories' table to 'NatCategories' Table (National Categories) in SciFairWebData." & vbCrLf & _
   "  Note: Only 'Category Name', 'N_TO_STATE' and 'N_ALT' are changed on the website." & vbCrLf & _
   "Proceed?", vbYesNo, "Build Categories.xml and NatCategories?") = vbNo Then
      btnCats.Enabled = True
      btnClose.Enabled = True
      Exit Sub
   End If
 End If
''Ask for SaveFileName  removed rev 5.3.1
End If
' rev 5.3.1
FileName = InitPath & "\Categories.xml"
Dim LastFile As String
LastFile = FileName & ".last"
On Error Resume Next
' delete the file .last
Kill LastFile   ' if not exist resume next
'RenameFile:
Name FileName As LastFile   ' if not exist then resume next
Close #311
On Error GoTo SubError
  ' EXAMPLE of required file format.  Notice that '&' is not allowed so must convert them.
'<?xml version="1.0" ?>
'<Categorys>
'  <Category Value="-- Choose a Category --" Text="-- Choose a Category --" />
'  <Category Value="JANI" Text="JANI Junior Animal Sciences" />
'  <Category Value="JBEH" Text="JBEH Junior Behavioral &amp; Social Sciences" /> '   etc
'   <Category Value="STPHY" Text="STPHY Senior Team Physical Science Projects" />
'</Categorys>
  Open FileName For Output As #311
   Print #311, "<?xml version= ""1.0"" ?>"
   Print #311, "<Categorys>"
   Print #311, "  <Category Value=""-- Choose a Category --"" Text=""-- Choose a Category --"" />"
   'SQLstr = "SELECT * from JudgeTypes"
   ' Rev 5.2.3    Need the team flag so I can verify the word 'Team' is in the JCAT NAME so that I can selectively
   '   load team categories versu non-team categories so students can not select wrong Categories.
   SQLstr = "SELECT JudgeTypeCategories.JCAT, JudgeTypes.[JCAT NAME], Categories.TEAM, Categories.CATNAME, " & _
        "Categories.LocFinal FROM Categories RIGHT JOIN (JudgeTypes RIGHT JOIN JudgeTypeCategories ON JudgeTypes.JCAT = " & _
        "JudgeTypeCategories.JCAT) ON Categories.NCAT = JudgeTypeCategories.NCAT ORDER BY Categories.NCAT, JudgeTypes.[JCAT];"

   Set JudgeTypes = CurrentDb().OpenRecordset(SQLstr, , dbOpenDynaset)
   Dim NewjcatName As String
   With JudgeTypes
     .MoveFirst
     Do While Not .EOF
       NewjcatName = ![JCAT NAME]
       ' replace all the '&' with '&amp:'
       For i = 1 To Len(NewjcatName)
         If Mid(NewjcatName, i, 1) = "&" Then
           NewjcatName = Mid(NewjcatName, 1, i) & "amp;" & Mid(NewjcatName, i + 1, Len(NewjcatName))
         End If
       Next i
       ' Rev 5.2.3  check if word team exists where it is required and not where it is not required
       If !TEAM = False Then
          If InStr(1, NewjcatName, "Team") > 0 Then   ' Not a team category so word team Not allowed
           MsgBox "Warning:  You have a NON-TEAM Category with the word 'Team' in the [JCAT NAME]!" & vbCrLf & _
                " This will cause improper filling of the Category Selection boxes in the" & vbcrfl & _
                " Exhibits Entry Form on the Web site. Fix this problem and UpDate Categories again."
          End If
       Else
          If InStr(1, NewjcatName, "Team") = 0 Then  ' team not in title so error
           MsgBox "Warning:  You have a TEAM Category WITHOUT the word 'Team' in the [JCAT NAME]!" & vbCrLf & _
                " This will cause improper filling of the Category Selection boxes in the" & vbcrfl & _
                " Exhibits Entry Form on the Web site. Fix this problem and UpDate Categories again."
          End If
       End If
       Print #311, "  <Category Value=""" & ![JCAT] & """ Text=""" & NewjcatName & """ />"
       Cnt = Cnt + 1
       .MoveNext
     Loop
     .Close
   End With
   Print #311, "</Categorys>"
   Close #311
   btnClose.Enabled = True
   btnCats.Enabled = True
   'MsgBox Cnt & " records written! (One for each Judge Type)" & vbCrLf & _
   '             "Categories.xml has been updated succesfully!"
   '  Start the update of the NatCategories Table.
   ' MyWebdbPath = RSTFairInfo!WebdbPath
   'If MsgBox("Update the NatCategories Table?", vbYesNo, "Update NatCategories?") = vbYes Then
   '  open local  Categories table
     Dim rsLCat As Recordset
     Dim rsWebCat As Recordset
     Set rsLCat = db.OpenRecordset("Select * from Categories")
    '  open remote table
     Set dbweb = DBEngine.OpenDatabase(MyWebdbPath)
     Set rsWebCat = dbweb.OpenRecordset("Select * from NatCategories")  ' Get all fields
     ' rev 5.5.4  554 DES  Check if no rswebCAT records
     If Not rsWebCat.EOF Then
          rsWebCat.MoveLast
          rsWebCat.MoveFirst
     End If   ' end Rev 554 mod
     rsLCat.MoveFirst
    ' for each in remote if not in local, delete remote  This way we keep current information
     With rsLCat
       Do While Not rsWebCat.EOF
        .FindFirst ("[NCAT] = '" & rsWebCat!NCAT) & "'"   ' see if find in local
        If .NoMatch Then
          rsWebCat.Delete    '  Delete web record  if NCCAT not in local Categories
        End If
        rsWebCat.MoveNext
       Loop
       ' for each in local if not in remote, add else update title, to state, etc.  Do not change other fields
       '   used for keeping track of chairs work.
       rsLCat.MoveFirst
       ' rev 5.5.4  554 DES  Check if no rswebCAT records
       If Not rsWebCat.EOF Then
          rsWebCat.MoveFirst
       End If ' end rev 544 mod
       Do While Not .EOF   ' go thru the local data base NOTE: Never change or set chair data or scores upload data
                           ' ONLY to state and n_alt are change or catname
          If clearRTS = True Then  'this was called from the judge scores form so need to clear this local flag
            .Edit
            !LocFinal = Null       ' clear the local final scores process status
            !S_TO_STATE = 0   'rev 5.3.5  the Selected (FINAL) number to state
            !S_ALT = 0        'Rev 5.3.5  the final number alternates
            .Update
          End If
          rsWebCat.FindFirst ("NCAT = '" & !NCAT & "'")
          If rsWebCat.NoMatch Then   ' did not find category in remote **** ADD IT ******
             rsWebCat.AddNew
             rsWebCat!NCAT = !NCAT
             rsWebCat!CATNAME = !CATNAME
             rsWebCat!tostate = !N_TO_STATE  ' The Allocated number to state
             rsWebCat!Alternate = !N_ALT     '
             rsWebCat!LocFinal = !LocFinal   ' duplicate the local final scores process
               rsWebCat!InputFinal = False  ' chair input is NOT final
               rsWebCat!LastAcc = Null   ' LastAcc = last CHANGE made in website chairs inputs
               rsWebCat!recToState = 0   ' Recommend none to state
               rsWebCat!RecAlt = 0
               rsWebCat!FinalToState = 0
               rsWebCat!FinalAlt = 0
               rsWebCat!LastUpd = Null     ' Last upload of scores to web - not done
               rsWebCat!LastDld = Null     '  Final Scores download has not been done
               rsWebCat!FinalUpld = False   ' A final upload and lock of final results has not been done.
             rsWebCat.Update
          Else    ' Did find category in remote so just update
             rsWebCat.Edit
             rsWebCat!CATNAME = !CATNAME
             rsWebCat!tostate = !N_TO_STATE  ' These are updated every time so they must not be changed by
             rsWebCat!Alternate = !N_ALT     ' the chairs or master chairs on the web site
             '****  NOTE  **** CALLED FROM THE JUDGE SCORES ENTRY SO CLEAR ALL FLAGS IN WEBSITE ********
             If clearRTS = True Then  '   this was called from the judge scores form so need to clear this
                   ' Note that the local table Categories.LocFinal needs to be cleared also but that was
                   ' Done in the Clear All Scores button in Judges Scores Entry form.
               rsWebCat!InputFinal = False  ' chair input is NOT final
               rsWebCat!LastAcc = Null   ' LastAcc = last CHANGE made in website chairs inputs
               rsWebCat!recToState = 0   ' Recommend none to state
               rsWebCat!RecAlt = 0
               rsWebCat!FinalToState = 0
               rsWebCat!FinalAlt = 0
               rsWebCat!LastUpd = Null     ' Last upload of scores to web - not done
               rsWebCat!LastDld = Null     '  Final Scores download has not been done
               rsWebCat!FinalUpld = False   ' A final upload and lock of final results has not been done.
               rsWebCat!LocFinal = Null     ' location final scores entry
             End If
             rsWebCat.Update
          End If
          .MoveNext
       Loop
     End With
   If clearRTS = True Then
      ' delete all rows in the website table ISEFVotes
     Set RSTISEFVotes = dbweb.OpenRecordset("Select * from ISEFVotes")   ' Get all fields
     If Not RSTISEFVotes.EOF Then
        RSTISEFVotes.MoveFirst
        Do While Not RSTISEFVotes.EOF
           RSTISEFVotes.Delete
           RSTISEFVotes.MoveNext
        Loop
     End If
   End If
   
   'End If  ' end of if update NatCategories = yes
   If clearRTS = True Then
      MsgBox "Categories have been cleared and set ready for scoring!"
   Else
    If DoCatUpdateNoMsg = False Then
      MsgBox "Categories.xml file and NatCategories table updated!"
    End If
   End If
   If Not IsNull(Me.OpenArgs) Then  ' Rev 5.3.3
      DoCmd.Close acForm, Me.Form.Name ' rev 5.3.3 close the form
   End If
   Exit Sub
ErrorHandler:
   btnCats.Enabled = True
   btnClose.Enabled = True
   MsgBox "Canceled"
   Close #311
Exit Sub
SubError:
   btnCats.Enabled = True
   btnClose.Enabled = True
  Close #311
MsgBox "Categories Update Error: " & Err.Description
End Sub




Private Sub btnJudgeUD_Click()
' REV 5.2.0  Feb 2009   Added uploads of all judge data so that it is available on the
'    Web site for returning judges.

 On Error GoTo SubError
 Dim rsLJudges As Recordset
 Dim RSTFairInfo As Recordset
 Dim rsWebJudges As Recordset
 Dim MyWebdbPath As String
 Dim db As DAO.Database
 Dim dbweb As DAO.Database
 Dim SQLstr As String
 Dim Cnt As Integer
 Dim Ttl As Integer
 Dim LN1 As String
 Dim LN2 As String
 Dim FN1 As String
 Dim FN2 As String
 Dim EM1 As String  ' email
 Dim EM2 As String
 Rev.SetFocus
 btnJudgeUD.Enabled = False
 Set db = CurrentDb
 Set RSTFairInfo = db.OpenRecordset("SELECT * FROM FairInfo WHERE Fair_Year = " & FairYear())
 MyWebdbPath = RSTFairInfo!WebdbPath
 RSTFairInfo.Close
 Set dbweb = DBEngine.OpenDatabase(MyWebdbPath)
 Set rsWebJudges = dbweb.OpenRecordset("Select * from Judges")  ' Get all fields
 'Set rsLJudges = db.OpenRecordset("SELECT Persons.FNAME, Persons.MI, Persons.LNAME, Judges.JUN, " & _
 '         "Persons.SALUTATION FROM Persons RIGHT JOIN Judges ON Persons.PID = Judges.PID")
 Set rsLJudges = db.OpenRecordset("SELECT * , Judges.LAST_CHG as LastChange FROM Persons RIGHT JOIN Judges ON Persons.PID = Judges.PID" & _
                 " ORDER BY [LNAME], [FNAME]")  ' Added sort rev 5.3.3
 Cnt = 0
 rsLJudges.MoveLast
 rsLJudges.MoveFirst
 Ttl = rsLJudges.RecordCount
 btnClose.Enabled = False
'  *****************   Empty the current Judges Table in the web site  ****************
'
With rsWebJudges
  If Not .EOF Then
    .MoveFirst
    Do While Not .EOF
     .Delete
     .MoveNext
    Loop
  End If
  '  ************   Upload current Judges data to the web site.   ************************
  Do While Not rsLJudges.EOF
     .AddNew
        !JUN = rsLJudges!JUN
        !LNAME = rsLJudges!LNAME
        !FNAME = rsLJudges!FNAME
        !MI = rsLJudges!MI
        !SALUTATION = rsLJudges!SALUTATION
        ' canJudge = Y N null blank    YES/NO in web
        ' DES rev 5.3.2  note if status = 'I' Inactive this year or 'N' (no show) then is also set as false
        !CanJudge = IIf(IsNull(rsLJudges!STATUS), False, (IIf(rsLJudges!STATUS = "A", True, False)))
        !ADDRESS = rsLJudges!ADDR1
        !ADDR2 = rsLJudges!ADDR2
        !CITY = rsLJudges!CITY
        !STATE = rsLJudges!STATE
        !ZIP = rsLJudges!ZIP
        '  phone numbers are not converted to the aaa-nnn-nnnn format they remain  (aaa) nnn-nnnn
        '   Conversion will be done at the web site.
        !HomePhone = rsLJudges!HOME_PHONE
        !WorkPhone = rsLJudges!WORK_PHONE
        !Ext = rsLJudges!EXTENSION
        !CellPhone = rsLJudges!CELL_PHONE
        !EMAIL = rsLJudges!EMAIL
        !Employer = rsLJudges!ORG_NAME
        ' mailpref  M or E or P or Null
        !MAILPREF = IIf(IsNull(rsLJudges!MAILPREF), Null, rsLJudges!MAILPREF)
        !DEGREE = rsLJudges!DEGREE
        !MAJOR = rsLJudges!MAJOR
        !MINOR = rsLJudges!MINOR
        !Experience = rsLJudges!EXPER
        ' Teamok Y  N or null  YES/No in web
        !TeamOK = IIf(IsNull(rsLJudges!TEAM_OK), False, IIf(rsLJudges!TEAM_OK = "Y", True, False))
         ' local fair null, blank, H W Y
        !localfair = IIf(IsNull(rsLJudges!LOCAL_FAIR), Null, rsLJudges!LOCAL_FAIR)
        !FirstCat = rsLJudges!P_1
        !SecondCat = rsLJudges!P_2
        !ThirdCat = rsLJudges!P_3
        !FourthCat = rsLJudges!P_4
        !JCAT = rsLJudges!JCAT
        !lastchange = rsLJudges!lastchange
        !DateSync = Now
     .Update
      '   Check to see if we have duplicate names.  rslJudges should be sorted by LNAME, FNAME, .. for this to work
      EM1 = EM2   ' Email.  These are searched for when a judge creates an account on the web.
      LN1 = LN2
      FN1 = FN2
      LN2 = rsLJudges!LNAME
      FN2 = rsLJudges!FNAME
      EM2 = IIf(IsNull(rsLJudges!EMAIL), "", rsLJudges!EMAIL)
      If LN1 = LN2 And FN1 = FN2 Then
        If EM1 = EM2 Then   ' Rev 5.3.3 If different emails then we assume is a different person.
          MsgBox "Possible Duplicate Judge " & FN2 & " " & LN2 & vbCrLf & _
               "Please resolve after the update is complete then " & vbcrlr & _
               "Re-run this update."
        End If
      End If
      rsLJudges.MoveNext
      Cnt = Cnt + 1
      LblPERCENT.Caption = Cnt & " of " & Ttl
  Loop
 End With
 btnClose.Enabled = True
 rsLJudges.Close
 rsWebJudges.Close
 db.Close
 dbweb.Close
 
 LblPERCENT.Caption = ""
 btnJudgeUD.Enabled = True
 'rev 5.3.7   go update the categories in case there were any changes
 DoCatUpdateNoMsg = True
 btnCats_Click
 DoCatUpdateNoMsg = False
 MsgBox "Success!"
 Exit Sub
SubError:
   btnJudgeUD.Enabled = True
   btnClose.Enabled = True
   MsgBox "Error in Web Judges table Update: " & Err.Description
   rsWebJudges.Close  ' added rev 5.2.4  database is being left open probably not here.
   dbweb.Close        ' added rev 5.2.4
   
End Sub

Private Sub btnSchTeach_Click()
 On Error GoTo SubError
 Dim rsLSch As Recordset
 Dim rsWebSch As Recordset
 Dim RSTFairInfo As Recordset
 Dim rsLTh As Recordset
 Dim rsWebTh As Recordset
 Dim MyWebdbPath As String
 Dim db As DAO.Database
 Dim dbweb As DAO.Database
 Dim SQLstr As String
 Dim Cnt As Integer
 Dim Ttl As Integer
 Rev.SetFocus
 btnSchTeach.Enabled = False
 Set db = CurrentDb
 Set RSTFairInfo = db.OpenRecordset("SELECT * FROM FairInfo WHERE Fair_Year = " & FairYear())
 MyWebdbPath = RSTFairInfo!WebdbPath
 RSTFairInfo.Close
 Set dbweb = DBEngine.OpenDatabase(MyWebdbPath)
Set rsWebSch = dbweb.OpenRecordset("Select * from Schools")
Set rsWebTh = dbweb.OpenRecordset("Select * from Teachers")
Set rsLSch = db.OpenRecordset("Select * from Schools ORDER by School")
Set rsLTh = db.OpenRecordset("SELECT Persons.FNAME, Persons.LNAME, Persons.MI, Persons.SALUTATION, " & _
              "Teachers.SCH_CODE, Teachers.TID FROM Persons RIGHT JOIN Teachers ON Persons.PID = " & _
              "Teachers.PID  ORDER BY Persons.LNAME, Persons.FNAME")
Cnt = 0
rsLSch.MoveLast
rsLTh.MoveLast
Ttl = rsLSch.RecordCount + rsLTh.RecordCount
rsLSch.MoveFirst
rsLTh.MoveFirst
btnClose.Enabled = False
With rsWebSch
  If Not .EOF Then
    .MoveFirst
    Do While Not .EOF
     .Delete
     .MoveNext
    Loop
  End If
  Do While Not rsLSch.EOF
     .AddNew
        !SCH_CODE = rsLSch!SCH_CODE
        !SCHOOL = rsLSch!SCHOOL
     .Update
      rsLSch.MoveNext
   Cnt = Cnt + 1
   LblPERCENT.Caption = Cnt & " of " & Ttl
   Loop
End With
With rsWebTh
  If Not .EOF Then
   .MoveFirst
   Do While Not .EOF
      .Delete
      .MoveNext
   Loop
  End If
  Do While Not rsLTh.EOF
     .AddNew
        !LNAME = rsLTh!LNAME
        !FNAME = rsLTh!FNAME
        !MI = rsLTh!MI
        !SALUTATION = rsLTh!SALUTATION
        !TID = rsLTh!TID
        !SCH_CODE = rsLTh!SCH_CODE
     .Update
      rsLTh.MoveNext
     Cnt = Cnt + 1
     LblPERCENT.Caption = Cnt & " of " & Ttl
   Loop
End With
 btnClose.Enabled = True
 rsLSch.Close
 rsLTh.Close
 rsWebSch.Close
 rsWebTh.Close
 db.Close
 dbweb.Close
 MsgBox "Success!"
 LblPERCENT.Caption = ""
 btnSchTeach.Enabled = True
 Exit Sub
SubError:
   btnSchTeach.Enabled = True
   btnClose.Enabled = True
   MsgBox "Error in Schools/Teachers Update: " & Err.Description
End Sub



Private Sub CmdExh_Click()
 On Error GoTo ErrorLeave
'Here, we need to use the number from the table FairInfor, field NEXT_ADD_Exhibit
' add some logic to make sure it is there and the FIRST_ADD_EXHIBIT is actually 100001 etc.
' Remember that Renumber Exhibits resets these numbers  so.   imports need to be synched
'  with renumber exhibits   or perhaps move the import to the renumber form ... soe
'   we import, then renumber , then reset the numbers.    That will all work :)
'
'
Rev.SetFocus
btnClose.Enabled = False
ErCnt = 0                  ' Keep track of how many errors
ExSkipped = 0     ' Already imported = Exported flag set in Web data
ExImported = 0    ' processed - may have had errors?? not sure
ExWithBad = 0     ' do not pass checkExhibit test
ExBadImported = 0  ' in ExbitStudets and other places - some may be bad and imported. probably never

'
LblPERCENT.Visible = False
BX.Visible = False
a.Visible = False
b.Visible = False
c.Visible = False
d.Visible = False
e.Visible = False
f.Visible = False
g.Visible = False
h.Visible = False
i.Visible = False
j.Visible = False
k.Visible = False
L.Visible = False
m.Visible = False
n.Visible = False
o.Visible = False
p.Visible = False
q.Visible = False
r.Visible = False
s.Visible = False
t.Visible = False

Set db = CurrentDb
' This Table is located in SciFairData.
Set rsErr = db.OpenRecordset("Select * from WebErrorLog")
'rsErr.MoveLast
'rsErr.MoveFirst
If rsErr.RecordCount > 0 Then
  If MsgBox("Previous WebErrorLog will be cleared!" & vbCrLf & _
    "Are you finished with the Error lists in the 'WebErrorLog' Table?", vbYesNo, "Clearing WebErrorLog") = vbNo Then
   MsgBox "Return when you are finished with WebErrorLog information!"
   btnClose.Enabled = True
   Exit Sub
  End If
 End If
 CmdExh.Enabled = False
 rsErr.Close
 SQlStrJ = "DELETE * FROM WebErrorLog"
 db.Execute (SQlStrJ)
 'Set rs = db.OpenRecordset("SELECT * FROM TblWebDbPath WHERE WebDbPath Is Not Null")
 Set RSTFairInfo = db.OpenRecordset("SELECT * FROM FairInfo WHERE Fair_Year = " & FairYear())
 MyWebdbPath = RSTFairInfo!WebdbPath
 'MyWebdbPath = rs!WebdbPath & "/"
 'MyWebDbname = rs!WebDbName
 'rs.Close
 Set Dbs = DBEngine.OpenDatabase(MyWebdbPath)
 Set RSTPerson = db.OpenRecordset("SELECT * FROM persons")
 Set RSTSch = db.OpenRecordset("Select * from Schools")
 Set RSTTeachers = db.OpenRecordset("SELECT Teachers.TID, Teachers.Type, Persons.TP, Persons.FNAME, Persons.MI, Persons.LNAME, Persons.PID " & _
      "FROM Persons RIGHT JOIN Teachers ON Persons.PID = Teachers.PID;")  ' I will use this to check TID's
 Set RSTStu = db.OpenRecordset("SELECT * FROM Students")
 Set RSTExbit = db.OpenRecordset("SELECT * FROM ExhibitData")
 Set RSTExbitStu = db.OpenRecordset("SELECT * FROM ExhibitStudents")
 Set RSTExhibitData = Dbs.OpenRecordset("Select * from EntryFormData ORDER BY Datesubmitted ")
 Set RSTJudgeTypes = db.OpenRecordset("SELECT * FROM JudgeTypes")  ' I will use this to check Category with JCAT
 Set RSTJudgeTypeCategories = db.OpenRecordset("SELECT * FROM JudgeTypeCategories")
 ' this record set can be used to UPDATE students,persons, schools and teacher IF the existing student and person are a match.
 ' We keep students joined with persons and teachers and schools in the data base for several years.
 Set rsStuPer = db.OpenRecordset("SELECT Persons.LNAME, Persons.FNAME, Persons.MI, Persons.SALUTATION, Students.STID, Students.GRADE, Students.SSN, Students.SEX, Students.PID, Students.S_SCH AS SCH_CODE, Students.S_TID AS TID, Students.Temp, Schools.SCHOOL, Persons.PID AS P_PID, Persons.TP, Persons.HOME_PHONE, Persons.CID, Persons.WORK_PHONE, Persons.EXTENSION, Persons.ADDR1, Persons.ADDR2, Persons.CITY, Persons.STATE, Persons.ZIP, Persons.LAST_CHG, Persons.EMAIL, Persons.CELL_PHONE, Persons.FAX_PHONE, Persons.MAILPREF, Persons.SPECIAL, Persons.COMMENTS AS P_Comments, Persons.Temp AS P_Temp, Students.LAST_FAIR " & _
    "FROM ((Students LEFT JOIN Teachers ON Students.S_TID = Teachers.TID) LEFT JOIN Persons ON Students.PID = Persons.PID) LEFT JOIN Schools ON Students.S_SCH = Schools.SCH_CODE " & _
    "ORDER BY Persons.LNAME, Persons.FNAME, Persons.MI, Persons.SALUTATION;")
' Set rsStuPerDblCk = db.OpenRecordset("SELECT Persons.LNAME, Persons.FNAME, Persons.MI, Persons.SALUTATION, Students.STID, Students.GRADE, Students.SSN, Students.SEX, Students.PID, Students.S_SCH AS SCH_CODE, Students.S_TID AS TID, Students.Temp, Schools.SCHOOL, Persons.PID AS P_PID, Persons.TP, Persons.HOME_PHONE, Persons.CID, Persons.WORK_PHONE, Persons.EXTENSION, Persons.ADDR1, Persons.ADDR2, Persons.CITY, Persons.STATE, Persons.ZIP, Persons.LAST_CHG, Persons.EMAIL, Persons.CELL_PHONE, Persons.FAX_PHONE, Persons.MAILPREF, Persons.SPECIAL, Persons.COMMENTS AS P_Comments, Persons.Temp AS P_Temp, Students.LAST_FAIR " & _
'    "FROM ((Students LEFT JOIN Teachers ON Students.S_TID = Teachers.TID) LEFT JOIN Persons ON Students.PID = Persons.PID) LEFT JOIN Schools ON Students.S_SCH = Schools.SCH_CODE " & _
'    "ORDER BY Persons.LNAME, Persons.FNAME, Persons.MI, Persons.SALUTATION;")
'  rsStuPerDblCk used to see if match of Fname, Lname has at least one addition matching field - so definitly is a duplicate.

'IMPORTANT NOTE: Exhibit Numbers are reserved and used as follows
'
'NUMBERED EXHIBITS, READY FOR FAIR 000101 to FairInfo.FIRST_ADD_EXHIBIT -1
'  Typically 101 to 099,999
'  First exhibit 101 is a NWNMSEF tradition. It reserves 100 exhibit numbers
' for special needs (the way of handling Special winners is to use exhibit numbers 001 to 100 )
'  Exhibit 98 and 99 have (had) special meaning in special awards prizes: 99 = Not awarded etc
'
'EXHIBITS ADDED with Exhibits Edit,Add,Delete and/or  WebImport form are:
' FairInfo.FIRST_ADD_EXHIBIT to FairInfo.FIRST_ADD_EXHIBIT + 99999 (typical 100000 to 199999)
' Use NEXT_ADD_EXHIBIT to keep track of next unused Exhibit number.
' TEMPORARY NUMBERS USED DURING RENUMBERING: FairInfo.FIRST_ADD_EXHIBIT +100000
' and larger  (Typical 200000 and larger)
' TO CHANGE THIS, CHANGE table FairInfo FIRST_ADD_EXHIBIT

 With RSTFairInfo
    .FindFirst "FAIR_YEAR = " & FairYear()
    If .NoMatch Then
         MsgBox "Table FairInfo must have an entry for year " & FairYear() _
         & vbCrLf & "You must fix FairInfo", , "Missing FairInfo Record"
         Exit Sub
    Else
       If IsNull(!FIRST_ADD_EXHIBIT) Then
          MsgBox "Table FairInfo must have a number (eg 100001) in" & vbCrLf & _
          "the FIRST_ADD_EXHIBIT field. You must fix FairInfo", , "Missing FairInfo Data"
          Exit Sub
       End If
       If IsNull(!NEXT_ADD_EXHIBIT) Then
          .Edit
          !NEXT_ADD_EXHIBIT = !FIRST_ADD_EXHIBIT
          .Update
       End If
       If !NEXT_ADD_EXHIBIT < !FIRST_ADD_EXHIBIT Or _
          !NEXT_ADD_EXHIBIT > !FIRST_ADD_EXHIBIT + 99999 Then
          .Edit
          !NEXT_ADD_EXHIBIT = !FIRST_ADD_EXHIBIT
          .Update
       End If
    End If
  End With
  MyEXN = RSTFairInfo!NEXT_ADD_EXHIBIT
      'DES 4.0.4  This routine and the manual Exhibit Edit Add Delete both use
      'Fair Infor Next_Add_Exhibit, incrementing each new exhibit.
      'Exhibit Sort &ReNumber resets to 100001 after the new exhibit are renumbered
      'Fair Maintenence sets the First and next add to 100001.
      'First_Add_Exhibit never changes it is a FairConstant.
 LblPERCENT.Caption = ""
 LblPERCENT.ForeColor = 0
' mykount = 0
 mykt = 1
 ErrorNumber = 1
 NumExhUpdated = 0    ' Keep track of how many exhibits have been re-entered (updated - more than one record in webdata.)
 Dim mypcent As Integer
 Dim a1 As Integer
 Dim tf As Boolean      '  true or false
 Dim a2 As Integer
   RSTExhibitData.MoveLast
   a1 = RSTExhibitData.RecordCount
   RSTExhibitData.MoveFirst
  LblPERCENT.Visible = True
  ' rev 540   count tshirt sizes
 TShirtTotal = 0   'rev 540   dimensioned global
 '-----------

' ------------------------ loop thru exhibitdata ---------------
Do Until RSTExhibitData.EOF
 ' rev 540
 If Not IsNull(RSTExhibitData!TShirtSize) Then     ' see if tshirt entered
   CountTShirts (RSTExhibitData!TShirtSize)
 End If
 If Not IsNull(RSTExhibitData!T2TShirtSize) Then
   CountTShirts (RSTExhibitData!T2TShirtSize)
 End If
 If Not IsNull(RSTExhibitData!T3TShirtSize) Then
   CountTShirts (RSTExhibitData!T3TShirtSize)
 End If
 
 '
 IsTeam = IIf(RSTExhibitData!ProjectType = "Team", True, False)
 teamID = 1
 UpdateEXN = 0   ' Rev 5.2.1    attempt to fix the issue when a new entry is made for teams that are already entered
 If RSTExhibitData!Exported = 0 Then
  RSTExbitStu.Requery  ' Rev 5.2.3  these need to be requeried so we pick up the things added last loop
  RSTStu.Requery
  RSTExbit.Requery
  rsStuPer.Requery
  If CheckExhibit() = True Then
     '**Create/Update Persons and or Students Records
    
     If ProcessStuPer() = False Then
         GoTo SkipBadRecord
     End If
     Call ExbitStudent(teamID)    '**** Create/Update record in ExhibitStudent Table DES 4.0.4 Need to do this for each student if team exhibit
     Call ExhibitRecord         ' **** Create/Update Exhibit Record
     '  At this point we have an exhibit record. BUT... Not sure if Exhibit Number is correct if we UPDATED an Exhibit
     If IsTeam = True Then
        teamID = 2
         If Len(RSTExhibitData!TM2lastname) > 0 Or Len(RSTExhibitData!TM2Firstname) > 0 Then
           TeamDupStud = False
           If ProcessStuPer() = False Then  '  error or duplicate student person
              If TeamDupStud = False Then   ' no message for duplicates msg done already
                MsgBox "Possible Team Member 2 Error:" & RSTExhibitData!TM2lastname & vbCrLf & _
                " The Team Member #1 student's lastname is " & RSTExhibitData!exlastname & vbCrLf & _
                " You should MANUALLY Verify the 'ExhibitStudents', 'Students' and 'Persons' tables to match web data!" & vbCrLf & _
                " This message logged in WebErrorLog Table!"
                erst = "Team #2 Other Error! #1 LName = " & RSTExhibitData!exlastname & _
                       " Review All Data!"
                Call DoLog
              End If
              ExBadImported = ExBadImported + 1
              Call ProcessPersons    ' I must always process the team members even if duplicates
              Call ProcessStudents
           End If
           'Call ProcessPersons  ' DES 4.0.4 Need to do this for each student if team exhibit
           'Call ProcessStudents ' DES 4.0.4 Need to do this for each student if team exhibit
           Call ExbitStudent(teamID)    ' DES 4.0.4 Need to do this for each student if team exhibit
           RSTExbitStu.Update   'error here if bad team stuff - actually gets created in ExbitStuden(teamID)
           ' Note we do not call ExhibitRecord
         End If
        teamID = 3
         If Len(RSTExhibitData!TM3lastname) > 0 Or Len(RSTExhibitData!TM3Firstname) > 0 Then
           TeamDupStud = False
           If ProcessStuPer() = False Then
              If TeamDupStud = False Then  ' Do not do this message id duplicate team student msg done already
                MsgBox "Possible Team Member 3 Error:" & RSTExhibitData!TM2lastname & vbCrLf & _
                 " The Team Member #1 student's lastname is " & RSTExhibitData!exlastname & vbCrLf & _
                 " You should MANUALLY Verify the 'ExhibitStudents', 'Students' and 'Persons' tables to match web data!" & vbCrLf & _
                 " This message logged in WebErrorLog Table!"
                 erst = "Team #3 Other Error! #1 LName = " & RSTExhibitData!exlastname & _
                       " Review All Data!"
                 Call DoLog
               End If
               ExBadImported = ExBadImported + 1
               Call ProcessPersons
               Call ProcessStudents
           End If
           'Call ProcessPersons  ' DES 4.0.4 Need to do this for each student if team exhibit
           'Call ProcessStudents ' DES 4.0.4 Need to do this for each student if team exhibit
           Call ExbitStudent(teamID)    ' DES 4.0.4 Need to do this for each student if team exhibit
           RSTExbitStu.Update
           '  Note we do not call ExhibitRecord
         End If
     End If ' end if team exhibit
     teamID = 1           ' probably not necessary trying to debug leave it anyway.
     Call ProcessSchool
     RSTExhibitData.Edit
     RSTExhibitData!Exported = -1   '   set this to exported so we do not do it again
     RSTExhibitData.Update
     ExImported = ExImported + 1
     '  Replace the below with FairInfoTable NEXT_ADD_EXHIBIT
     MyEXN = MyEXN + 1    ' Note that Updates also result in increment so there will be some
             ' Missing exhibit numbers.
  Else     '  checkexhibit failed
SkipBadRecord:   ' Or user decided to not import a duplicate student or error in ProcessStuPer code
     ExWithBad = ExWithBad + 1
  End If   '   checkExhibit was true or false
 Else     '   If Exported was checked
   ExSkipped = ExSkipped + 1
 End If    '   if Exported checked or not checked
   RSTExhibitData.MoveNext
   DoEvents
   LblPERCENT.Caption = mykt & " of " & RSTExhibitData.RecordCount
   mykt = mykt + 1
Loop
' ---------------------------loop ---------------------
'Dim ErCnt As Integer     ' How many error in the error log
'Dim ExSkipped As Integer  ' Have Exported flag set to yes - already imported
'Dim ExImported As Integer  '  New Exhibits processed this import
'Dim ExWithBad As Integer    ' Exhibits that fail CheckExhibits

RSTFairInfo.Edit
RSTFairInfo!NEXT_ADD_EXHIBIT = MyEXN
RSTFairInfo.Update
If ErCnt > 0 Then
   MsgBox "There were ERRORS or WARNINGS!  " & vbCrLf & _
          " ** Review next message carefully!" & vbCrLf & _
          " ** Review the 'WebErrorLog' Table and make appropriate changes if necessary!"
End If
' rev 540
If MsgBox(RSTExhibitData.RecordCount & " Records in Web ExhibitData" & vbCrLf & _
       ExSkipped & " Records Skipped (Already Imported)" & vbCrLf & _
       NumExhUpdated & " Exhibits Updated (multiple web records or re-imported)." & vbCrLf & _
       ExImported - NumExhUpdated & " New Exhibits Imported. " & vbCrLf & vbCrLf & _
        IIf(ErCnt = 0 And ExWithBad = 0, "Wow, No Errors!  ", "") & _
        IIf(ErCnt > 0 Or ExWithBad > 0, " ERRORS/WARNINGS IN UPDATE!", "Update complete!") & vbCrLf & _
          IIf(ErCnt > 0 Or ExWithBad > 0, ExWithBad & " Records with Problems were NOT Imported - Resolve problems " & vbCrLf & _
          ExBadImported & " Exhibits with Errors/Warnings WERE Imported - Clean up the Imported Exhibit data" & vbCrLf & _
          ErCnt & " Total Errors/Warnings Found! (some records may have multiple errors.)" & vbCrLf & _
          "     " & vbCrLf & _
          "Table 'WebErrorLog' LISTS ALL ERRORS!" & vbCrLf, "") & vbCrLf & _
          "You may SortAndRenumber Exhibits at any time :)" & vbCrLf & vbCrLf & _
          "Do you want to view T-Shirt totals?", vbYesNo + vbDefaultButton2, "Import Process Completed") = vbYes Then
  ' rev 540  show tshirtcounttotals
        Dim ttts As Integer
        Dim tmsg As String
        Dim tsidx As Integer
        For tsidx = 0 To UBound(TShirtSize) - 1  ' last one not used
          
          tmsg = tmsg & TShirtSize(tsidx) & ":   " & TShirtSzCnt(tsidx) & vbCrLf
          ttts = ttts + TShirtSzCnt(tsidx)
        Next tsidx
        MsgBox tmsg & vbCrLf & "Total Count = " & ttts
End If
BX.Visible = False
a.Visible = False
b.Visible = False
c.Visible = False
d.Visible = False
e.Visible = False
f.Visible = False
g.Visible = False
h.Visible = False
i.Visible = False
j.Visible = False
k.Visible = False
L.Visible = False
m.Visible = False
n.Visible = False
o.Visible = False
p.Visible = False
q.Visible = False
r.Visible = False
s.Visible = False
t.Visible = False
LblPERCENT.Caption = " "
RSTPerson.Close
RSTSch.Close
RSTStu.Close
RSTExbit.Close
RSTExbitStu.Close
RSTExhibitData.Close
RSTTeachers.Close
RSTJudgeTypes.Close
RSTJudgeTypeCategories.Close
RSTFairInfo.Close
Set db = Nothing
Set Dbs = Nothing
btnClose.Enabled = True
CmdExh.Enabled = True
Exit Sub
ErrorLeave:
CmdExh.Enabled = True
If Err = 3044 Then
   MsgBox Err.Description & vbCrLf & _
   "CHANGE the path in the FAIRINFO TABLE field 'WebdbPath'. Use the record for FAIR YEAR " & FairYear()
End If
If Err.Number = 3021 Then
   MsgBox "No Exhibit Records to Import!"

Else
  MsgBox "Import Exhibits (CmdExh): " & Err.Description, vbCritical, Err.Number
End If
btnClose.Enabled = True
'   if error and bailing out, at least avoid many many duplicate Exhibit number errors
MyEXN = MyEXN + 10   '  skip 10 for next try
RSTFairInfo.Edit
RSTFairInfo!NEXT_ADD_EXHIBIT = MyEXN
RSTFairInfo.Update
'  should close all recordsets etc here
'Resume
'End If
End Sub
Private Function GetNextAvailJUN() As Integer
  ' Given the last USED JUN, search the Judges table and find the next that does not exist
  ' WOPS  Big bug I think   5.0.1 fix attemtp
  '  In using this I useed the current NxtAvailJUN for a new judge JUN in RSTJudges record set, which adds to Judges table.
  '   However, the RSALLLocalJudges record set is still the origional open so does not have the one I just added.
  '   Now the old code (without requery) should have worked because I do not search for the current NxtAvailJUN again.
  RSAllLocalJudges.Requery   ' rev 5.0.1 make sure I have the current data
  'rev 5.5.4a  DES  554a
  If RSAllLocalJudges.EOF Then
    GetNextAvailJUN = 101
    Exit Function
  End If
  RSAllLocalJudges.MoveFirst
  'NxtAvailJUN is the last unused JUN that was used.  So we need to find the next one
  Dim i As Integer
SearchForNext:
  NxtAvailJUN = NxtAvailJUN + 1   ' just used current one so do not look for that again
  For i = NxtAvailJUN To 8999 ' JuN  > 9999 not allowed
    RSAllLocalJudges.MoveFirst   ' Can I eliminate this If I sort this recordset by JUN.
    RSAllLocalJudges.FindFirst ("JUN = " & NxtAvailJUN) 'Can I Use FIND NEXT HERE if i sort the recordset??
    If RSAllLocalJudges.NoMatch = True Then
      'did not find it so it is the next available
      ' I need to also make sure it is NOT in the Web data Judges Table until I no longer use that table"
      WebJudgeList.Requery
      WebJudgeList.FindFirst "JUN = " & NxtAvailJUN
       If WebJudgeList.NoMatch Then
         GetNextAvailJUN = NxtAvailJUN
         Exit Function
       Else
          ' this is a possible problem so... what to do.   Warn the operator and keep going
          MsgBox "JUN " & NxtAvailJUN & " exists in SciFairWebData.Judges table (used for dropdown box list)" & vbCrLf & _
                   " But is NOT A JUN for your local judge data.  Although not a critical error," & vbCrLf & _
                   " This indicates the web site is not synchronized with the local data." & vbCrLf & _
                   "You should review and clean up local Judges data, then ReLoad SciFairWebData.Judges table."
           GoTo SearchForNext
       End If
    Else
     'found that judge so test the next one and keep going until we DO NOT FIND the JUN
      NxtAvailJUN = NxtAvailJUN + 1
    End If
  Next i
  MsgBox "Error finding next available judge number.  All judge numbers from 101 to 8999 are used!" & vbCrLf & _
         "You must delete some unused judges and startover.  All the remaining judges will be assigned to JUN 9000."
         GetNextAvailJUN = 9000
End Function
Private Sub CmdUpdtJudges_Click()
'  This DOWNLOADS data from the website.
On Error GoTo ErrorExit
btnClose.Enabled = False
Dim MyWebdbPath As String
Dim mykt As Integer
Dim MyWebDbname As String
'Dim WebDB As Workspace
Dim SQLstr As String
Dim SQlStrJ As String  'Sql for Seleting Aviable Judge numbers
Dim MYJun As Integer
Dim My100 As index
Dim Mypbar As Integer
Dim db As DAO.Database

Dim WebDbs As DAO.Database
Dim rs As DAO.Recordset
Dim WebJudgeData As DAO.Recordset
Dim RSTJudges As DAO.Recordset
Dim RSTPerson As DAO.Recordset
Dim SQLAllJudges As String              ' DES 4.0.4
Dim SetJCAT As Boolean                  'DES 4.0.4
Dim CountNewOrUpdates As Integer        ' DES 4.0.4
Dim CountNew As Integer                 'DES 4.0.4
Dim CountUpdates As Integer              ' DES 4.0.4
Dim CountSkipped As Integer
Dim CountTotal As Integer
Dim CountErrors As Integer
Dim JudgeInWork As Boolean     ' Started edit or add for judge - know this in case of error
Dim PersonInWork As Boolean    ' Started Person edit or add  - know this in case of error
Rev.SetFocus
CmdUpdtJudges.Enabled = False
'Dim RSTGetJudgeNo As DAO.Recordset
BX.Visible = False
a.Visible = False
b.Visible = False
c.Visible = False
d.Visible = False
e.Visible = False
f.Visible = False
g.Visible = False
h.Visible = False
i.Visible = False
j.Visible = False
k.Visible = False
L.Visible = False
m.Visible = False
n.Visible = False
o.Visible = False
p.Visible = False
q.Visible = False
r.Visible = False
s.Visible = False
t.Visible = False
Set db = CurrentDb
'
'get the Available JUN #
' DES 4.0.4 The table JunNbrs column aviNo has the numbers from 1 to 1999.  There is probably a way to do this
' without the table.   Explore this later. ie. open judges, then do for num= 1 to 1999, if jun not in judges,
' update add  aviNo=num in RSTGetJudgNo


'SQlStrJ = "SELECT JunNbrs.aviNo FROM JunNbrs LEFT JOIN Judges ON JunNbrs.aviNo = Judges.JUN WHERE (((JunNbrs.aviNo)>101) AND ((Judges.JUN) Is Null));"
'Set RSTGetJudgeNo = db.OpenRecordset(SQlStrJ)
'RSTGetJudgeNo.MoveLast
'RSTGetJudgeNo.MoveFirst
'
 Set RSTFairInfo = db.OpenRecordset("SELECT * FROM FairInfo WHERE Fair_Year = " & FairYear())
 MyWebdbPath = RSTFairInfo!WebdbPath
RSTFairInfo.Close
'  DES 4.0.4   this to  See if a judge with that same LNAME FNAME exists in local database
'  DES 5.0.1  expanded to have all data for synchronization
'  This was ALSO used to find Next Available JUN  -  rev 5.0.1 AND to update web judges table  5.1.0
' -----  DO NOT CHANGE THE ORDER OF THE SORT ------
SQLAllJudges = "SELECT Judges.JUN, Judges.JCAT, Judges.STATUS, [Judges]![LAST_CHG] AS J_Last_CHG, Judges.DEGREE, " & _
   "Judges.MAJOR, Judges.EXPER, Judges.MINOR, Judges.ORG_NAME, Judges.P_1, Judges.P_2, Judges.P_3, Judges.P_4, " & _
   "Judges.TEAM_OK, Judges.LOCAL_FAIR, Judges.FIRST_YR, Judges.LAST_YR, Judges.NUM_YR, " & _
   "Persons.* FROM Persons RIGHT JOIN Judges ON Persons.PID = Judges.PID ORDER BY Persons.LNAME, Persons.FNAME"
Set RSAllLocalJudges = db.OpenRecordset(SQLAllJudges)
Set WebDbs = DBEngine.OpenDatabase(MyWebdbPath)
'  DES 4.0.4  added sort order so we always process oldest records first
Set WebJudgeData = WebDbs.OpenRecordset("Select * from judgedata ORDER BY Datesubmitted ")  ' in SciFairWebdata
Set WebJudgeList = WebDbs.OpenRecordset("Select * from Judges order by LNAME")  ' DES 4.0.4 Added this one
Set RSTJudges = db.OpenRecordset("Select * from Judges")     'db = this app. ->This is Judges in SciFairData
Set RSTPerson = db.OpenRecordset("SELECT * FROM persons")    ' SciFairData
NxtAvailJUN = 100   ' start with this one in search?
NxtAvailJUN = GetNextAvailJUN()
'rev 5.5.4a  554a  DES
If WebJudgeData.EOF Then  'rev 5.5.4a  554a  DES
   MsgBox "SciFairWebData table judgedata has no records"
   Exit Sub
End If
WebJudgeData.MoveLast
WebJudgeData.MoveFirst
If Not RSTJudges.EOF Then   'rev 5.5.4a  554a  DES
  RSTJudges.MoveLast
  RSTJudges.MoveFirst
End If
If Not RSTPerson.EOF Then    'rev 5.5.4a  554a  DES
  RSTPerson.MoveLast
  RSTPerson.MoveFirst
End If
 LblPERCENT.ForeColor = 0
Mypbar = WebJudgeData.RecordCount / 15
'mykount = 0
'*************************************************************************************************************
    'Status bar code only here
H1 = WebJudgeData.RecordCount / 20
h2 = H1 + H1
H3 = h2 + H1
H4 = H3 + H1
H5 = H4 + H1
H6 = H5 + H1
H7 = H6 + H1
H8 = H7 + H1
H9 = H8 + H1
h10 = H9 + H1
H11 = h10 + H1
H12 = H11 + H1
H13 = H12 + H1
H14 = H13 + H1
H15 = H14 + H1
H16 = H15 + H1
H17 = H16 + H1
H18 = H17 + H1
h19 = H18 + H1
H20 = h19 + H1
Dim mypcent As Integer
Dim a1 As Integer
Dim a2 As Integer
mypcent = 0
LblPERCENT.Caption = mypcent & "%"
   a1 = WebJudgeData.RecordCount / 100
   a2 = WebJudgeData.RecordCount / 100
  BX.Visible = True
  '*******************************************************************
'MsgBox "This process Imports Web Site Judge records added since the last import." & vbCrLf & _
'       " New data from 'returning' judges just UPDATES existing Judge data." & vbCrLf & _
'       " Data from new judges creates a new record except as follows:" & vbCrLf & _
'       "   If a judge currently exists in SciFairData with the same name, you can decide" & vbCrLf & _
'       "     to either UPDATE the existing judge data or ADD a new judge." & vbCrLf & _
'       "   After Data from a NEW judge is added, the Web Site is changed as follows:" & vbCrLf & _
'       "   1.  The Judge data is changed so it represents a returning judge data record." & vbCrLf & _
'       "   2.  The Judges name and new Judge number are ADDED to the 'returning Judges list'." & vbCrLf & _
'       "       That judge can now find his or her name in the list as a 'returning judge'." & vbCrLf & _
'       "       Newer entries will thus be used to UPDATE the judges record on the next import." & vbCrLf & _
'       " After each import, the 'Exported' flag is set 'Yes' for all processed records." & vbCrLf & _
'       "   Those records will not be imported again." & vbCrLf & vbCrLf & _
'       "Get Web Judges Data as often as you wish - You will just get new data each time! "
   SetJCAT = False
   CountNewOrUpdates = 0
   CountNew = 0
   CountUpdates = 0
   CountTotal = 0
   CountSkipped = 0
   CountErrors = 0
  '  MsgBox "NOTE:  On import, Judges Assigned JCAT is set to their first preference!"
   'If MsgBox("Do you want to set JCAT to the judges first preference?", vbDefaultButton2 + vbYesNo, "Set JCat") = vbYes Then
      SetJCAT = True
   'End If
    ' DES 4.0.4  RE The check box 'newjudge' in SciFairWebData.
    ' I think Peter assumes it is checked if there is no match of JUN and ..
    ' Need to see why. Peter's code always adds persons, judges when no match to JUN Number
    ' Need to search to see if persons name is currently in the data base scifairdata.
    ' Peter just forces a new person and thus may create duplicates
    ' This is now implemented!
    '  VERIFY.     If import many times, will not form duplicates.  No Problem.
    '
    '  FIND OUT   Can judges log on and set 'canjudge' to NO .  do we reload daily to check??
    '             This will work if judge knows he/she can do so, even if they do not
    '              use the returning judge logic - has no effect in this code at this time
    '
    '  WHY NOT  when we chage newjudge to false and add the jun number, why not add that judge
    '           to judges List in the data base, then when they return to website, they can update info
    '          ABOVE IMPLEMENTED
    ' Why Not sync web and local on judges each time we run this. that way
    '           there is no need to load the judges table on the web, let this form do it
    '           or, add a button that uploads judges afte we import or... ???
    '           What we really need is to preload the judges data in the web if they are returning because we
    '           can find the last record they entered.  IF  we define returning as they have already entered one
    '           Record!  If we do that they can update info.
    '            TO DO THIS.  Start out with Web Judges table empty, then add each a record is entered.
    '       THE ABOVE IS NOT IMPLEMENTED.
    '

Do Until WebJudgeData.EOF
' ------------LOOP----------------------LOOP-----------------LOOP------------------------------------LOOP ----------------
    ' DES  Find a Judge in Scifairdata (local) that matchs the judgenumber in web. (retjun is a returning judge?)
    ' MsgBox "name: " & WebJudgeData!FNAME & " datetime = " & WebJudgeData!datesubmitted
CountTotal = CountTotal + 1
JudgeInWork = False
PersonInWork = False
If WebJudgeData!Exported = 0 Then   ' DES 4.0.4 Do ALL OF THIS ONLY IF NOT PREVIOUSLY IMPORTED
    'NOTE: There is a judge number 1 in SciFairData, used in the Judge Assignments.  I prefer to not delete
    '       JUN 1.  Thus,  I will set retjun to 2 for all records I lookat that have newjudge set also
    If WebJudgeData!RetJUN = 1 Then
        WebJudgeData.Edit
        WebJudgeData!RetJUN = 2
        WebJudgeData.Update
    End If
    SQLstr = "Select * from Judges where JUN = " & WebJudgeData!RetJUN  ' Search for JUN 2 or JUN = RetJUN
    Set RSTJudges = db.OpenRecordset(SQLstr)     ' THIS IS THE LIST OF JUDGES IN SCIFAIRDATA.mdb This is what Peter DID!
    '
    '  NOTE that the returning judge CHECKBOX in the Web site is not ever considered in this code - we just see
    '       if the retjun in website exists in the local Judges Table!   If it does this is considered an update
    '
    ' ------------------DES 4.0.4   added next check
    If WebJudgeData!NewJudge = -1 And RSTJudges.RecordCount = 1 Then  ' User checked 'newjudge' and found
       'USER CHECKED newjudge (sets retjun = 1 - I changed to 2) and we found JUN in SciFairData = 2  This is not good!
       MsgBox "Error:  You have a judge number (JUN) in SciFairData with a value of '2'" & vbCrLf & _
              "        The import will terminate.  Remove or renumber the Judge where JUN = 2" & vbCrLf & _
              "        then start the import over again!"
       'RSTJudges.Close
       CountErrors = CountErrors + 1
       GoTo SkipRecord
       'GoTo StopLoop
    End If
    ' -----------------
    If RSTJudges.RecordCount = 0 Then    ' The web judge is not in the web JudgeList searching by JUN
                                             '_____________________________________________________________________
                                             'Note retjun is set to 2 at this point if user checked 'newjudge'
                                             'If No match to JUN (in Local data) and retjun, then Add new Judge
                                             'Add also to Person table and the Judges. On the Web side
                                             'Edit the Web Judgedata to uncheck 'newjudge' and update 'retjun'
                                             'and check the Exported Flag.  <-- DES 4.0.4
                                             '____________________________ __________________________________________
        ' DES 4.0.4  Judge thinks they are a new judge or the JUN for retjun has been deleted in the local data.
        ' They did not search Web site Judges list or they are not in the Judge List or that JUN got detleted locally
        ' DOES NOT MATTER, we got here because there is not JUN = retjun = 2 in the local judges data.
        '
        '
        ' We know there is no JUN = 2 now, so what if there is a judge with the same Last Name and First Name?
        RSAllLocalJudges.Requery   '  5.0.1   make sure we have all records even those added.
        If Not RSAllLocalJudges.EOF Then     'rev 5.5.4a  554a  DES
         RSAllLocalJudges.MoveFirst
         RSAllLocalJudges.FindFirst ("LNAME = """ & WebJudgeData!LNAME & """ AND FNAME = """ & WebJudgeData!FNAME & """")
         If RSAllLocalJudges.NoMatch = False Then
           ' found a local judge with same first and last name let user decide what to do
              'JUN,PID,FNAME,LNAME,HOME_PHONE,ADDR1,CITY,STATE,EMAIL,CELL_PHONE
              Dim YNCAns
              YNCAns = MsgBox("Judge number " & RSAllLocalJudges!JUN & " has the same name as this web record " & vbCrLf & _
                          "AND.. the web record is either is marked as 'New Judge' or the returning JUN does not exist locally!" & vbCrLf & _
                          "Web Data: " & IIf(WebJudgeData!RetJUN > 99, "retjun = " & WebJudgeData!RetJUN, "'New Judge'") & _
                          "  Name: " & RSAllLocalJudges!FNAME & " " & RSAllLocalJudges!LNAME & vbCrLf & _
                        " Compare the data, then choose what action you desire!" & vbCrLf & _
                        "                  State,    City,      HomePhone,   CellPhone,    E-mail, Address" & vbCrLf & _
                        "Existing: " & " " & RSAllLocalJudges!STATE & ", " & RSAllLocalJudges!CITY & ", " & RSAllLocalJudges!HOME_PHONE & ", " & _
                            RSAllLocalJudges!CELL_PHONE & ", " & RSAllLocalJudges!EMAIL & ", " & RSAllLocalJudges!ADDR1 & vbCrLf & _
                        "NEW:      " & " " & WebJudgeData!STATE & ", " & WebJudgeData!CITY & ", " & WebJudgeData!HomePhone & ", " & _
                            WebJudgeData!CellPhone & ", " & WebJudgeData!EMAIL & ", " & WebJudgeData!ADDRESS & vbCrLf & vbCrLf & _
                        "DO YOU WANT TO TO UPDATE THE Current record? " & vbCrLf & _
                        " [Yes]= UPDATE Judge.  [No] Create New Judge.  [Cancel] Skip this Record", _
                        vbYesNoCancel + vbDefaultButton1, "Possible Duplicate Judge")
              If YNCAns = vbYes Then
                ' Place actions here if operator indicated this is a duplication
                ' Get the correct local data record for the update
                 SQLstr = "Select * from Judges where JUN=" & RSAllLocalJudges!JUN
                 Set RSTJudges = db.OpenRecordset(SQLstr)
                ' Note,  I Sort the Web data so we process older records first
                   ' Then there is no need to delete the old records - The latest record always updates the data
                   ' Also, I set the Exported flag so I never even look at the record again.
                ' go to update section and update the current record
                GoTo DoEditOnly
              Else
                If YNCAns = vbCancel Then
                   ' I can skip since no action has taken place yet
                   CountErrors = CountErrors + 1
                   GoTo SkipRecord
                End If
              End If
              'yncans = NO flow on to addnew person
         End If  ' DES 4.0.4   if we get here then there is not duplication so go ahead and add the judge
        End If   'rev 5.5.4a  554a  DES
' ---------ADD------------------------ADD---------------ADD---------------ADD-------------------ADD------------------------
        RSTPerson.AddNew
        PersonInWork = True
        RSTPerson!LNAME = WebJudgeData!LNAME
        RSTPerson!FNAME = WebJudgeData!FNAME
        RSTPerson!MI = IIf(Len(WebJudgeData!MidInit) = 0, Null, Left(WebJudgeData!MidInit, 2))
        RSTPerson!ZIP = WebJudgeData!ZIP
        If IsNull(WebJudgeData!WorkPhone) Then
           RSTPerson!WORK_PHONE = Null
        Else
            RSTPerson!WORK_PHONE = IIf(Len(WebJudgeData!WorkPhone) = 0, Null, ConvertPh(WebJudgeData!WorkPhone))  'DES
        End If
      
       'RSTPerson!WORK_PHONE = IIf(Len(WebJudgeData!workphone) = 0, Null, ConvertPh(WebJudgeData!workphone))  'DES
        RSTPerson!EXTENSION = IIf(Len(WebJudgeData!Ext) = 0, Null, WebJudgeData!Ext)  'DES
        RSTPerson!ADDR1 = IIf(Len(WebJudgeData!ADDRESS) = 0, Null, Left(WebJudgeData!ADDRESS, 30))
        RSTPerson!ADDR2 = IIf(Len(WebJudgeData!ADDR2) = 0, Null, Left(WebJudgeData!ADDR2, 30))  ' 5.0.1
        RSTPerson!CITY = WebJudgeData!CITY
        RSTPerson!STATE = WebJudgeData!STATE
        If IsNull(WebJudgeData!HomePhone) Then
           RSTPerson!HOME_PHONE = Null
        Else
            RSTPerson!HOME_PHONE = IIf(Len(WebJudgeData!HomePhone) = 0, Null, ConvertPh(WebJudgeData!HomePhone))  'DES
        End If
        If IsNull(WebJudgeData!CellPhone) Then
           RSTPerson!CELL_PHONE = Null
        Else
           RSTPerson!CELL_PHONE = IIf(Len(WebJudgeData!CellPhone) = 0, Null, ConvertPh(WebJudgeData!CellPhone))  'DES
        End If
        RSTPerson!EMAIL = IIf(Len(WebJudgeData!EMAIL) = 0, " ", WebJudgeData!EMAIL)
       ' DES 4.0.4 Next replaced.  WebJudgeData is always "", "P" or "E" where P = Phone, "" = Postal (M)
       ' RSTPerson!MAILPREF = IIf(Len(WebJudgeData!MAILPREF) = 0, Null, WebJudgeData!MAILPREF)
        RSTPerson!MAILPREF = IIf((Len(WebJudgeData!MAILPREF) = 0) Or (IsNull(WebJudgeData!MAILPREF)), "M", WebJudgeData!MAILPREF)
        'Select Case WebJudgeData!MAILPREF 'M=Postal Mail, E= e-mail, Blank = Postal Mail
        '     Case "E"
        '     Case "M"    ' DES 4.0.4  These were not filled in and not needed
        '     Case ""
        '     Case Else    ' Other values.
        '         RSTPerson!MAILPREF = nulls
        'End Select
        RSTPerson!LAST_CHG = Date
        RSTPerson!Temp = "GETPID"
        ' DES 4.0.4 added "RJ" to TP field  (Type person).
        TPValue = IIf(IsNull(RSTPerson!TP), "", RSTPerson!TP)
        Call setFieldTP(TPValue, "RJ")   ' adds RJ to TO ( at end if already has one or more TP)
        RSTPerson!TP = TPValue
        RSTPerson.Update
        PersonInWork = False
        Set RSTPerson = db.OpenRecordset("SELECT * FROM persons Where TEMP='" & "GETPID'")
        RSTPerson.Edit
        RSTPerson!Temp = Null
        RSTPerson.Update
        '_____________________________________________________________________________________
        'add information to Judge table
        RSTJudges.AddNew
        JudgeInWork = True
        RSTJudges!PID = RSTPerson!PID
        RSTJudges!JUN = NxtAvailJUN           '  found in function
        'RSTJudges!JUN = RSTGetJudgeNo!avino 'Assign new Jun
        RSTJudges!DEGREE = Left(WebJudgeData!DEGREE, 10)
        '  debug RSTJudges!DEGREE = WebJudgeData!DEGREE
        RSTJudges!ORG_NAME = IIf(WebJudgeData!Employer = "", Null, Left(WebJudgeData!Employer, 50)) ' DES 4.0.4 Added
        RSTJudges!MAJOR = IIf(Len(WebJudgeData!MAJOR) = 0, Null, Left(WebJudgeData!MAJOR, 50))
        RSTJudges!MINOR = IIf(Len(WebJudgeData!MINOR) = 0, Null, Left(WebJudgeData!MINOR, 50)) ' 5.0.1
        RSTJudges!EXPER = IIf(Len(WebJudgeData!Experience) = 0, Null, Left(WebJudgeData!Experience, 50)) '5.01
        RSTJudges!P_1 = IIf(Len(WebJudgeData!FirstCat) = 0, " ", WebJudgeData!FirstCat)
        RSTJudges!P_2 = IIf(Len(WebJudgeData!SecondCat) = 0, " ", WebJudgeData!SecondCat)
        RSTJudges!P_3 = IIf(Len(WebJudgeData!ThirdCat) = 0, " ", WebJudgeData!ThirdCat)
        RSTJudges!P_4 = IIf(Len(WebJudgeData!FourthCat) = 0, " ", WebJudgeData!FourthCat)
       If Len(WebJudgeData!localfair) = 0 Then     'Blank=No, 'Y =Yes, 'H'=@Home only, 'W'=@Work only
          RSTJudges!LOCAL_FAIR = Null  ' DES 4.0.4  Should this be "" not null?
       Else
          RSTJudges!LOCAL_FAIR = WebJudgeData!localfair
       End If
       If WebJudgeData!TeamOK = -1 Then RSTJudges!TEAM_OK = "Y"
       If WebJudgeData!TeamOK = 0 Then RSTJudges!TEAM_OK = "N"
       If WebJudgeData!CanJudge = -1 Then   ' -1 = true so set active
         RSTJudges!STATUS = "A"  'DES 4.0.4 Should set "" if not active
       Else
         RSTJudges!STATUS = "I" ' DES rev 5.3.2    use I as inactive this year only
       End If
       RSTJudges!LAST_CHG = Date
' Possible Fail  -------------------------------------------------------------------
       If SetJCAT = True Then                ' DES 4.0.4  DES 5.0.0 always true
         RSTJudges!JCAT = RSTJudges!P_1     ' This will fail if P_1 is not in Judgetypes table
       End If
       RSTJudges.Update
       JudgeInWork = False
       ' DES this is a new judge, so should we check if first_YR is blank, set it here??
       WebJudgeData.Edit
       '  Here the Web data is updated to set judge number and reset newjudge.
       '  Thus, should be able to import as many times as we want and just UPDATE the Local data -
       '  Prevents adding duplicates if many updates.
       WebJudgeData!RetJUN = NxtAvailJUN
       'WebJudgeData!retjun = RSTGetJudgeNo!avino
       WebJudgeData!Exported = -1  ' DES 4.0.1  flag as exported
       WebJudgeData!NewJudge = 0
     '  On Error Resume Next    ' 5.0.1 in case not implemented
       WebJudgeData!DateExported = Now
     '  WebJudgeData!JCAT = RSTJudges!JCAT
     '  On Error GoTo ErrorExit
       WebJudgeData.Update
       '  DES 4.0.4   Now, add the judge to the Web Judge data so if they visit again after this
       '  update, then they will find their name in the web site.
       WebJudgeList.AddNew
        With WebJudgeList
        !SALUTATION = RSTPerson!SALUTATION
        !FNAME = RSTPerson!FNAME
        !MI = RSTPerson!MI
        !LNAME = RSTPerson!LNAME
        !JUN = NxtAvailJUN
        '!JUN = RSTGetJudgeNo!avino
        End With
       WebJudgeList.Update
       ' ----------------------------
       NxtAvailJUN = GetNextAvailJUN()
       'RSTGetJudgeNo.MoveNext 'Get the next aviable JUN.
       CountNew = CountNew + 1
    Else
' --------------------- EDIT -----------------------EDIT--------------EDIT---------------EDIT --------------------
DoEditOnly:      ' DES  4.0.4
        'Edit information to Judge table in SciFairData  I.E.  Import the changed data,
        ' NO NEED to create a person, PID, and all the above stuff
        RSTJudges.Edit
        JudgeInWork = True
        RSTJudges!DEGREE = Left(WebJudgeData!DEGREE, 10)
        '  debug RSTJudges!DEGREE = WebJudgeData!DEGREE
        RSTJudges!ORG_NAME = IIf(WebJudgeData!Employer = "", Null, Left(WebJudgeData!Employer, 50)) ' DES 4.0.4 Added
        RSTJudges!MAJOR = IIf(Len(WebJudgeData!MAJOR) = 0, Null, Left(WebJudgeData!MAJOR, 50))
        RSTJudges!MINOR = IIf(Len(WebJudgeData!MINOR) = 0, Null, Left(WebJudgeData!MINOR, 50)) ' 5.0.1
        RSTJudges!EXPER = IIf(Len(WebJudgeData!Experience) = 0, Null, Left(WebJudgeData!Experience, 50)) '5.01
        RSTJudges!P_1 = IIf(Len(WebJudgeData!FirstCat) = 0, " ", WebJudgeData!FirstCat)
        RSTJudges!P_2 = IIf(Len(WebJudgeData!SecondCat) = 0, " ", WebJudgeData!SecondCat)
        RSTJudges!P_3 = IIf(Len(WebJudgeData!ThirdCat) = 0, " ", WebJudgeData!ThirdCat)
        RSTJudges!P_4 = IIf(Len(WebJudgeData!FourthCat) = 0, " ", WebJudgeData!FourthCat)
       If Len(WebJudgeData!localfair) = 0 Then     'Blank=No, 'Y =Yes, 'H'=@Home only, 'W'=@Work only
          RSTJudges!LOCAL_FAIR = Null  ' DES 4.0.4  should this be ""  text not null
       Else
          RSTJudges!LOCAL_FAIR = WebJudgeData!localfair
       End If
       If WebJudgeData!TeamOK = -1 Then RSTJudges!TEAM_OK = "Y"
       If WebJudgeData!TeamOK = 0 Then RSTJudges!TEAM_OK = "N"
       If WebJudgeData!CanJudge = -1 Then
         RSTJudges!STATUS = "A"  'DES 4.0.4 Should set "" if not active
       Else
         RSTJudges!STATUS = "I"
       End If

       RSTJudges!LAST_CHG = Date
' Possible Fail  -------------------------------------------------------------------
       If SetJCAT = True Then               ' DES 4.0.4  DES 5.0.0 always true
         RSTJudges!JCAT = RSTJudges!P_1
       End If
       ' DES this is a new judge, so should we check if first_YR is blank, set it here??
       RSTJudges.Update
       JudgeInWork = False
       Set RSTPerson = db.OpenRecordset("SELECT * FROM persons Where pid=" & RSTJudges!PID)
       If RSTJudges.RecordCount = 0 Then
          MsgBox ("Broken pointers Program error - All data suspect, start over call dennis")
       Else
          RSTPerson.Edit
       End If
        PersonInWork = True
        RSTPerson!LNAME = WebJudgeData!LNAME
        RSTPerson!FNAME = WebJudgeData!FNAME
        RSTPerson!MI = IIf(Len(WebJudgeData!MidInit) = 0, Null, Mid(WebJudgeData!MidInit, 1, 2))
        RSTPerson!ZIP = WebJudgeData!ZIP
        If IsNull(WebJudgeData!WorkPhone) Then
           RSTPerson!WORK_PHONE = Null
        Else
            RSTPerson!WORK_PHONE = IIf(Len(WebJudgeData!WorkPhone) = 0, Null, ConvertPh(WebJudgeData!WorkPhone))  'DES
        End If
        'RSTPerson!WORK_PHONE = IIf(Len(WebJudgeData!workphone) = 0, Null, ConvertPh(WebJudgeData!workphone)) ' DES
        RSTPerson!EXTENSION = IIf(Len(WebJudgeData!Ext) = 0, Null, WebJudgeData!Ext) 'DES
        RSTPerson!ADDR1 = IIf(Len(WebJudgeData!ADDRESS) = 0, Null, Left(WebJudgeData!ADDRESS, 30))
        RSTPerson!ADDR2 = IIf(Len(WebJudgeData!ADDR2) = 0, Null, Left(WebJudgeData!ADDR2, 30))  ' 5.0.1
        
        ' DES 4.0.4  Do we need to consider Addr2 and salutation??
        RSTPerson!CITY = Left(WebJudgeData!CITY, 20)
        RSTPerson!STATE = WebJudgeData!STATE
        If IsNull(WebJudgeData!HomePhone) Then
           RSTPerson!HOME_PHONE = Null
        Else
            RSTPerson!HOME_PHONE = IIf(Len(WebJudgeData!HomePhone) = 0, Null, ConvertPh(WebJudgeData!HomePhone))  'DES
        End If
        If IsNull(WebJudgeData!CellPhone) Then
           RSTPerson!CELL_PHONE = Null
        Else
           RSTPerson!CELL_PHONE = IIf(Len(WebJudgeData!CellPhone) = 0, Null, ConvertPh(WebJudgeData!CellPhone))  'DES
        End If
        RSTPerson!EMAIL = IIf(Len(WebJudgeData!EMAIL) = 0, "M", WebJudgeData!EMAIL)
       ' DES 4.0.4 Next replaced.  WebJudgeData is always "", "P" or "E" where P = Phone, "" = Postal (M)
       ' RSTPerson!MAILPREF = IIf(Len(WebJudgeData!MAILPREF) = 0, Null, WebJudgeData!MAILPREF)
        RSTPerson!MAILPREF = IIf((Len(WebJudgeData!MAILPREF) = 0) Or (IsNull(WebJudgeData!MAILPREF)), "M", WebJudgeData!MAILPREF)
        'Select Case WebJudgeData!MAILPREF 'M=Postal Mail, E= e-mail, Blank = Postal Mail
        '     Case "E"
        '     Case "M"    ' DES 4.0.4  These were not filled in and not needed
        '     Case ""
        '     Case Else    ' Other values.
        '         RSTPerson!MAILPREF = nulls
        'End Select
        
        ' DES 4.0.4 added "RJ" to TP field  (Type person).
        TPValue = IIf(IsNull(RSTPerson!TP), "", RSTPerson!TP)
        Call setFieldTP(TPValue, "RJ")   ' adds RJ to TO ( at end if already has one or more TP)
        RSTPerson!TP = TPValue
        RSTPerson!LAST_CHG = Date
        RSTPerson.Update
        PersonInWork = False
       ' ----------------- Set the data in web so this record will never be added again -------------
       WebJudgeData.Edit
       WebJudgeData!RetJUN = RSTJudges!JUN
       WebJudgeData!NewJudge = 0
       WebJudgeData!Exported = -1  ' DES 4.0.1  flag as exported
    ' On Error Resume Next   ' des 5.0.1   do this so will not fail while develope and if no field has been added
       WebJudgeData!DateExported = Now
    '   WebJudgeData!JCAT = RSTJudges!JCAT
    '   On Error GoTo ErrorExit
       WebJudgeData.Update
       CountUpdates = CountUpdates + 1
    End If
    CountNewOrUpdates = CountNewOrUpdates + 1
Else    '  skipped : Exported flag was set
SkipRecord:
  CountSkipped = CountSkipped + 1
End If   ' DES 4.0.4   End of if WebJudgeData!Exported = 0  (is the record exported or not?
    WebJudgeData.MoveNext
   '****************************************************************************************************************
    DoEvents
'      LblPERCENT.Caption = mypcent & "%"
      DoEvents
    If a1 < 100 Then
       If mykt = a1 Then
          a1 = a1 + a2
          mypcent = mypcent + 1
        End If
    End If
   '-----------------------------------------------------------------
         Select Case mykt
            Case 0 To H1
               a.Visible = True
            Case h2 To H3 - 1
               b.Visible = True
   '            LblPERCENT.Caption = mypcent & "%"
            Case H3 To H4 - 1
               c.Visible = True
   '            LblPERCENT.Caption = mypcent & "%"
            Case H4 To H5 - 1
               d.Visible = True
   '            LblPERCENT.Caption = mypcent & "%"
            Case H5 To H6 - 1
               e.Visible = True
   '            LblPERCENT.Caption = mypcent & "%"
            Case H6 To H7 - 1
               f.Visible = True
   '            LblPERCENT.Caption = mypcent & "%"
            Case H7 To H8 - 1
               g.Visible = True
   '            LblPERCENT.Caption = mypcent & "%"
            Case H8 To H9 - 1
               h.Visible = True
   '            LblPERCENT.Caption = mypcent & "%"
            Case H9 To h10 - 1
               i.Visible = True
   '            LblPERCENT.ForeColor = 16777215
   '            LblPERCENT.Caption = mypcent & "%"
            Case h10 To H11 - 1
               j.Visible = True
   '            LblPERCENT.Caption = mypcent & "%"
            Case H11 To H12 - 1
               k.Visible = True
   '            LblPERCENT.Caption = mypcent & "%"
            Case H12 To H13 - 1
               L.Visible = True
   '            LblPERCENT.Caption = mypcent & "%"
            Case H13 To H14 - 1
               m.Visible = True
   '            LblPERCENT.Caption = mypcent & "%"
            Case H14 To H15 - 1
               n.Visible = True
               'mypcent = 70
   '            LblPERCENT.Caption = mypcent & "%"
            Case H15 To H16 - 1
               o.Visible = True
   '            LblPERCENT.Caption = mypcent & "%"
            Case H16 To H17 - 1
               p.Visible = True
   '            LblPERCENT.Caption = mypcent & "%"
            Case H17 To H18 - 1
               q.Visible = True
   '            LblPERCENT.Caption = mypcent & "%"
            Case H18 To h19 - 1
               r.Visible = True
   '            LblPERCENT.Caption = mypcent & "%"
            Case h19 To H20 - 5
               s.Visible = True
   '            LblPERCENT.Caption = mypcent & "%"
           Case h19 - 5 To H20
               t.Visible = True
               mypcent = 100
   '            LblPERCENT.Caption = "100%"
     End Select
    DoEvents
    mykt = mykt + 1
    LblPERCENT.Caption = mykt & " of " & CountTotal
 '*******END LOOP ************************END LOOP*******************END LOOP***************END LOOP*************
Loop
StopLoop:     ' DES 4.0.4
MsgBox "Judge update complete!" & vbCrLf & _
        IIf(CountErrors > 0, CountErrors & " ERRORS - YOU MUST FIX THEM!" & vbCrLf & _
        " If The Bad data was Imported - Fix the data in local data base." & vbCrLf & _
        " If you Terminated the Import or Skipped the record(s) - Fix the data in the Web Site.", "") & vbCrLf & _
        CountTotal & " Total Records in the Web Site" & vbCrLf & _
        CountSkipped & " Records Skipped (Loaded Previously + Errors - If Any) " & vbCrLf & _
        CountNewOrUpdates & " Records imported. (New since the last import.)" & vbCrLf & _
        CountNew & " New Judges Added" & vbCrLf & _
        CountUpdates & " Updated Judge data", vbInformation, "Process completed"
BX.Visible = False
a.Visible = False
b.Visible = False
c.Visible = False
d.Visible = False
e.Visible = False
f.Visible = False
g.Visible = False
h.Visible = False
i.Visible = False
j.Visible = False
k.Visible = False
L.Visible = False
m.Visible = False
n.Visible = False
o.Visible = False
p.Visible = False
q.Visible = False
r.Visible = False
s.Visible = False
t.Visible = False
LblPERCENT.Caption = " "
DoEvents
RSTJudges.Close
WebJudgeData.Close
RSTPerson.Close
WebJudgeList.Close
RSAllLocalJudges.Close
db.Close
Set db = Nothing
WebDbs.Close    '  added rev 5.2.4  because the scifairwebdata.ldb file is not being closed after updates.
                '  Did not see any difference.   perhaps some mod in the website has left it open.
Set WebDbs = Nothing
btnClose.Enabled = True
CmdUpdtJudges.Enabled = True
Exit Sub
ErrorExit:    ' Well not always exit!
'If Err = 3044 Then
'   MsgBox Err.Description & vbCrLf & _
'   "CHANGE the path in the FAIRINFO TABLE field 'WebdbPath'. Use the record for FAIR YEAR " & FairYear()
'Else
  CmdUpdtJudges.Enabled = True
  CountErrors = CountErrors + 1
  If Err.Number = 3044 Then
     MsgBox "Can not open the SciFairWebData (Located on Stem Web Site Server)" & vbCrLf & _
            "Check the record in FairInfo Table Field 'WebdbPath'. Use the record for FAIR YEAR " & FairYear() & vbCrLf & _
            "Verify the path (usually a mapped drive). Include the file name in the path." & vbCrLf & _
            "  ", vbInformation, "Web Data Connect Error"
            
            
            
            
  Else
     If Err.Number = 3201 Then
        MsgBox "Write down the next error so you can fix it later!"
        If MsgBox("Error: " & Err.Number & " " & Err.Description & vbCrLf & _
               "  This may be a JCAT in the website not in table JudgeTypes." & vbCrLf & _
               "  Web JUDGE NAME: " & WebJudgeData!FNAME & " " & WebJudgeData!LNAME & vbCrLf & _
               "  Web P_1: " & RSTJudges!P_1 & vbCrLf & _
               "Continue Judge Import Without JCAT?  (You must set JCAT, and Fix P_1, P_2 etc." & vbCrLf & _
               "[Yes] Continue,  [NO] Terminates Import so you can fix all such errors in Web" _
               , vbYesNo, "Import Error") = vbYes Then
              '  I CHECK IF THIS ERROR IS IN JUDGES
               If JudgeInWork = True Then
                 RSTJudges!JCAT = Null
                 RSTJudges.Update
                 Resume Next
               End If
        End If
        'Just Exit the program
     Else
        If Err.Number = 3163 Then
            MsgBox "Write down the next error so you can fix it later!"
            If MsgBox("Error: One of the fields in the WebData is longer than allowed in SciFairData" & vbcrfl & _
            "  The JUDGE NAME is " & WebJudgeData!FNAME & " " & WebJudgeData!LNAME & vbCrLf & _
            "Continue Without this field Set? (You must locate and manually set the field)" & vbCrLf & _
            "[YES] Continue,   [NO]  Terminates Import so you can fix all such errors in Web", vbYesNo, _
                 "Length Error") = vbYes Then
            Resume Next
            End If
        End If
        If Err.Number = 3021 Then
            MsgBox "No Judge Records to Import!"
         
        Else
            MsgBox "Error number " & Err.Number & " " & Err.Description, vbInformation, "Web Import Error" & vbCrLf & _
               "The Judge name is " & WebJudgeData!FNAME & " " & WebJudgeData!LNAME & vbCrLf & _
            " WRITE DOWN THIS ERROR - Fix this problem and try again! Sorry, Process Must TERMINATE!"
        
        End If
      End If
  End If
  btnClose.Enabled = True
End Sub

Private Sub btnClose_Click()
DoCmd.Close acForm, Me.Form.Name ' rev 5.3.3 close the form
End Sub

Private Sub btnClearExhScores_Click()
' Rev 5.3.1
If MsgBox("Do you want to CLEAR and RESET all Website Exhibit Score Data?" & vbCrLf & _
       " (Deletes all records in the Website ExhibitScores Table, Then uploads current Local Exhibit Data)" & vbCrLf & _
        "(Do this Before Beginning Score Form Reading One Time only each fair year!)", vbYesNo + vbDefaultButton2, _
        "CLEAR and Re-set ExhibitScores?") = vbYes Then
  If MsgBox("Are you Sure? This will DELETE any changes made by Chair Persons on the Web Site!" & vbCrLf & _
            "BE PATIENT - THIS TAKES A LONG TIME", vbYesNo + vbDefaultButton2, _
          "ExhibitScores WebReset Verify?") = vbYes Then
    'Set the options for this task
    doClearWeb = True
    doWebDownload = False
    doSimpleUpload = True
    WebDataFinal = False
    isFinalUpload = False
    Rev.SetFocus   ' so can work on btnUpdateScores
    btnUpdateScores.Caption = "Working"
    btnUpdateScores.Enabled = False
    btUpdateScoresFinal.Enabled = False
    btnDownLoadChairFinal.Enabled = False
    btnClearExhScores.Enabled = False
    btnClose.Enabled = False
    CheckLocExh = True       ' rev 5.3.5
    Call UpdateWebScores    '  --   DO THE WORK
    Rev.SetFocus
    btnClearExhScores.Enabled = True
    btnClose.Enabled = True
    btnUpdateScores.Caption = "UpdateScores"
    If IsNull(Me.OpenArgs) Then   ' Not opened from judge Scores Entry
      btUpdateScoresFinal.Enabled = True
      btnDownLoadChairFinal.Enabled = True
      btnUpdateScores.Enabled = True
      btnUpdateScores.SetFocus
    Else
     MsgBox "Web Scores cleared and ready for Judge Scoring"
     DoCmd.Close acForm, Me.Form.Name ' rev 5.3.3 close the form
    End If
    Exit Sub
  End If
End If
MsgBox "Canceled by Operator"
DoCmd.Close acForm, Me.Form.Name ' rev 5.3.3 close the form
End Sub
Private Sub btnUpdateScores_Click()
' Rev 5.3.1
 ' this requires no verifiation unless after clear finals in judge scores entry form
 Dim ans As String
 Dim Args As String
 Dim cat As String
 ' as of rev 5.3.7 I do not think this is ever used..
 If Not IsNull(Me.OpenArgs) Then  ' clicked button on the open form
    If Len(Me.OpenArgs) > 3 Then  ' is ulsfxxxx not normal  uls
      cat = Mid(Me.OpenArgs, 5, Len(Me.OpenArgs))  ' this would not work anyway..as of rev 5.3.7
      ans = MsgBox("You are about to Clear The website Finals for Category " & cat & vbCrLf & _
                    "Are you sure?", vbYesNo + vbDefaultButton2, "Clear Web Finals")
      If ans = vbNo Then Exit Sub
    End If
 End If
 doClearWeb = False
 doWebDownload = False
 doSimpleUpload = True
 WebDataFinal = False
 isFinalUpload = False
  Rev.SetFocus   ' so can work on btnUpdateScores
 btnUpdateScores.Caption = "Working"
 btnUpdateScores.Enabled = False
 btUpdateScoresFinal.Enabled = False
 btnDownLoadChairFinal.Enabled = False
 btnClearExhScores.Enabled = False
 btnClose.Enabled = False
 Call UpdateWebScores    'Call the sub -----------------------------
 Rev.SetFocus
 btnUpdateScores.Caption = "UpLoad Scores and Status"
 btnUpdateScores.Enabled = True
 btnClose.Enabled = True
 If IsNull(Me.OpenArgs) Then   ' Not opened from judge Scores Entry
    btnClearExhScores.Enabled = True
    btUpdateScoresFinal.Enabled = True
    btnDownLoadChairFinal.Enabled = True
    btnUpdateScores.SetFocus
 Else    '  Was opened by Judge Scores Entry Form
   Dim x As String
 
   
   DoCmd.Close acForm, Me.Form.Name   '"xWebSite Sync" ' rev 5.3.3 close the form
 End If
End Sub

Private Sub btUpdateScoresFinal_Click()
 Dim ans As String
 ans = MsgBox("Are You Sure this is FINAL upload (ALL Judge Score Forms Scanned)?", vbYesNo + vbDefaultButton2, _
             "Verify Final Upload")
 If ans = vbYes Then
   doSimpleUpload = True
   isFinalUpload = True
   doClearWeb = False   ' Dialogs make it hard to get here
   doWebDownload = False   '  Only if operator requests
   WebDataFinal = False
   Rev.SetFocus   ' so can work on btnUpdateScores
   btUpdateScoresFinal.Caption = "Working"
   btnUpdateScores.Enabled = False
   btnClearExhScores.Enabled = False
   btnClose.Enabled = False
   btUpdateScoresFinal.Enabled = False
   btnDownLoadChairFinal.Enabled = False
   Call UpdateWebScores    '
   Rev.SetFocus
   btUpdateScoresFinal.Enabled = True
   btUpdateScoresFinal.Caption = "Final UpLoad Scores + Status"
   btnClose.Enabled = True
   If IsNull(Me.OpenArgs) Then
    btnClearExhScores.Enabled = True
    btnDownLoadChairFinal.Enabled = True
    btnUpdateScores.Enabled = True
    btUpdateScoresFinal.SetFocus
   Else    '  Was opened by Judge Scores Entry Form
     DoCmd.Close acForm, Me.Form.Name ' rev 5.3.3 close the form
   End If
 Else
   MsgBox "Canceled by Operator"
   If Not IsNull(Me.OpenArgs) Then
     DoCmd.Close acForm, Me.Form.Name ' rev 5.3.3 close the form
   End If
 End If
End Sub

Private Sub btnDownLoadChairFinal_Click()
 If MsgBox("This Checks all website categories for 'Final' status." & vbCrLf & _
           "  You can confirm download for the categories that are Final." & vbCrLf & _
           " " & vbCrLf & _
           " Sets ExhibitData table Final Scores and TOC from the website data." & vbCrLf & _
           " Sets Categories table 'LocFinal = 'W'" & vbCrLf & _
           " " & vbCrLf & _
           "ARE YOU SURE you want to continue?", vbYesNo + vbDefaultButton1, "Check Website Finals?") = vbYes Then
   'dlCAT = InputBox("Enter the NCAT to download or 'All' for All Categories", "Download Chair Final NCAT Selection")
   dlCAT = "ALL"
   If dlCAT = "" Then MsgBox "Aborted by operator!": Exit Sub
   doClearWeb = False   ' Dialogs make it hard to get here
   doWebDownload = True   '  Only if operator requests
   doSimpleUpload = False
   WebDataFinal = False
   isFinalUpload = False
   Rev.SetFocus   ' so can work on btnUpdateScores
   btnDownLoadChairFinal.Caption = "Working"
   btnUpdateScores.Enabled = False
   btnClearExhScores.Enabled = False
   btnClose.Enabled = False
   btUpdateScoresFinal.Enabled = False
   btnDownLoadChairFinal.Enabled = False
   Call UpdateWebScores    '
   Rev.SetFocus
   btnDownLoadChairFinal.Caption = "DOWNLOAD Category Finals"
   btnClose.Enabled = True
   btnDownLoadChairFinal.Enabled = True
   If IsNull(Me.OpenArgs) Then  ' was not opened by Judge Score Form
    btnClearExhScores.Enabled = True
    btUpdateScoresFinal.Enabled = True
    btnUpdateScores.Enabled = True
    btnDownLoadChairFinal.SetFocus
   Else    '  Was opened by Judge Scores Entry Form
     DoCmd.Close acForm, Me.Form.Name  ' rev 5.3.3 close the form
   End If
 Else
    MsgBox "Aborted by Operator!"
   If Not IsNull(Me.OpenArgs) Then
     DoCmd.Close acForm, Me.Form.Name ' rev 5.3.3 close the form
   End If
 End If
End Sub


Private Sub UpdateWebScores()
' New as of REV 5.3.1 Oct 2009
' various options are set prior to call this routine.
' The routine Uploads Exhibit scores/Downloads exihibit scores and updates the NatCategories table
'   in SciFairWebdata. The uploads and downloads support the web page Chairs Ranking ..
'   Data comes from ExhibitData but uses the function exhscore(EXN) to calculate the exhibit score
'   and Exhibit Status from the ExhibitJudges data file.  (Same as the Category Exhibit Ranking report)
 On Error GoTo SubError
 Dim rsLExh As Recordset
 Dim RSTFairInfo As Recordset
 Dim rsWebExhScores As Recordset
 Dim rsWebNatCategories As Recordset
 Dim rsLCat As Recordset
 Dim MyWebdbPath As String
 Dim db As DAO.Database
 Dim dbweb As DAO.Database
 Dim Cnt As Integer
 Dim Rank As Integer
 Dim curNCAT As String
 Dim Ttl As Integer
 Dim crit As String
 Dim curExn As Integer
 Dim ActualScore As String
 Dim OverrideScore As String
 Dim OverrideScoreFloat As Single
 Dim ActualScoreFloat As Single
 Dim CheckNullWeb As Boolean
 Dim CheckNullLocal As Boolean
 Dim doThisCatDld As Boolean
 Dim doNotFinalCats As Boolean
 Dim NonFinalCats As String   ' keep track of categories that were not final and not downloaded
 Dim DownLoadedCats() As String
 Dim NumDownLoadedCats As Integer
 Dim FinalsDone As Integer    ' rev 5.3.5  count web downloads and local finals
 Dim FinalsNotDone As Integer  ' rev 5.3.5  count web records not ready (= Finals Not done)
 Dim FoundCat As Boolean
 Dim OtherActions As String
 Dim contNormalUpd As Boolean ' rev 5.3.3
 Dim ClearCat As String  ' rev 5.3.3
 ClearCat = ""           ' Normal operation.
 If Not IsNull(Me.OpenArgs) Then  ' clicked button on the open form
    If Len(Me.OpenArgs) > 3 Then  ' is ulsfxxxx not normal  uls
      ClearCat = Mid(Me.OpenArgs, 5, Len(Me.OpenArgs))
    End If
 End If
' Set up the message information and other option related stuff
 OtherActions = ""
 If doClearWeb = True Then OtherActions = OtherActions & "after clearing webdata "
 If doWebDownload = True Then OtherActions = OtherActions & " after downloading Final Scores and Web To_State' "
 '---------  Get the path to the Stem Website Database
 Set db = CurrentDb
 Set RSTFairInfo = db.OpenRecordset("SELECT * FROM FairInfo WHERE Fair_Year = " & FairYear())
 MyWebdbPath = RSTFairInfo!WebdbPath
 RSTFairInfo.Close
 ' Open The exhibitsdata with a calculated Exhibit  actual score & status but score is the current
 '   actual or override, so if sort by Ncat then Score I should be able to set Web data rank.
 '  note the function exhscore(EXN) which returns Score and status in a string called return
 '  rev 5.3.5 535 changed mid([Return],8,Len([return]) -8 to   -7 to get all of status
 '  rev 540  added TeamEx to upload to website  - Also removed  WebTo_State and WebTo_ISEF
 '   since these are recommended only and I do not want to confuse users.  never used locally
 crit = "SELECT Categories.CATNAME, ExhibitData.EXN, ExhibitData.EXHB_TITLE, ExhibitData.SCORE, " & _
        " ExhibitData.TeamEx, ExhibitData.TO_STATE, ExhibitData.SCORE_OVERRIDE, Categories.NCAT, Categories.N_TO_STATE, " & _
        " ExhibitData.TOC, Categories.LocFinal, " & _
        "Categories.N_ALT, Categories.TEAM, exhscore([EXN]) AS Return, Mid([Return],8,Len([return])-7) " & _
        "AS ScoreStatus FROM Categories RIGHT JOIN ExhibitData ON Categories.NCAT = ExhibitData.NCAT " & _
        "ORDER BY [Categories.NCAT], [ExhibitData.Score] DESC;"
 Set rsLExh = db.OpenRecordset(crit)
 ' ---------Open the Web ExhibitScores Table-------------
 Set dbweb = DBEngine.OpenDatabase(MyWebdbPath)
 Set rsWebExhScores = dbweb.OpenRecordset("Select * from ExhibitScores")  ' Get all fields
 ' added this rev 5.4.3  543
 If doClearWeb = False Then
  If rsWebExhScores.RecordCount > 0 Then
    If Mid(rsWebExhScores!Title, 1, 20) = "Practice Exhibit Num" Then
      If MsgBox("It seems that 'practice data' is still on the website!" & vbCrLf & _
                "Continuing will corrupt the practice data and possibly local data!" & vbCrLf & _
                "Do you really want to continue? (Suggest you click [No])", vbYesNo + vbDefaultButton2, "Caution") = vbNo Then
        rsWebExhScores.Close
        rsLExh.Close
        dbweb.Close
        MsgBox "Aborted"
        a.Visible = False
        Exit Sub
      End If
    End If
    rsWebExhScores.MoveFirst
  End If
 End If
 Set rsWebNatCategories = dbweb.OpenRecordset("Select * from NatCategories")  ' Get all fields including RecToState
       ' RecToState keeps track of the total number of exhibits the chair has chosen to be recommended to state.
 If Not rsLExh.EOF Then
   rsLExh.MoveLast
   rsLExh.MoveFirst
 Else
   MsgBox "No Local Exhibits!"
FExit:    ' rev 5.3.5 535
   rsLExh.Close
   rsWebExhScores.Close
   rsWebNatCategories.Close
   dbweb.Close
   MsgBox "Update Aborted"
   a.Visible = False
   Exit Sub
 End If
 ' rev 5.3.5  535   added these checks when do the first clear and update web exhibit scores
 If CheckLocExh = True Then     ' Do checks on local exhibits for possible errors Only when clear webscores.
  Dim founderror As Boolean
  a.Visible = True  ' rev 5.4.6    546  make it bounce to see action is happening
  Do While Not rsLExh.EOF   ' rev 5.3.5
    If a.Visible = True Then
       b.Visible = True
       a.Visible = False
    Else
       a.Visible = True
       b.Visible = False
    End If
    DoEvents
    ' end rev 5.4.6.   546
    founderror = False
    If rsLExh!EXN > 32000 Then
       If MsgBox("EXN " & rsLExh!EXN & " out of range! Run Exhibits Sort & Renumber!" & vbCrLf & _
       "Continue checking?", vbYesNo, "Checking Data") = vbNo Then
         GoTo FExit
       End If
       founderror = True
    End If
    Dim test As String
    test = ExhScore(rsLExh!EXN) ' go calculate a score for this exhibit
    test = rsLExh!return      ' the return from calculating the exhibit score  text string with score and msg??
    If rsLExh!ScoreStatus = "Error: No Judges Assigned " Then
       If MsgBox("Exhibit " & rsLExh!EXN & " has no judge assignments! Continue checking?", vbYesNo, "Checking Data") = vbNo Then
         GoTo FExit
       End If
       founderror = True
    End If
    rsLExh.MoveNext
    
  Loop
  If founderror = True Then
    If MsgBox("Local Exhibits data is not ready for upload! Continuing is not recommended!" & vbCrLf & _
               "Continue?", vbYesNo + vbDefaultButton2, "Data Has Errors") = vbNo Then
          GoTo FExit
    End If
  End If
 End If
  '   end of rev 5.3.5 insert
 rsLExh.MoveFirst
 FoundCat = False
 Ttl = rsLExh.RecordCount
'*************************************************************************************************************
 'Status bar code only here
' Set up the progress bar ---------------
 LblPERCENT.Visible = False
 BX.Visible = False
 a.Visible = False
 b.Visible = False
 c.Visible = False
 d.Visible = False
 e.Visible = False
 f.Visible = False
 g.Visible = False
 h.Visible = False
 i.Visible = False
 j.Visible = False
 k.Visible = False
 L.Visible = False
 m.Visible = False
 n.Visible = False
 o.Visible = False
 p.Visible = False
 q.Visible = False
 r.Visible = False
 s.Visible = False
 t.Visible = False
 LblPERCENT.ForeColor = 0
 H1 = Ttl / 20 ' Set to record count / 20
 h2 = H1 + H1
 H3 = h2 + H1
 H4 = H3 + H1
 H5 = H4 + H1
 H6 = H5 + H1
 H7 = H6 + H1
 H8 = H7 + H1
 H9 = H8 + H1
 h10 = H9 + H1
 H11 = h10 + H1
 H12 = H11 + H1
 H13 = H12 + H1
 H14 = H13 + H1
 H15 = H14 + H1
 H16 = H15 + H1
 H17 = H16 + H1
 H18 = H17 + H1
 h19 = H18 + H1
 H20 = h19 + H1
 Dim mypcent As Integer
 Dim a1 As Integer
 Dim a2 As Integer
 mypcent = 0
 LblPERCENT.Caption = mypcent & "%"
 a1 = Ttl / 100   ' set to some value -----------???????????????
 a2 = Ttl / 100   ' Set to some value ------------------?????????????
 BX.Visible = True
 mykt = 0
' *****************************************************************************
 Cnt = 0  ' Not used at this time
'  ****  Update the Web Data if that options was set
  If doClearWeb = True Then  ' this is set if the button Clear and reset Web exhibit scores is clicked
  ' Empty the current Exhibit Scores Table in the web site _NOTE TOTALLY EMPTY ALL DATA FROM EXHIBITSCORES
    If rsWebExhScores.RecordCount > 0 Then
      With rsWebExhScores
        .MoveFirst
         Do While Not .EOF
          .Delete
          .MoveNext
        Loop
      End With
    End If
  End If
  ' **** Upload and Download any changes
  '  for each exhibit in local
  '     if the exhibit is on web then
  '        if download requested
  '            check each field for differences
  '           any Differences?
  '              IF Allowed change then put web data info into local data base but allow verification.
  '              If Disallowed change issue a warning message
  '     if not on web then add it   - no local update requred
  '  loop
   curNCAT = ""
   With rsWebExhScores
   doNotFinalCats = False   'DEBUG ONLY Download only final categories.  Set to true for 'debug'
   NonFinalCats = ""
   NumDownLoadedCats = 0
   FinalsDone = 0
   FinalsNotDone = 0

'START Loop ********************Start Loop **************** Start Loop *****************************
    '     If New NCAT, Update NatCategories table for selected options
    '     If Exh not exist add it and upload all data
    '     If Exh exists
    '        if simple dwnlod then download
   Do While Not rsLExh.EOF
       ' First get the values of the current LOCAL  Exhibit Data
       ' the score field contains an override if override is set
       OverrideScore = IIf(rsLExh!SCORE_OVERRIDE = True, rsLExh!SCORE, "0")   ' Set Null in web if 0 (seebelow)
       If rsLExh!SCORE_OVERRIDE Then  ' If Override then
          ActualScore = Mid(rsLExh!return, 1, 6)   'This is the judge calculated score to two decimal places
       Else  ' the Score in Exhibits data is an override
          ActualScore = IIf(IsNull(rsLExh!SCORE), 0, rsLExh!SCORE) ' This is the actual score to a lot of decimal places. ??
       End If
'NEW CATEGORY WORK +++++++++
       If rsLExh!NCAT <> curNCAT Then  ' Starting on a new NCAT  (Record set sorted by NCAT first)
         Rank = 1    '  Start over for this NCAT
         contNormalUpd = True  ' REV 5.3.3  assume normal upload
         curNCAT = rsLExh!NCAT
         ' ---------------------------------------------------Update the NatCategory Table Entries for each NCAT -------
         ' Find the record for NCAT then update the website values of ToState, Alternate, LastUpd, LastDld
         rsWebNatCategories.FindFirst ("NCAT = '" & curNCAT & "'")
         If Not rsWebNatCategories.NoMatch Then
 'CATEGORY Exists on web (Should Exist else error) ++++++++
           ' See if already did a final upload on this category
           '  rev 5.3.5  added 'AND doClearWeb = False'  so do not get message if clearing all.
           If rsWebNatCategories!FinalUpld = True And doClearWeb = False And _
                doSimpleUpload = True And ClearCat = "" Then  ' not a category clear
   'ALREADY DID FINAL UPLOAD  - Give Chance to abort or skip
             Dim ans As String
             ' ask this for every category to force them to work hard to undo the final upload
             'If contClearFinalUpd = true Then  ' get permission for all
             If isFinalUpload = True Then  ' rev 5.3.7 we are doing another final upload
                '  just do it again...  rev 5.3.7
             Else  ' See if want to change the status on web and upload
               ans = MsgBox("You already did a Final Upload for " & curNCAT & "!" & vbCrLf & _
                      IIf(isFinalUpload = True, "", _
                      "This will reset the website " & curNCAT & " status to 'Updates Pending'") & vbCrLf & _
                      "CONTINUE UPLOADING CATEGORY? " & curNCAT & "?" & vbCrLf & _
                      "[Cancel] will cancel this and all the other categories", vbYesNoCancel + vbDefaultButton3, _
                      "CAUTION: FINAL UPLOAD HAS BEEN DONE!")
               If ans = vbNo Then
                 contNormalUpd = False
               Else
                 If ans = vbCancel Then
                 '  need to skip all the uploads exit
                   rsLExh.Close
                   rsWebExhScores.Close
                   rsWebNatCategories.Close
                   dbweb.Close
                   MsgBox "Operation Skipped for this and all other categories!"
                   ' rev 5.3.7  does not clear the progress status in form.
                   'Exit Sub
                   GoTo GetOut
                 End If
               End If
             End If
           End If
   ' UPDATE THE WEB NATCATEGORIES TABLE FOR THIS CATEGORY
           rsWebNatCategories.Edit
           LastWebAcc = rsWebNatCategories!LastAcc
           WebDataFinal = rsWebNatCategories!InputFinal
           If doSimpleUpload = True And contNormalUpd = True Then
      'IF UPLOAD -RECORD SIMPLE UPLOAD ACTION IN WEBSITE +++++++++++++
               rsWebNatCategories!LastUpd = Now ' today()
               rsWebNatCategories!tostate = rsLExh!N_TO_STATE  ' ALWAYS UPLOAD CURRENT TO_STATE (Allocated)
                     ' in case changes during fair  or forgot  to change in scifairdata - happens often.
               rsWebNatCategories!Alternate = rsLExh!N_ALT
               If isFinalUpload = True Then    '   This is only place FINAL UPLOAD is created.
                 rsWebNatCategories!FinalUpld = True   ' set all the uploads to final status
               Else
                 If ClearCat = "" Then   ' rev 5.3.3
                   rsWebNatCategories!FinalUpld = False   '  Normal scores upload  sets ALL to false
                ' Else                         '    call from judge scores entry Clear finals
                '    If ClearCat = curNCAT Or ClearCat = "ALL" Then  ' Leave it where it was
                '    '  do not change it
                '   NOTE:  The webisfinal flag was already cleared in Judges Scores Entry form
                 '   End If
                 End If
               End If
           End If
           rsWebNatCategories.Update
            ' Website NatCatetgory table values are now set to same as local Categories
            ' If user requested a download of the Website data, need to update the local table also
            '  Notice that this section is only executed for specific NCATS.
           If doWebDownload = True Then   ' Do all this else do nothing
      ' IF DOWNLOAD and web is FINAL -RECORD ACTIONS SET OPTIONS and... ++++++
               doThisCatDld = True  '   set as default for this one unless changed in this code
               If (curNCAT = dlCAT) Or (dlCAT = "all") Then      '  See if really want to download  - i.e. if final
                   FoundCat = True
                   Dim msgstr As String
                   If WebDataFinal = True Then  ' The web final scores on Chairs Ranking page is set to Final
                       msgstr = " is FINAL at " & LastWebAcc  'This is acctually the time of LAST CHANGE to web data
                       
                   Else  '  Not Final so set to NOT DOWNLOAD unless in debug
                      If doNotFinalCats = True Then  ' Debug ONLY will be true for debug only value set prior to enter loop
                         ' eventually we should never download data that is NOT FINAL so this code will not execute
                         ans = MsgBox("Web Data for " & curNCAT & " is NOT Final! " & vbCrLf & _
                              "Do you Still want to download the Web Final Scores and TO_STATE status?" & vbCrLf & _
                              " [Cancel] Will Continue Downloading Categories marked Final, Skiping Others!" _
                              , vbYesNoCancel + vbDefaultButton3, "Download " & dlCAT)
                         If ans = vbCancel Then
                            doThisCatDld = False
                            FinalsNotDone = FinalsNotDone + 1
                            MsgBox "Download of " & curNCAT & " and all other NOT marked Final will be skipped!"
                            doNotFinalCats = False
                         Else
                            If ans = vbNo Then
                              doThisCatDld = False  ' do not download this one
                              FinalsNotDone = FinalsNotDone + 1
                             ' MsgBox "Download of " & CurNCAT & " skipped!"   do at end
                            End If
                         End If
                      Else  'doNotFinalCats = False  I.E. do not download categories that are not final
                         doThisCatDld = False  ' this is the default if not debug and category is NOT Final
                         ' See if local finals are set   rev 5.3.5
                         If rsLExh!LocFinal = "L" Then
                            FinalsDone = FinalsDone + 1
                         Else
                            FinalsNotDone = FinalsNotDone + 1
                         End If
                      End If
                   End If
                   If doThisCatDld = True Then  '  If still doing the download then..
         'WEB IS FINAL - MORE CHECKS
                      'Do not download if final set by local or if no changes since last download etc
                      'check categories.LocFinal to see if has been made final by local .  if so do checks errors etc
                      If rsLExh!LocFinal = "L" Then
                        doThisCatDld = False
                        MsgBox "Category " & curNCAT & " has already been made final by local staff!" & vbCrLf & _
                               " It will not be downloaded from the web until the conflict is resolved"
                        NonFinalCats = NonFinalCats & curNCAT & ", "
                        FinalsDone = FinalsDone + 1
                      Else  '' is blank or "W"  so MAY? ok to download
                       ' If (WebDataFinal = True And LastWebAcc < rsWebNatCategories!lastdld) _
                       '   Or rsLExh!LocFinal = "W" Then ' do not download  already downloaded
                        If rsLExh!LocFinal = "W" Then  '  already downloaded and locked at website.
              'DO NOT DOWNLOAD AGAIN IF ALREADY MARKED FINAL
                          FinalsDone = FinalsDone + 1  ' rev 5.3.5
                          doThisCatDld = False
                          NonFinalCats = NonFinalCats & curNCAT & ", "
                        Else   ' Finally all is ok to download
              'ASK IF SIGNATURES  rev 5.4.6 546  changed message
                        ' If MsgBox("Do you have the Chairperson's authorization for" & curNCAT & "?", vbYesNo + vbDefaultButton2, "Need Chair Authorization") = vbNo Then
                        If MsgBox("Download " & curNCAT & " Finals?" & vbCrLf & _
                                  "  ", vbYesNo + vbDefaultButton2, "New Category is Final") = vbNo Then
                            dothiscatdl = False
                            NonFinalCats = NonFinalCats & curNCAT & "' "
                            FinalsNotDone = FinalsNotDone + 1  ' rev 5.3.5
                         Else  ' OK finally
              'UPDATE THE LOCAL CATEGORIES TO INDICATE FINAL DOWNLOAD
                           FinalsDone = FinalsDone + 1  ' rev 5.3.5  count the one we are now doing
                           Set rsLCat = db.OpenRecordset("Select LocFinal from Categories where NCAT = '" & _
                           curNCAT & "'")
                           If Not rsLCat.EOF Then
                             rsLCat.Edit
                             rsLCat!LocFinal = "W"   ' Set LocFinal to indicate that a final download has been done from Web
                             rsLCat.Update           ' It is set to 'L' if final scores are entere in XJudgescores Entry
                           End If
                           rsLCat.Close
             'UPDATE WEBSITE NATCATEGORIES AS DOWNLOADED WEB FINAL
                           rsWebNatCategories.Edit
                           rsWebNatCategories!LastDld = Now
                           rsWebNatCategories!LocFinal = "W"
                           rsWebNatCategories.Update
                           NumDownLoadedCats = NumDownLoadedCats + 1
                           ReDim Preserve DownLoadedCats(NumDownLoadedCats)  ' added preserve rev 5.3.5
                           DownLoadedCats(NumDownLoadedCats - 1) = curNCAT
                         End If
                        End If
                      End If
                   Else   ' do not do the download keep track of those Skipped
         'WEB NOT FINAL JUST COUNT IT
                      NonFinalCats = NonFinalCats & curNCAT & ", "
                   End If
               End If  ' downloading specific category information doThisCatDld is Now set true or false for actual
                       '  download later
           End If   'if DoWebDownload = TRUE
           If doClearWeb = True Then
               ' nothing at this time
           End If
         Else  ' did not find the new category on the website
           MsgBox "Did not find NCAT " & curNCAT & " in NatCategories on Web site. Need to update categories!"
           'FoundCat = False
         End If
       End If  ' end of new category code section
'  End New Category Work
'
'FOR EACH  EXHIBIT IN THE WEBSITE ExhibitScores  Table
'
' UPLOAD (if needed) and UPDATE WEB EXHIBITSCORES TABLE ++++++++++++++++++++++++
       ' -----------Beging uploading/updating  the exhibit data ----------------------------------------------------------
      .FindFirst ("ExNo = " & rsLExh!EXN)  '  See if this exhibit record is on the website
      ' *********** ADD ***************  ADD *****************  ADD ******************** ADD **********************
      If .NoMatch = True Then  ' *******************  NOT IN WEB SO ADD ***************************************
 ' UPLOAD A NEW EXHIBIT +++++++
        ' Add the exhibit record?? and all current fields, Score, EnNo... but not Override and not TO_STATE
        ' ?? not sure?? if Scoreoverride is set then use the Exhibit!Score as the override because it is the override
        If doSimpleUpload = True Then
         .AddNew     '   Add this record to the website.  This probably no happen on fair day and if it does it
                     '     will be before judging starts.  (I have to assume something)
          !ExNo = rsLExh!EXN
          ' Rev 540   ---------------------------
          !TeamEx = rsLExh!TeamEx
          If rsLExh!SCORE_OVERRIDE Then   'rev 5.3.3  if the score is final always upload the final score
             !SCORE = OverrideScore
          Else
             !SCORE = ActualScore
          End If
          !NCAT = rsLExh!NCAT
          !Title = rsLExh!EXHB_TITLE
          If ActualScore = 0 And rsLExh!TO_STATE = "N" Then  '  No Show
            !STATUS = "No Show"
          Else
            !STATUS = rsLExh!ScoreStatus
            ' First time we add this exhibit it is very unlikely we have overrides or OverRide in Status
            ' so I will not even attempt to upload that stuff
          End If
          !Rank = Rank  ' Note the rank is the rank used in the default first loading of the website page = Judges rank
          ' !Override = IIf(OverrideScore = 0, Null, OverrideScore)' Override not uploaded to WEB with out user option 'final'
          ' !TO_STATE = rsLExh!TO_STATE   'TO_STATE not uploaded without user option 'final' upload . not sure even then
         .Update
        End If
'DOWNLOAD, THEN UPLOAD  ****** DOWNLOAD AND UPLOAD  ****** DOWNLOAD AND UPLOAD  ***** DOWNLOAD AND UPLOAD  **
      Else
        'Found a matching Exhibit record
        '  First:  Down load the web current Final (Override) and TO_SATE IF REQUESTED  ************  Download*********
        If doThisCatDld = True And (dlCAT = rsLExh!NCAT Or dlCAT = "all") And doWebDownload = True Then '
 'DOWNLOAD +++ Score Final (override), Web To-State, Web To-ISEF +++++++++++++++++++++++++++++
           ' dothiscatdld true means that it is REALLY ok to download without other checks
           ' and it means that categories.LocFinal has been set to "W"
           curExn = !ExNo
           OverrideScoreFloat = IIf(rsLExh!SCORE_OVERRIDE = True, rsLExh!SCORE, "0")   ' Set Null in web if 0 (seebelow)
           If rsLExh!SCORE_OVERRIDE Then
              ActualScoreFloat = Mid(rsLExh!return, 1, 6)   'This is the judge calculated score to two decimal places
           Else
              ActualScoreFloat = IIf(IsNull(rsLExh!SCORE), 0, rsLExh!SCORE) ' This is the actual score to a lot of decimal places. ??
           End If
           rsLExh.Edit   ' Start the edit process
           If Not IsNull(!Override) Then    ' website has an override entry
              If !Override > 0 Then         ' change local else leave local the same
                rsLExh!SCORE_OVERRIDE = True
                rsLExh!SCORE = !Override
              End If
           End If
           rsLExh!TOC = !TOC   ' rev 5.3.7   Top of category results from the web
           ' else leave the local score AND Local override as they are
          '  Also, the total number recommended to state in the NatCategories.RecToState field
          ' removed in rev 5.3.7
          ' rev 540  I never use the next two in the local data so I will remove from ExhibitsData Table
          '   Eventually
          ' rsLExh!WebTo_State = !TO_STATE  ' from Web value= blank, Y or A set these fields in the local ExhibitsData table.
          ' rsLExh!WebTO_ISEF = !To_ISEF    ' From the website values
          ' end rev 540 change
           
           rsLExh.Update
        End If  '  ***************  End dowebDownload = true section **********************End Download Section *******
 'UPLOAD +++ Score, Status, Rank only +++++++++++++++++++++++++++++++++++
        '         **************  START Update the SCORE and STATUS and Rank in the web site *********************************
        '  Usually Always upload the current Score and Status even after a final download  Thus the local and web will be the same
        If doSimpleUpload = True And contNormalUpd = True Then   ' REV 5.3.3  assume normal upload
          ' rev 5.3.3
          If ClearCat = "" Or ClearCat = curNCAT Or ClearCat = "ALL" Then
            .Edit   ' start the edit of the website record in exhibitscores table
                'Note if we just did a final download, or set overrides local then
                ' the the score may be the override score
                ' so must send back the override final
                If rsLExh!SCORE_OVERRIDE Then
                  ' !SCORE = OverrideScore     ' rev 5.3.3
                   !SCORE = ActualScore         ' rev 5.3.6  If the score has been overridden locally then
                                                ' LocFinal should = 'L' and the NatCategory has already been
                                                '  set LocFinal = L so chair cannot update and.. I must reset
                                                ' What the chair has done.
                   !Override = OverrideScore
                Else
                   !SCORE = ActualScore
                   If ClearCat <> "" Then     ' added the if statement rev 543  5.4.3
                       !Override = Null       ' Rev 543 5.4.3 The logic on this was wrong wrong wrong  it always set
                                          ' the Website ExhibitScores Override to Null on normal upload.  should never
                                          ' have done that!   WHy when did I change etc.   This was a catastropy in 2011!
                   End If
                End If
                '  This is not necessary UNLESS the staff did the overrides and this is the FINAL UPLOAD!
                '!TO_STATE = rsLExh!TO_STATE
                If ActualScore = 0 Then ' No SHows have null score changed to 0 above
                  If rsLExh!TO_STATE = "N" Then  '  No Shows should also have an N put in to state
                   !STATUS = "No Show"
                  Else
                   !STATUS = rsLExh!ScoreStatus  ' will show nocards or other status
                  End If
                Else
                   !STATUS = rsLExh!ScoreStatus  ' will show missing cards, missing marks etc.
                End If
                !Rank = Rank
            .Update
          End If
        End If
      End If  ' **********   end of if .nomatch ...
     rsLExh.MoveNext
     Rank = Rank + 1
     Cnt = Cnt + 1
    '***********************END LOOP CODE   ********START  ******Progress bar update ****************************
    DoEvents
    If a1 < 100 Then
       If mykt = a1 Then
          a1 = a1 + a2
          mypcent = mypcent + 1
        End If
    End If
   '-----------------------------------------------------------------
         Select Case mykt
            Case 0 To H1
               a.Visible = True
            Case h2 To H3 - 1
               b.Visible = True
            Case H3 To H4 - 1
               c.Visible = True
            Case H4 To H5 - 1
               d.Visible = True
            Case H5 To H6 - 1
               e.Visible = True
            Case H6 To H7 - 1
               f.Visible = True
            Case H7 To H8 - 1
               g.Visible = True
            Case H8 To H9 - 1
               h.Visible = True
            Case H9 To h10 - 1
               i.Visible = True
            Case h10 To H11 - 1
               j.Visible = True
            Case H11 To H12 - 1
               k.Visible = True
            Case H12 To H13 - 1
               L.Visible = True
            Case H13 To H14 - 1
               m.Visible = True
            Case H14 To H15 - 1
               n.Visible = True
            Case H15 To H16 - 1
               o.Visible = True
            Case H16 To H17 - 1
               p.Visible = True
            Case H17 To H18 - 1
               q.Visible = True
            Case H18 To h19 - 1
               r.Visible = True
            Case h19 To H20 - 5
               s.Visible = True
           Case h19 - 5 To H20
               t.Visible = True
               mypcent = 100
    End Select
    DoEvents
    mykt = mykt + 1
    LblPERCENT.Caption = mykt & " of " & CountTotal
   Loop
 '*******END LOOP ************************END LOOP*******************END LOOP***************END LOOP*************
   
   End With
   rsLExh.Close
   rsWebExhScores.Close
   rsWebNatCategories.Close
   db.Close
   dbweb.Close
'  LblPERCENT.Caption = " "
  DoEvents
  ' ---------------
  If doWebDownload = True Then
    Dim ii As Integer
    Dim dlcats As String
    
    If NumDownLoadedCats > 0 Then
      dlcats = "Downloaded: "
      For ii = 0 To UBound(DownLoadedCats) - 1
        dlcats = dlcats & DownLoadedCats(ii) & ", "
      Next ii
    Else
      dlcats = "No Downloads "
    End If
    dlcats = dlcats & vbCrLf & FinalsDone & " Categories Final " & vbCrLf & _
             FinalsNotDone & " Categories NOT Final " & vbCrLf

   'If dlcats <> "" Then
      MsgBox dlcats
   ' Else
   '   MsgBox "No downloads were made"
   ' End If
    If NonFinalCats <> "" Then
      '  MsgBox "Categories Skipped (Not Final or Previously downloaded or Not Authorized): " & NonFinalCats
    Else
      '  MsgBox "All Non-Final Categories Skipped!"
    End If
  End If
GetOut:
    LblPERCENT.Caption = ""
  ' --------- Turn off the progress chart
  BX.Visible = False
  a.Visible = False
  b.Visible = False
  c.Visible = False
  d.Visible = False
  e.Visible = False
  f.Visible = False
  g.Visible = False
  h.Visible = False
  i.Visible = False
  j.Visible = False
  k.Visible = False
  L.Visible = False
  m.Visible = False
  n.Visible = False
  o.Visible = False
  p.Visible = False
  q.Visible = False
  r.Visible = False
  s.Visible = False
  t.Visible = False
  DoEvents
  Exit Sub
SubError:
  ' If Exists(rsLExh!exh) Then
  '    'MsgBox "Error in UpdateWebScores: " & Err.Description & " at " & CurNCAT & " " & rsLExh!EXN
  ' Else
      MsgBox "Error in UpdateWebScores: " & Err.Description
  ' End If
   rsWebExhScores.Close  ' added rev 5.2.4  database is being left open probably not here.
   rsWebNatCategories.Close  'rev 5.3.1
   rsLExh.Close
   dbweb.Close        ' added rev 5.2.4
End Sub



Private Sub Form_Load()

  If Not IsNull(Me.OpenArgs) Then
    CmdExh.Enabled = False
    CmdUpdtJudges.Enabled = False
    btnCats.Enabled = False
    btnClearExhScores.Enabled = False
    btnJudgeUD.Enabled = False
    btnSchTeach.Enabled = False
    btnUpdateScores.Enabled = False
    btUpdateScoresFinal.Enabled = False
    btnDownLoadChairFinal.Enabled = False
    btnClearExhScores.Enabled = False
    'btnClose.Enabled = False
    If Me.OpenArgs = "CLWS" Then   ' Clear web scores
      btnClearExhScores.Enabled = True
    End If
    If Me.OpenArgs = "ULS" Then     ' Non final update scores  all categories
      btnUpdateScores.Enabled = True
     '  btnUpdateScores_Click   ' works but does not show the form and progress bar
    End If
    If Mid(Me.OpenArgs, 1, 4) = "ULSF" Then ' Update scores make Categories FINAL with exceptions!
      If Len(Me.OpenArgs) > 4 Then
        btnUpdateScores.Enabled = True  ' Show the updatescores button
       ' Will ONLY UPLOAD the categories in the string. ALL or a single category
       ' ULSFXXXXX   where XXXXX = ALL or an NCAT to upload and make Not Final
       '  XXXXX is placed there ONLY by Judges Scores Entry Clear category button
       '  AS of Rev 543  5.4.3 JudgesScoresEntry Clear Category button does not call websync.
      Else
        btUpdateScoresFinal.Enabled = True
      End If
    End If
    If Me.OpenArgs = "DLWEB" Then   ' Download web entries.
      btnDownLoadChairFinal.Enabled = True
    End If
    If Me.OpenArgs = "UDCATS" Then   ' Update and CLEAR the categories for beggining of scores entries
      btnCats.Enabled = True
    End If
    'rev 5.5.7   disable bottom buttons on normal run   add else statements
  Else
    btnUpdateScores.Enabled = False
    btUpdateScoresFinal.Enabled = False
    btnDownLoadChairFinal.Enabled = False
    btnClearExhScores.Enabled = False
  
  End If
    
    
End Sub