Version =20
VersionRequired =20
Checksum =-753865455
Begin Form
    AllowFilters = NotDefault
    AutoCenter = NotDefault
    AllowDeletions = NotDefault
    AllowAdditions = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =0
    TabularFamily =48
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =13920
    DatasheetFontHeight =10
    ItemSuffix =97
    Left =150
    Top =75
    Right =14130
    Bottom =8820
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0x19a6188c3303e440
    End
    GUID = Begin
        0x799b77d5f3c5c644a1a3b1f1e589ee21
    End
    RecordSource ="SELECT ExhibitData.EXN, ExhibitData.SCORE, ExhibitData.FLOOR, ExhibitData.EXHB_T"
        "ITLE, ExhibitData.TO_STATE, ExhibitData.SCORE_OVERRIDE, ExhibitData.NUMJUDGES, e"
        "xhscore([EXN]) AS ScrStatus, Categories.TEAM, ExhibitData.JCAT, ExhibitData.Team"
        "Ex FROM Categories RIGHT JOIN ExhibitData ON Categories.NCAT=ExhibitData.NCAT OR"
        "DER BY ExhibitData.EXN; "
    Caption ="Judge Scores Entry"
    OnOpen ="[Event Procedure]"
    OnClose ="[Event Procedure]"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000c8370000f40b000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010400069c00f42103df800701000100ea0a6f08640001000700fdff02000100 ,
        0x5802030000004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x020000001b010000ffffffff0000000000000000000000000000000044494e55 ,
        0x22006807a4095018f9eb89280000000000000000000000000000000000000000 ,
        0x0000000000000000470000000000000000000000000000000000000000000000 ,
        0x0000000000000000180000000000000000000300000002000000010002000000 ,
        0x0000000000000000000000000100000001000100010000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000010000000100 ,
        0x0000000000000000000000000000000000000000010000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000001000000000000000000000068070000534d544a ,
        0x0000000010005807480050002000500053004300200031003500300030002000 ,
        0x7300650072006900650073000000496e70757442696e00464f524d534f555243 ,
        0x4500524553444c4c00556e69726573444c4c004850507265416e616c79736973 ,
        0x0046616c7365004d53507265416e616c797369730046616c7365004850526570 ,
        0x6f727453796d6d65747269634d617267696e730046616c73650048504d696e69 ,
        0x6d697a654d617267696e730046616c7365004850416c69676e4d617267696e73 ,
        0x466f724d4400547275650048505072696e74507265766965770046616c736500 ,
        0x48504f76657253707261794f7074696f6e004175746f6d617469630048504f76 ,
        0x6572537072617900313030004850426f726465724c65737350686f746f004661 ,
        0x6c7365004850426f726465724c6573734175746f4669740046616c7365004850 ,
        0x437573746f6d426f726465726c65737300547275650048504f75747075744f72 ,
        0x64657252657665727365005472756500506170657253697a65004c4554544552 ,
        0x004f7269656e746174696f6e00504f52545241495400485053656e645072656c ,
        0x6f6164436f6d6d616e6400545255450048504e55736544696666466972737450 ,
        0x61676543686f696365005472756500485044727954696d654f7074696f6e0041 ,
        0x75746f6d6174696300485044727954696d650030004850496e6b566f6c756d65 ,
        0x4f7074696f6e004175746f6d61746963004850496e6b566f6c756d65004e6f72 ,
        0x6d616c0048505072696e74496e477261795363616c650046616c736500507269 ,
        0x6e745175616c697479004e6f726d616c005072696e745175616c69747947726f ,
        0x757000505147726f75705f32004850436f6c6f724d6f646500434f4c4f525f4d ,
        0x4f444500485050444c547970650050444c5f50434c33004850584d4c46696c65 ,
        0x557365640068706f31353030742e786d6c004850506f737465725072696e7469 ,
        0x6e670046616c7365004850506f737465725072696e74696e674f7074696f6e00 ,
        0x504f535445525f3200436f6c6f724d6f646500436f6c6f723234005465787441 ,
        0x73426c61636b0046616c7365004d65646961576964746853656e736f7200496e ,
        0x7374616c6c6564004d6564696154797065004155544f4d41544943005265736f ,
        0x6c7574696f6e0036303064706900505144504900496e7374616c6c6564004850 ,
        0x4175746f4475706c65785363616c696e6700547275650048505072696e744f6e ,
        0x426f746853696465734d616e75616c6c790046616c73650048504d616e75616c ,
        0x4475706c65784469616c6f674974656d7300496e737472756374696f6e49445f ,
        0x30315f4641434555502d4e4f524f544154450048504d616e75616c4475706c65 ,
        0x7850616765526f746174650055736572526f746174650048504d616e75616c46 ,
        0x6565644f7269656e746174696f6e0046414345555000485053706565644d6563 ,
        0x68004661737444726166740048504d616e75616c4475706c65784469616c6f67 ,
        0x4d6f64656c004d6f64616c0048504d616e75616c4475706c6578506167654f72 ,
        0x646572004f6464506167657346697273740048504d61704d616e75616c466565 ,
        0x64546f54726179310046616c7365005053416c69676e6d656e7446696c650048 ,
        0x505a33416c686e00505353657276696365734f7074696f6e004c61756e636854 ,
        0x6f6f6c426f78004850436c65616e696e6746696c6573446174610048505f436c ,
        0x65616e5f5465737450616765004850436f6e73756d6572437573746f6d506170 ,
        0x6572004850437573746f6d004a6f6255490054727565004850436f6c6f725365 ,
        0x6c656374696f6e466f7248504100456e61626c6564004850426f726e4f6e4461 ,
        0x7465004850424f44004850496e707574436f6c6f72537061636500434f4c4f52 ,
        0x534d415254004850437573746f6d53697a65436f6d6d616e6400545255450048 ,
        0x50524553444c4c4e616d65004850465245533530004850526564457965526564 ,
        0x756374696f6e004f6e0048504469676974616c496d6167696e67004850486f6d ,
        0x655072696e74696e67004850536d617274466f637573004f6e004850436f6e74 ,
        0x72617374004f66660048504469676974616c466c617368004f66660048505368 ,
        0x6172706e657373004f6666004850536d6f6f7468696e67004f66660048504a70 ,
        0x6567506e67506173737468726f75676800547275650048504854444c4c4e616d ,
        0x650048504649476c686e0048504d48444c4c4e616d6500485046494d45353000 ,
        0x485048504146696c7465720054727565004850416476616e636564436f6c6f72 ,
        0x53657474696e670054727565004850435244436f6d6d616e6400547275650048 ,
        0x504d6972726f725072696e740046616c736500485053656e64556e69744d6561 ,
        0x73757265436f6d6d616e640054525545004850486167616b695072696e74696e ,
        0x6700545255450000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x5018000049555048100011000000000002000000040000000100000000000000 ,
        0x0000000003000000000000000100000001000100640001000100020002000000 ,
        0x01000000020000004c0065007400740065007200000000000000000000000000 ,
        0x0000000000000000000000000100ea0a6f080000ffffffffffffffffffffffff ,
        0x0100000006000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000001000000000000000100000000000000000000000000000000000000 ,
        0x00000000000000000000000020005b006e006f006e0065005d00000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000020005b006e006f006e0065005d00000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000041007200690061006c0000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000003400000050000000000000000100000000000000 ,
        0xc0c0c00000000000c0c0c0000000000000000000000000000000000001000000 ,
        0x01000000640000000000000000000000000000000000803f0000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000000000000 ,
        0x000000000f0000000f0000000100000000000000010000000000000000000000 ,
        0x0000000000000000440045004e004e0049005300000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000003c004100750074006f006d0061007400690063003e00 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000010000000000000000000000010000000f0000001b01000000000000 ,
        0x0f0000001b010000000000000200000000000000000000000f0000001b010000 ,
        0x0f0000001b01000000000000000000000000000052bb0d003408000034080000 ,
        0x0000000000000000360030003000640070006900000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000001b0100001b01000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0100000043007500730074006f006d0020005000720069006e00740020005300 ,
        0x65007400740069006e0067007300000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000001000000020000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000064000000010000005000720069006e00 ,
        0x74002000640072006900760065007200200068006f0073007400200066006f00 ,
        0x7200200033003200620069007400200061007000700000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000002000440065006600 ,
        0x610075006c00740020005000720069006e007400200053006500740074006900 ,
        0x6e00670073000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000078000000420c000078000000420c000000000000 ,
        0x00000000000000000000000074000000490c00007b000000430c000000000000 ,
        0x0000000000000000000000006d000000fa0b000075000000440c000002000000 ,
        0xffffffff73706c776f7736342e65786500000000010000000100000001000000 ,
        0x0100000001000000010000000100000001000000010000000100000001000000 ,
        0x0100000001000000010000000100000001000000010000000100000001000000 ,
        0x0100000001000000010000000100000001000000010000000f0000001b010000 ,
        0x0f0000001b0100000f0000001b0100000f0000001b0100000000000000000000 ,
        0x000000001a0100000000000000000000000000000000000043003a005c005700 ,
        0x69006e0064006f00770073005c00730070006c0077006f007700360034002e00 ,
        0x6500780065000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x08001b002e000100000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000055534230303100
    End
    OnTimer ="[Event Procedure]"
    FilterOnLoad =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DisplayOnSharePointSite =0
    DatasheetGridlinesColor12 =12632256
    UnknownProp = {419 ,0 ,0 ,0 ,2121 } Begin
        0x000041390000000080019300b0d9130030e5ac00f4a9130035794139a8831700 ,
        0x0400000030aa1300d5784139040000008806540db20200000000000004ab1300 ,
        0x01042140dc006d0703df80070100010000000000640001000700fdff02000100 ,
        0x0000030000000000040000002ed7413900009300302e93000000000078aa1300 ,
        0xded5413930e5ac0080cabb00c60d0000ffffffff303193000000000080019300 ,
        0xc60d000080ca0000000000000000000000000000000000000000000001000000 ,
        0x0300000001000000010000000000000000000000000000000000000042836587 ,
        0x0000000000000000000000000000000000000008880800088808000000000000 ,
        0x0000000000000000520300004c04000000640000010000000000000000000000 ,
        0x0000000100070000000000000000000000000000000036000000000000000100 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0041007200690061006c00000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000038000000c201000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000f2b100004283658701ccdaba000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000ccdaba6800700020007000730063 ,
        0x0020003100320030003000200073006500720069006500730000006500720069 ,
        0x00650073002c004c006f00630061006c004f006e006c0079002c004400720076 ,
        0x0043006f006e0076006500720074000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000010000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000
    End
    UnknownProp = {420 ,0 ,0 ,0 ,314 } Begin
        0x040017002a000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000550053004200300030003100 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000
    End
    Begin
        Begin Label
            BackStyle =0
            BackColor =-2147483633
            ForeColor =-2147483630
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            PictureAlignment =2
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            FontSize =8
            FontWeight =400
            FontName ="MS Sans Serif"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            UnknownProp = {324 ,0 ,0 ,0 ,1 } Begin
                0x00
            End
        End
        Begin OptionButton
            SpecialEffect =2
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionGroup
            SpecialEffect =3
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin BoundObjectFrame
            SpecialEffect =2
            OldBorderStyle =0
            BackStyle =0
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            BackColor =-2147483643
            ForeColor =-2147483640
            AsianLineBreak =255
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            ShowDatePicker =1
        End
        Begin ListBox
            SpecialEffect =2
            BackColor =-2147483643
            ForeColor =-2147483640
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ComboBox
            SpecialEffect =2
            BackColor =-2147483643
            ForeColor =-2147483640
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Subform
            SpecialEffect =2
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin UnboundObjectFrame
            SpecialEffect =2
            OldBorderStyle =1
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CustomControl
            SpecialEffect =2
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ToggleButton
            FontSize =8
            FontWeight =400
            FontName ="MS Sans Serif"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            UnknownProp = {321 ,0 ,0 ,0 ,1 } Begin
                0x00
            End
        End
        Begin Tab
            BackStyle =0
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            UnknownProp = {311 ,0 ,0 ,0 ,1 } Begin
                0x00
            End
        End
        Begin FormHeader
            Height =6780
            BackColor =-2147483633
            Name ="FormHeader"
            GUID = Begin
                0xdb56aaed712ce84a9a15ab318e563ee3
            End
            Begin
                Begin CommandButton
                    OverlapFlags =85
                    Left =180
                    Top =1680
                    Height =540
                    TabIndex =1
                    ForeColor =5026082
                    Name ="btnImport"
                    Caption ="    Get Judges    Score File"
                    OnClick ="[Event Procedure]"
                    FontName ="Tahoma"
                    ControlTipText ="Read Score Forms Data from a file  (comma separated values)"
                    GUID = Begin
                        0x03253c427a54d24ea54beccf4fd9531b
                    End

                    LayoutCachedLeft =180
                    LayoutCachedTop =1680
                    LayoutCachedWidth =1620
                    LayoutCachedHeight =2220
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin CommandButton
                    OverlapFlags =93
                    Left =1860
                    Top =2160
                    Height =540
                    TabIndex =5
                    ForeColor =5026082
                    Name ="btnChairReport"
                    Caption ="  Print Category Results   "
                    OnClick ="[Event Procedure]"
                    FontName ="Tahoma"
                    ControlTipText ="Print a ranked exhibit list and status information for a selected category  ( NC"
                        "AT)"
                    GUID = Begin
                        0xcaeef9d77f2fd84d9e640daea55029bc
                    End

                    LayoutCachedLeft =1860
                    LayoutCachedTop =2160
                    LayoutCachedWidth =3300
                    LayoutCachedHeight =2700
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {360 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =1680
                    Top =5460
                    Width =1380
                    Height =480
                    TabIndex =10
                    ForeColor =5026082
                    Name ="btnScoresOverrides"
                    Caption ="Enter Final Scores Local"
                    OnClick ="[Event Procedure]"
                    FontName ="Tahoma"
                    ControlTipText ="Normally NOT USED! Enter final scores and/or mark a category 'Final' (backup if "
                        "website Cat Ranking is down)"
                    GUID = Begin
                        0xfbaea511a454024b9c389b0d7daccf47
                    End

                    LayoutCachedLeft =1680
                    LayoutCachedTop =5460
                    LayoutCachedWidth =3060
                    LayoutCachedHeight =5940
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin CommandButton
                    Visible = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =93
                    Left =3240
                    Top =5220
                    Width =1260
                    Height =540
                    TabIndex =13
                    ForeColor =-2147483630
                    Name ="btnAddLateExhibitJudges"
                    Caption ="Add Judges New Exhibits"
                    OnClick ="[Event Procedure]"
                    FontName ="Tahoma"
                    ControlTipText ="How to Assign Judges to a New Exhibit (Late-Show)"
                    GUID = Begin
                        0xe2c116cd9c4ec941b1cef6a0a0deeb41
                    End

                    LayoutCachedLeft =3240
                    LayoutCachedTop =5220
                    LayoutCachedWidth =4500
                    LayoutCachedHeight =5760
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {360 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin CommandButton
                    Visible = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =93
                    Left =3240
                    Top =3900
                    Width =1320
                    Height =540
                    TabIndex =12
                    ForeColor =-2147483630
                    Name ="btnEnterExhibitRanking"
                    Caption ="Enter Exhibit Ranking"
                    OnClick ="[Event Procedure]"
                    FontName ="Tahoma"
                    ControlTipText ="Enter exhibit ranking (Adjusts scores to create desired rank)"
                    GUID = Begin
                        0x1b86aa92d63b5f4b889d3817342e9af3
                    End

                    LayoutCachedLeft =3240
                    LayoutCachedTop =3900
                    LayoutCachedWidth =4560
                    LayoutCachedHeight =4440
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {360 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin TextBox
                    CanGrow = NotDefault
                    TabStop = NotDefault
                    ScrollBars =2
                    SpecialEffect =0
                    OverlapFlags =215
                    TextFontCharSet =177
                    TextAlign =1
                    FilterLookup =0
                    IMESentenceMode =3
                    Left =3540
                    Top =420
                    Width =10260
                    Height =6300
                    ColumnOrder =0
                    FontSize =10
                    TabIndex =6
                    BorderColor =16744448
                    Name ="TextBox"
                    DefaultValue ="\"Welcome\""
                    FontName ="Arial"
                    ControlTipText ="List Box (File Read Information, Chair's Lists)"
                    GUID = Begin
                        0x3ba5088638895b4d8d94b7a66040d529
                    End

                    LayoutCachedLeft =3540
                    LayoutCachedTop =420
                    LayoutCachedWidth =13800
                    LayoutCachedHeight =6720
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =180
                    Top =3660
                    Width =1320
                    Height =480
                    TabIndex =14
                    Name ="btnClearScores"
                    Caption ="Clear ALL Scores"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Before Scanning (First). CAUTION: Clears all scores in the data base! Empties We"
                        "bsite ExhibitScores table!"
                    GUID = Begin
                        0xfe481cc549601c47ab331a94683a3b5d
                    End

                    LayoutCachedLeft =180
                    LayoutCachedTop =3660
                    LayoutCachedWidth =1500
                    LayoutCachedHeight =4140
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin Label
                    OverlapFlags =93
                    TextAlign =1
                    Left =180
                    Width =3720
                    Height =300
                    FontSize =12
                    FontWeight =700
                    Name ="Label34"
                    Caption ="JUDGE SCORES ENTRY "
                    GUID = Begin
                        0xa2292b4fd8a6d440aa6802016c6ef33e
                    End
                    LayoutCachedLeft =180
                    LayoutCachedWidth =3900
                    LayoutCachedHeight =300
                End
                Begin Label
                    OverlapFlags =87
                    TextAlign =2
                    Left =3900
                    Width =2805
                    Height =240
                    Name ="Label35"
                    Caption ="Copyright 2010-2014 Dennis Spanogle"
                    GUID = Begin
                        0x304f8fa1c8d1004a95b59aeeae8e2a72
                    End
                    LayoutCachedLeft =3900
                    LayoutCachedWidth =6705
                    LayoutCachedHeight =240
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =1860
                    Top =1140
                    Height =420
                    TabIndex =3
                    ForeColor =5026082
                    Name ="btChairList"
                    Caption ="Category Status ->"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="View the current scoring and website status for a selected category  ( NCAT)"
                    GUID = Begin
                        0xe85a42c1ff6fdb4cac160013e98cdf58
                    End

                    LayoutCachedLeft =1860
                    LayoutCachedTop =1140
                    LayoutCachedWidth =3300
                    LayoutCachedHeight =1560
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin Label
                    OverlapFlags =93
                    Left =240
                    Top =3360
                    Width =1260
                    Height =240
                    ForeColor =2366701
                    Name ="Label37"
                    Caption ="Before Scanning"
                    GUID = Begin
                        0xc6afc8b99766c6468508ea0d8cdb4fe9
                    End
                    LayoutCachedLeft =240
                    LayoutCachedTop =3360
                    LayoutCachedWidth =1500
                    LayoutCachedHeight =3600
                End
                Begin Line
                    OverlapFlags =95
                    Left =180
                    Top =3360
                    Width =2940
                    Name ="Line38"
                    GUID = Begin
                        0x337c566bd3e2ea4ba7fbd7209b735e78
                    End
                    LeftPadding =30
                    TopPadding =30
                    RightPadding =30
                    BottomPadding =30
                    GridlineStyleLeft =0
                    GridlineStyleTop =0
                    GridlineStyleRight =0
                    GridlineStyleBottom =0
                    GridlineWidthLeft =1
                    GridlineWidthTop =1
                    GridlineWidthRight =1
                    GridlineWidthBottom =1
                    LayoutCachedLeft =180
                    LayoutCachedTop =3360
                    LayoutCachedWidth =3120
                    LayoutCachedHeight =3360
                End
                Begin Line
                    LineSlant = NotDefault
                    OverlapFlags =85
                    Left =3180
                    Top =3360
                    Width =0
                    Height =3360
                    Name ="Line40"
                    GUID = Begin
                        0x9532cdc4e14ef84e965aa053cdd2148d
                    End
                    LeftPadding =30
                    TopPadding =30
                    RightPadding =30
                    BottomPadding =30
                    GridlineStyleLeft =0
                    GridlineStyleTop =0
                    GridlineStyleRight =0
                    GridlineStyleBottom =0
                    GridlineWidthLeft =1
                    GridlineWidthTop =1
                    GridlineWidthRight =1
                    GridlineWidthBottom =1
                    LayoutCachedLeft =3180
                    LayoutCachedTop =3360
                    LayoutCachedWidth =3180
                    LayoutCachedHeight =6720
                End
                Begin Line
                    OverlapFlags =85
                    Left =120
                    Top =3360
                    Width =0
                    Height =3300
                    Name ="Line41"
                    GUID = Begin
                        0x358b940542b0e0468019e3954facde2d
                    End
                    LeftPadding =30
                    TopPadding =30
                    RightPadding =30
                    BottomPadding =30
                    GridlineStyleLeft =0
                    GridlineStyleTop =0
                    GridlineStyleRight =0
                    GridlineStyleBottom =0
                    GridlineWidthLeft =1
                    GridlineWidthTop =1
                    GridlineWidthRight =1
                    GridlineWidthBottom =1
                    LayoutCachedLeft =120
                    LayoutCachedTop =3360
                    LayoutCachedWidth =120
                    LayoutCachedHeight =6660
                End
                Begin Line
                    OverlapFlags =85
                    Left =180
                    Top =6720
                    Width =2940
                    Name ="Line42"
                    GUID = Begin
                        0xfdd2702ecbfcd44a847999e226606075
                    End
                    LeftPadding =30
                    TopPadding =30
                    RightPadding =30
                    BottomPadding =30
                    GridlineStyleLeft =0
                    GridlineStyleTop =0
                    GridlineStyleRight =0
                    GridlineStyleBottom =0
                    GridlineWidthLeft =1
                    GridlineWidthTop =1
                    GridlineWidthRight =1
                    GridlineWidthBottom =1
                    LayoutCachedLeft =180
                    LayoutCachedTop =6720
                    LayoutCachedWidth =3120
                    LayoutCachedHeight =6720
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =1860
                    Top =720
                    Height =300
                    TabIndex =2
                    Name ="btnClearText"
                    Caption ="Clear Text -->"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Clear text from the list box"
                    GUID = Begin
                        0x92d37d755895094798134b710a4c1157
                    End

                    LayoutCachedLeft =1860
                    LayoutCachedTop =720
                    LayoutCachedWidth =3300
                    LayoutCachedHeight =1020
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin TextBox
                    TabStop = NotDefault
                    OverlapFlags =93
                    IMESentenceMode =3
                    Left =180
                    Top =2460
                    Width =1380
                    Height =300
                    ColumnOrder =1
                    TabIndex =19
                    Name ="tbRecord"
                    ControlTipText ="File read progress"
                    GUID = Begin
                        0xa1e83177b54c3c4fa425063dcd2c3a82
                    End

                    LayoutCachedLeft =180
                    LayoutCachedTop =2460
                    LayoutCachedWidth =1560
                    LayoutCachedHeight =2760
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =180
                    Top =2280
                    Width =120
                    Height =120
                    TabIndex =21
                    Name ="btnDoNothing"
                    Caption ="no actio - invisible"
                    GUID = Begin
                        0x43f43a12fdd41f49a07baa7929c4fd48
                    End

                    LayoutCachedLeft =180
                    LayoutCachedTop =2280
                    LayoutCachedWidth =300
                    LayoutCachedHeight =2400
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =11640
                    Width =2040
                    Height =240
                    Name ="lblRevision"
                    Caption ="Rev 5.5.7(xxx/xx/14)"
                    GUID = Begin
                        0x0d4d3154254fea418b0c1eb56e781404
                    End
                    LayoutCachedLeft =11640
                    LayoutCachedWidth =13680
                    LayoutCachedHeight =240
                End
                Begin TextBox
                    TabStop = NotDefault
                    OverlapFlags =247
                    IMESentenceMode =3
                    Left =180
                    Top =2700
                    Width =3120
                    Height =300
                    ColumnOrder =2
                    TabIndex =20
                    Name ="tbLastFile"
                    ControlTipText ="The Last File Read"
                    GUID = Begin
                        0x253a0202f4a60c4b976da54ac021e228
                    End

                    LayoutCachedLeft =180
                    LayoutCachedTop =2700
                    LayoutCachedWidth =3300
                    LayoutCachedHeight =3000
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =180
                            Top =3060
                            Width =3000
                            Height =240
                            Name ="Label67"
                            Caption ="Last File Imported"
                            GUID = Begin
                                0x05e1ac3a0a90e94f9397597f16aa519f
                            End
                            LayoutCachedLeft =180
                            LayoutCachedTop =3060
                            LayoutCachedWidth =3180
                            LayoutCachedHeight =3300
                        End
                    End
                End
                Begin CheckBox
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =1320
                    Top =720
                    Width =240
                    Height =300
                    ColumnOrder =3
                    TabIndex =22
                    Name ="cbListMissingDbl"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Check to List Records with Missing or Multiple Score Marks"
                    GUID = Begin
                        0x9e6e301a4d297e4986ec693a4f9106a5
                    End

                    LayoutCachedLeft =1320
                    LayoutCachedTop =720
                    LayoutCachedWidth =1560
                    LayoutCachedHeight =1020
                    Begin
                        Begin Label
                            OverlapFlags =247
                            Left =180
                            Top =660
                            Width =1380
                            Height =420
                            Name ="Label69"
                            Caption ="List Missing        and Double Marks"
                            ControlTipText ="Check to List Records with Missing or Multiple Score Marks"
                            GUID = Begin
                                0xb0244c56ae4d8d489c1f30a1a3714695
                            End
                            LayoutCachedLeft =180
                            LayoutCachedTop =660
                            LayoutCachedWidth =1560
                            LayoutCachedHeight =1080
                        End
                    End
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =1680
                    Top =6060
                    Width =1380
                    Height =540
                    TabIndex =11
                    Name ="btnClrOverridesOneCat"
                    Caption ="Clear Category 'Final' DownLoad"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Clear the Web 'Final' Download and enable Edits on the website. \015\012 You wil"
                        "l have to re-do 'Download Web 'Final' Entries' after the website edits are compl"
                        "ete."
                    GUID = Begin
                        0xce9c67f69ee5f748ac3334f5d55c2fd9
                    End

                    LayoutCachedLeft =1680
                    LayoutCachedTop =6060
                    LayoutCachedWidth =3060
                    LayoutCachedHeight =6600
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =180
                    Top =4860
                    Width =1320
                    Height =480
                    TabIndex =17
                    Name ="btnBuildStuData"
                    Caption ="Build DataLink Student Data"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Before Scanning (Third): Build Student Data base for import to DataLink"
                    GUID = Begin
                        0x28d2df542637e74ea6275df2ee3a8835
                    End

                    LayoutCachedLeft =180
                    LayoutCachedTop =4860
                    LayoutCachedWidth =1500
                    LayoutCachedHeight =5340
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =1680
                    Top =3660
                    Width =1380
                    Height =480
                    TabIndex =7
                    ForeColor =5026082
                    Name ="btFindForm"
                    Caption ="Find a Score Form"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="List Batch Sequence numbers for a judge name or number"
                    GUID = Begin
                        0x2016ac0e70b42945accfb199c2a5d5fc
                    End

                    LayoutCachedLeft =1680
                    LayoutCachedTop =3660
                    LayoutCachedWidth =3060
                    LayoutCachedHeight =4140
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =180
                    Top =1140
                    Height =420
                    ForeColor =5026082
                    Name ="btnStatus"
                    Caption ="Overall Status"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="List Status summary for all Categories"
                    GUID = Begin
                        0xa3bc7dc206d00742b5a97af573bc7680
                    End

                    LayoutCachedLeft =180
                    LayoutCachedTop =1140
                    LayoutCachedWidth =1620
                    LayoutCachedHeight =1560
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =1860
                    Top =1620
                    Height =480
                    TabIndex =4
                    ForeColor =5026082
                    Name ="btUpDateWebScores"
                    Caption ="Update Website  Scores"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Loads 'WebSite Sync' to Upload the current Scores and Status to Web Site\015\012"
                        "Note: Catetories To_State and Alt_To_State are also uploaded (In case they were "
                        "changed)"
                    GUID = Begin
                        0x7271f6571173864ab556d43f6763b921
                    End
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =1860
                    LayoutCachedTop =1620
                    LayoutCachedWidth =3300
                    LayoutCachedHeight =2100
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =180
                    Top =5460
                    Width =1320
                    Height =480
                    TabIndex =16
                    Name ="btnNoShows"
                    Caption ="     Enter/Edit     No Shows"
                    StatusBarText ="Do this first"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Anytime:  Set an Exhibit as No Show. (Exhibit must not have scores).  Used in va"
                        "rious Reports, Website, Category Reports..."
                    GUID = Begin
                        0xe34254315c0ddc47b9760975838e3a8a
                    End
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =180
                    LayoutCachedTop =5460
                    LayoutCachedWidth =1500
                    LayoutCachedHeight =5940
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =180
                    Top =6060
                    Width =1320
                    Height =540
                    TabIndex =18
                    Name ="btnToState"
                    Caption ="   Verify  To_State values"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Before Scanning or if Allocations change: (Numbers Allocated for State Fair)"
                    GUID = Begin
                        0x39c859630699ba4299afd5284e277547
                    End
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =180
                    LayoutCachedTop =6060
                    LayoutCachedWidth =1500
                    LayoutCachedHeight =6600
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =180
                    Top =4260
                    Width =1320
                    Height =480
                    TabIndex =15
                    Name ="btnUpdateCats"
                    Caption ="Clear  / Update Categories"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Before Scanning (Second): CAUTION: Clears most status fields in Categories and W"
                        "ebCategories tables! (Does not change N_TO_STATE or N_ALT)\015\012NOTE: Categori"
                        "es To_State and Alt_To_State are uploaded each time you 'Upload Scores'"
                    GUID = Begin
                        0x381f303b30d4cc458c727e4e3a1b332f
                    End
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =180
                    LayoutCachedTop =4260
                    LayoutCachedWidth =1500
                    LayoutCachedHeight =4740
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =1680
                    Top =4860
                    Width =1380
                    Height =480
                    TabIndex =9
                    ForeColor =5026082
                    Name ="btnDownloadWeb"
                    Caption ="Download Web 'Final' Entries"
                    OnClick ="[Event Procedure]"
                    FontName ="Tahoma"
                    ControlTipText ="Download 'Final' scores, TOC awards and other entries from the website and mark "
                        "categories 'Final'"
                    GUID = Begin
                        0x73949e8aa143044085e2b0646d2f1dff
                    End
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =1680
                    LayoutCachedTop =4860
                    LayoutCachedWidth =3060
                    LayoutCachedHeight =5340
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin Label
                    OverlapFlags =87
                    Left =1740
                    Top =3360
                    Width =1260
                    Height =240
                    ForeColor =2366701
                    Name ="Label83"
                    Caption ="Special Tasks"
                    GUID = Begin
                        0x378dd1e137c8df49bbecc64ac63a78fd
                    End
                    LayoutCachedLeft =1740
                    LayoutCachedTop =3360
                    LayoutCachedWidth =3000
                    LayoutCachedHeight =3600
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =1680
                    Top =4260
                    Width =1380
                    Height =480
                    TabIndex =8
                    ForeColor =5026082
                    Name ="btnUploadScoresFinal"
                    Caption ="Final Update Website Scores"
                    OnClick ="[Event Procedure]"
                    FontName ="Tahoma"
                    ControlTipText ="Upload Scores and Status and set web status as 'Final UpLoad'  (using xWebSite S"
                        "ync)"
                    GUID = Begin
                        0x075604b9e6387b42b8e8c5926c5a6b84
                    End
                    ImageData = Begin
                        0x00000000
                    End

                    LayoutCachedLeft =1680
                    LayoutCachedTop =4260
                    LayoutCachedWidth =3060
                    LayoutCachedHeight =4740
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =180
                    Top =360
                    Width =3180
                    Height =240
                    ForeColor =2366701
                    Name ="LblTeamworkmark"
                    GUID = Begin
                        0xe90eef315665604887f779891280ed85
                    End
                    LayoutCachedLeft =180
                    LayoutCachedTop =360
                    LayoutCachedWidth =3360
                    LayoutCachedHeight =600
                End
            End
        End
        Begin Section
            Height =2580
            BackColor =-2147483633
            Name ="Detail"
            GUID = Begin
                0xbbad1c8d88d3f04e8d7c50a2ba9665e0
            End
            Begin
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    DecimalPlaces =0
                    OverlapFlags =93
                    IMESentenceMode =3
                    Left =1440
                    Top =780
                    Width =720
                    Height =255
                    ColumnWidth =900
                    TabIndex =4
                    Name ="EXN"
                    ControlSource ="EXN"
                    StatusBarText ="The Exhibit Number"
                    GUID = Begin
                        0x479713a1ad228f4cbeae37b4d55e4191
                    End

                    LayoutCachedLeft =1440
                    LayoutCachedTop =780
                    LayoutCachedWidth =2160
                    LayoutCachedHeight =1035
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =180
                            Top =780
                            Width =1140
                            Height =255
                            Name ="EXN_Label"
                            Caption ="Exhibit Number"
                            GUID = Begin
                                0xa7ba8cff00565647af258b077a8be216
                            End
                            LayoutCachedLeft =180
                            LayoutCachedTop =780
                            LayoutCachedWidth =1320
                            LayoutCachedHeight =1035
                        End
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    EnterKeyBehavior = NotDefault
                    ScrollBars =2
                    OverlapFlags =93
                    IMESentenceMode =3
                    Left =180
                    Top =1380
                    Width =6420
                    Height =480
                    ColumnWidth =3000
                    TabIndex =9
                    Name ="EXHB_TITLE"
                    ControlSource ="EXHB_TITLE"
                    StatusBarText ="The title of the Exhibit"
                    ControlTipText ="The Exhibit Title"
                    GUID = Begin
                        0xf2904aed122c364cb00bff1052b83fe8
                    End

                    LayoutCachedLeft =180
                    LayoutCachedTop =1380
                    LayoutCachedWidth =6600
                    LayoutCachedHeight =1860
                End
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    DecimalPlaces =2
                    OverlapFlags =93
                    IMESentenceMode =3
                    Left =3540
                    Top =780
                    Width =840
                    Height =255
                    ColumnWidth =2310
                    TabIndex =5
                    Name ="SCORE"
                    ControlSource ="SCORE"
                    Format ="Standard"
                    StatusBarText ="The Exhibits Final Score"
                    ControlTipText ="Current Score (Score Card if not changed, Final if adjusted in Chair Caucus)"
                    GUID = Begin
                        0x46ecc4aabd0fe6469759f3f8860e2135
                    End

                    LayoutCachedLeft =3540
                    LayoutCachedTop =780
                    LayoutCachedWidth =4380
                    LayoutCachedHeight =1035
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =2460
                            Top =780
                            Width =960
                            Height =255
                            Name ="SCORE_Label"
                            Caption ="Score (Final)"
                            GUID = Begin
                                0xee1490258f5ce9429a5b7672f3affbbb
                            End
                            LayoutCachedLeft =2460
                            LayoutCachedTop =780
                            LayoutCachedWidth =3420
                            LayoutCachedHeight =1035
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =93
                    IMESentenceMode =3
                    Left =3900
                    Top =1920
                    Width =300
                    Height =255
                    ColumnWidth =225
                    TabIndex =12
                    Name ="TO_STATE"
                    ControlSource ="TO_STATE"
                    StatusBarText ="Staff Only: Exhibit qualified to go to next level (State Fair)? Y=Yes A= Alterna"
                        "te N=No Show Exhibit"
                    BeforeUpdate ="[Event Procedure]"
                    AfterUpdate ="[Event Procedure]"
                    GUID = Begin
                        0x616e6d9f9f079c469ac363d1c11622fe
                    End

                    LayoutCachedLeft =3900
                    LayoutCachedTop =1920
                    LayoutCachedWidth =4200
                    LayoutCachedHeight =2175
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =3060
                            Top =1920
                            Width =720
                            Height =255
                            Name ="TO_STATE_Label"
                            Caption ="To State"
                            GUID = Begin
                                0x1840b1feb6bcee4485b2d6ad64365c2d
                            End
                            LayoutCachedLeft =3060
                            LayoutCachedTop =1920
                            LayoutCachedWidth =3780
                            LayoutCachedHeight =2175
                        End
                    End
                End
                Begin CheckBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =93
                    Left =5280
                    Top =780
                    ColumnWidth =1110
                    TabIndex =6
                    Name ="SCORE_OVERRIDE"
                    ControlSource ="SCORE_OVERRIDE"
                    StatusBarText ="Score Override by Chair if Checked"
                    GUID = Begin
                        0x7294ff82275eca4caa7c40e5b10f9b26
                    End

                    LayoutCachedLeft =5280
                    LayoutCachedTop =780
                    LayoutCachedWidth =5540
                    LayoutCachedHeight =1020
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =4500
                            Top =780
                            Width =720
                            Height =255
                            Name ="SCORE_OVERRIDE_Label"
                            Caption ="Override"
                            GUID = Begin
                                0x693f6fca222ff141adba0ee1678293b0
                            End
                            LayoutCachedLeft =4500
                            LayoutCachedTop =780
                            LayoutCachedWidth =5220
                            LayoutCachedHeight =1035
                        End
                    End
                End
                Begin Subform
                    OverlapFlags =85
                    Left =6840
                    Top =60
                    Width =6900
                    Height =2460
                    TabIndex =14
                    Name ="TestExhbitScores  Subform"
                    SourceObject ="Form.xJudge Scores Entry Subform"
                    LinkChildFields ="EXN"
                    LinkMasterFields ="EXN"
                    EventProcPrefix ="TestExhbitScores__Subform"
                    GUID = Begin
                        0x1b1a50b2852df54a84e3a3112776dc5e
                    End

                    LayoutCachedLeft =6840
                    LayoutCachedTop =60
                    LayoutCachedWidth =13740
                    LayoutCachedHeight =2520
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =3960
                            Top =2220
                            Width =2700
                            Height =255
                            FontSize =10
                            Name ="TestExhbitScores  Subform_Label"
                            Caption ="Forms Data -  Marks 1 to 5 -->"
                            EventProcPrefix ="TestExhbitScores__Subform_Label"
                            GUID = Begin
                                0xeffaee9a82dbd34495282a74061a6265
                            End
                            LayoutCachedLeft =3960
                            LayoutCachedTop =2220
                            LayoutCachedWidth =6660
                            LayoutCachedHeight =2475
                        End
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    OverlapFlags =93
                    IMESentenceMode =3
                    Left =1020
                    Top =1920
                    Width =300
                    ColumnWidth =825
                    TabIndex =10
                    Name ="FLOOR"
                    ControlSource ="FLOOR"
                    StatusBarText ="'Y' = Exhibit requires Floor space. \"N\" = table space"
                    ControlTipText ="This Exhibit is set up on the floor, not on a table"
                    GUID = Begin
                        0x65b26ed0feac3141a4a0c220036ece9f
                    End

                    LayoutCachedLeft =1020
                    LayoutCachedTop =1920
                    LayoutCachedWidth =1320
                    LayoutCachedHeight =2160
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =180
                            Top =1920
                            Width =660
                            Height =240
                            Name ="Label22"
                            Caption ="FLOOR:"
                            GUID = Begin
                                0x5f327afaf70d6e40b71f6965613e36a9
                            End
                            LayoutCachedLeft =180
                            LayoutCachedTop =1920
                            LayoutCachedWidth =840
                            LayoutCachedHeight =2160
                        End
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    Locked = NotDefault
                    DecimalPlaces =0
                    OverlapFlags =93
                    IMESentenceMode =3
                    Left =1740
                    Top =2220
                    Width =420
                    TabIndex =13
                    Name ="NUMJUDGES"
                    ControlSource ="NUMJUDGES"
                    StatusBarText ="Temp Use by SFCards, DO NOT REMOVE"
                    GUID = Begin
                        0x7e0c1316ff98124ebf69bf84382f7646
                    End

                    LayoutCachedLeft =1740
                    LayoutCachedTop =2220
                    LayoutCachedWidth =2160
                    LayoutCachedHeight =2460
                    Begin
                        Begin Label
                            Visible = NotDefault
                            OverlapFlags =93
                            Left =180
                            Top =2220
                            Width =1410
                            Height =240
                            Name ="Label23"
                            Caption ="Number of Judges:"
                            GUID = Begin
                                0x2d016aaac17abe40a8c75b0c51cc9ff9
                            End
                            LayoutCachedLeft =180
                            LayoutCachedTop =2220
                            LayoutCachedWidth =1590
                            LayoutCachedHeight =2460
                        End
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    DecimalPlaces =0
                    OverlapFlags =93
                    IMESentenceMode =3
                    Left =2220
                    Top =1080
                    Width =4380
                    ColumnWidth =630
                    TabIndex =8
                    Name ="ScrStatus"
                    ControlSource ="ScrStatus"
                    StatusBarText ="No Scores, Missing Marks, Double Marks, Etc"
                    ControlTipText ="Status of Score Forms Data processing (Score Forms calculated score, judges/othe"
                        "r status)"
                    GUID = Begin
                        0xd15453aca894914884039eccefb03feb
                    End

                    LayoutCachedLeft =2220
                    LayoutCachedTop =1080
                    LayoutCachedWidth =6600
                    LayoutCachedHeight =1320
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =180
                            Top =1080
                            Width =1995
                            Height =240
                            Name ="Label25"
                            Caption ="Score Forms Score/Status:"
                            GUID = Begin
                                0x93ae686c1f086d4e99122cf32c683b8d
                            End
                            LayoutCachedLeft =180
                            LayoutCachedTop =1080
                            LayoutCachedWidth =2175
                            LayoutCachedHeight =1320
                        End
                    End
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =93
                    Left =4020
                    Top =420
                    Width =1500
                    Height =300
                    TabIndex =3
                    Name ="btnRemoveOverride"
                    Caption ="Remove Override"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Click to remove this exhibit's override (Calculate score from Score Forms Data)"
                    GUID = Begin
                        0xb25e801fb6c92c4fb31bb1301fd13ccb
                    End

                    LayoutCachedLeft =4020
                    LayoutCachedTop =420
                    LayoutCachedWidth =5520
                    LayoutCachedHeight =720
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {360 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =93
                    Left =2460
                    Top =420
                    Width =1260
                    Height =300
                    TabIndex =2
                    Name ="btnOverrideScore"
                    Caption ="Override Score"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Click to override this exhibit's score"
                    GUID = Begin
                        0xf6dab9e083bdab4da03b14205211e4f7
                    End

                    LayoutCachedLeft =2460
                    LayoutCachedTop =420
                    LayoutCachedWidth =3720
                    LayoutCachedHeight =720
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {360 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =93
                    Left =480
                    Top =420
                    Width =1740
                    Height =300
                    TabIndex =1
                    Name ="btnRecalculateScore"
                    Caption ="Recalculate Score"
                    OnClick ="[Event Procedure]"
                    ControlTipText ="Recalculates All Exhibit Scores and Updates Exhibit Score Status"
                    GUID = Begin
                        0xc7664246b8c893439f39409ed8df0b9c
                    End

                    LayoutCachedLeft =480
                    LayoutCachedTop =420
                    LayoutCachedWidth =2220
                    LayoutCachedHeight =720
                    UnknownProp = {356 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {357 ,0 ,0 ,0 ,4 } Begin
                        0x02000000
                    End
                    UnknownProp = {358 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {359 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                    UnknownProp = {360 ,0 ,0 ,0 ,4 } Begin
                        0x01000000
                    End
                End
                Begin CheckBox
                    Locked = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =93
                    Left =6420
                    Top =480
                    ColumnWidth =675
                    TabIndex =7
                    Name ="TEAM"
                    ControlSource ="TEAM"
                    StatusBarText ="Team type Category"
                    GUID = Begin
                        0xa182ce66a2be234db7e3a96f2e96d778
                    End

                    LayoutCachedLeft =6420
                    LayoutCachedTop =480
                    LayoutCachedWidth =6680
                    LayoutCachedHeight =720
                    Begin
                        Begin Label
                            OverlapFlags =95
                            Left =5640
                            Top =480
                            Width =765
                            Height =240
                            Name ="Label29"
                            Caption ="TEAMCat"
                            GUID = Begin
                                0xbd22ca302a09c443a17fd45c6176b4d8
                            End
                            LayoutCachedLeft =5640
                            LayoutCachedTop =480
                            LayoutCachedWidth =6405
                            LayoutCachedHeight =720
                        End
                    End
                End
                Begin OptionGroup
                    TabStop = NotDefault
                    OverlapFlags =255
                    Left =60
                    Top =60
                    Width =6720
                    Height =2460
                    TabIndex =15
                    Name ="Selected Exhibit Data"
                    EventProcPrefix ="Selected_Exhibit_Data"
                    GUID = Begin
                        0x9965f4279a48474bb5fb32b5199b29a9
                    End

                    LayoutCachedLeft =60
                    LayoutCachedTop =60
                    LayoutCachedWidth =6780
                    LayoutCachedHeight =2520
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =247
                            Left =180
                            Top =60
                            Width =3600
                            Height =300
                            FontSize =10
                            FontWeight =700
                            Name ="Label33"
                            Caption ="Selected Exhibit - Data and Edits "
                            GUID = Begin
                                0x55fbd7c036356c4cb3d5dbf77643259b
                            End
                            LayoutCachedLeft =180
                            LayoutCachedTop =60
                            LayoutCachedWidth =3780
                            LayoutCachedHeight =360
                        End
                    End
                End
                Begin TextBox
                    TabStop = NotDefault
                    OverlapFlags =247
                    IMESentenceMode =3
                    Left =5340
                    Top =120
                    Width =780
                    Name ="cbEXN"
                    AfterUpdate ="[Event Procedure]"
                    ControlTipText ="Display information for the exhibit entered"
                    GUID = Begin
                        0x864b00c9698daa4d9600a0c22b2e898f
                    End

                    LayoutCachedLeft =5340
                    LayoutCachedTop =120
                    LayoutCachedWidth =6120
                    LayoutCachedHeight =360
                    Begin
                        Begin Label
                            OverlapFlags =247
                            Left =3900
                            Top =120
                            Width =1320
                            Height =240
                            Name ="Label55"
                            Caption ="Find This EXN -->"
                            GUID = Begin
                                0xcc55053bcb9a72459dbe1f1af2425c64
                            End
                            LayoutCachedLeft =3900
                            LayoutCachedTop =120
                            LayoutCachedWidth =5220
                            LayoutCachedHeight =360
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =247
                    IMESentenceMode =3
                    Left =2160
                    Top =1920
                    Width =780
                    ColumnWidth =825
                    TabIndex =11
                    Name ="JCAT"
                    ControlSource ="JCAT"
                    StatusBarText ="The Judging Assignment Category - Links to Div and Category information"
                    GUID = Begin
                        0x3b6e13137842a64d88f1b10d452495db
                    End

                    LayoutCachedLeft =2160
                    LayoutCachedTop =1920
                    LayoutCachedWidth =2940
                    LayoutCachedHeight =2160
                    Begin
                        Begin Label
                            OverlapFlags =247
                            Left =1560
                            Top =1920
                            Width =510
                            Height =240
                            Name ="Label65"
                            Caption ="JCAT:"
                            GUID = Begin
                                0xb4efb1e01584944db54700bf993f94eb
                            End
                            LayoutCachedLeft =1560
                            LayoutCachedTop =1920
                            LayoutCachedWidth =2070
                            LayoutCachedHeight =2160
                        End
                    End
                End
                Begin Label
                    OverlapFlags =247
                    Left =4260
                    Top =1920
                    Width =2460
                    Height =270
                    Name ="Label84"
                    Caption ="<-Y=Yes A=Alternate N=No Show"
                    GUID = Begin
                        0xca150346e397ef4e8b25d8a5013bca6f
                    End
                    LayoutCachedLeft =4260
                    LayoutCachedTop =1920
                    LayoutCachedWidth =6720
                    LayoutCachedHeight =2190
                End
                Begin CheckBox
                    Locked = NotDefault
                    OverlapFlags =247
                    Left =5640
                    Top =780
                    ColumnWidth =1080
                    TabIndex =16
                    Name ="TeamEx"
                    ControlSource ="TeamEx"
                    StatusBarText ="No longer supported (Rev237 only)"
                    GUID = Begin
                        0xcf2de978c1dabf4fb0b37dd361469a9d
                    End

                    LayoutCachedLeft =5640
                    LayoutCachedTop =780
                    LayoutCachedWidth =5900
                    LayoutCachedHeight =1020
                    Begin
                        Begin Label
                            OverlapFlags =247
                            Left =5880
                            Top =780
                            Width =660
                            Height =240
                            Name ="Label87"
                            Caption ="TeamEx"
                            GUID = Begin
                                0x7f8d8e64919c0c43aa604bb1ae438d39
                            End
                            LayoutCachedLeft =5880
                            LayoutCachedTop =780
                            LayoutCachedWidth =6540
                            LayoutCachedHeight =1020
                        End
                    End
                End
            End
        End
        Begin FormFooter
            Height =0
            BackColor =-2147483633
            Name ="FormFooter"
            GUID = Begin
                0x7c82e57b20c18f47a1943f70c76b419b
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
'    SciFairMaster.mdb  (All class objects and modules)
'
'    Copyright (C) 2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,
'                  2014  Dennis e.Spanogle
'
'    This program is free software: you can redistribute it and/or modify
'    it under the terms of the GNU General Public License as published by
'    the Free Software Foundation, either version 3 of the License, or
'    (at your option) any later version.
'
'    This program is distributed in the hope that it will be useful,
'    but WITHOUT ANY WARRANTY; without even the implied warranty of
'    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
'    GNU General Public License for more details.
'
'    You should have received a copy of the GNU General Public License
'    along with this program.  If not, see <http://www.gnu.org/licenses/>.
Option Compare Database
Option Explicit
  Dim TimerDone As Boolean ' use in timer event to exit delay used in btImport
  Dim Scores As Recordset ' holds the query results
  Dim ScoresQuery As QueryDef 'the actual query object
  Dim CkbSeqNumValue As Integer
  Dim ListMsgDbl As Boolean
  Dim msg As String
  Dim testtest As Integer
  Dim RecStatus As String
  Dim ChangedForm As Boolean  ' used to let dotext know if changed the underlying data for the displayed form
  Dim ChairListCat As String
  Dim ChairReportCat As String
  ' Declare message box that I can make non-modal
  ' use return = Messag3eBox &0 "message", "caption",wtypes ...
  Private Declare Function MessageBox _
    Lib "User32" Alias "MessageBoxA" _
       (ByVal hwnd As Long, _
        ByVal lpText As String, _
        ByVal lpCaption As String, _
        ByVal wType As Long) _
     As Long
   Dim CurLine As String
   Dim CurFile As String
   Dim ScoreStatus As String
   Dim DoScoreOvrChange As Boolean
   ' rev 5.4.1   added UseTeamworkmark.   it is set from FairInfo on form open.
   Dim UseTeamworkMark As Boolean


Private Sub btChairList_Click()
   ' Bug.   Text box does not have scroll bar until click on box?
   ' quick sorted list in textbox
  On Error GoTo SubError
  Dim Abcs As String
  Dim Stats As String
  Dim tempEx1 As Recordset
  Dim Instrg As String
  Dim criteriaex As String
  Dim NumExhibits As Integer
  Dim NumInvalid As Integer
  Dim NumForms As Integer
  Dim NumComplete As Integer
  Dim NumIncomplete As Integer
  Dim NoScoresExh As String
  Dim RSWebEx As Recordset
  Dim NoShows As Integer
  Dim cStatus As String
  Dim WebTOC As String    ' rev 5.3.7
  Dim WebState As String
  Dim WebISEF As String
  Dim WebScore As String
  Dim ExhScr As String
  On Error GoTo XedChoice
  Instrg = ""
  If ChairListCat = "" Then
    DoCmd.OpenForm "xCategory Exhibit Ranking Selector", , , , , acDialog
    Instrg = Forms("xCategory Exhibit Ranking Selector").Form.Tag
    DoCmd.Close acForm, "xCategory Exhibit Ranking Selector"
XedChoice:  '  used closed form versus choose ncat
   Else      ' called the chairlist with a cat to list
     Instrg = ChairListCat
     ChairListCat = ""
   End If
   On Error GoTo SubError
'  Msg = ""
'  DoTextBox (ChangedForm)
'  ChangedForm = False
  If Instrg = "" Then
    MsgBox "You Did Not Select a Category"
    Exit Sub
  End If
  Screen.MousePointer = 11
  If Instrg = "ALL" Then
    Screen.MousePointer = 0
    MsgBox "This is not implemented for the display"
    Exit Sub
    msg = "Be patient, this one takes a long time (1-3 Minutes)"
    'Rev 540  added TeamEx
    criteriaex = "SELECT ExhibitData.NCAT as tNCAT, ExhibitData.EXN AS tEXN, ExhibitData.SCORE AS tSCORE, " & _
    "ExhibitData.TeamEx, ExhibitData.NUMJUDGES as tNUMJUDGES, ExhibitData.TO_STATE as tToState, " & _
    "exhscore([EXN]) AS tStatus, IIf([SCORE_OVERRIDE],'*',' ') AS Ovrd " & _
    "FROM ExhibitData ORDER BY ExhibitData.SCORE DESC"
  Else
    msg = "Please wait !" & vbCrLf & " "
    'Rev 540  added TeamEx
    criteriaex = "SELECT ExhibitData.NCAT as tNCAT, ExhibitData.EXN AS tEXN, ExhibitData.SCORE AS tSCORE, " & _
    "ExhibitData.Teamex, ExhibitData.NUMJUDGES as tNUMJUDGES, ExhibitData.TO_STATE as tToState, " & _
    " exhscore([EXN]) AS tStatus, IIf([SCORE_OVERRIDE],'*',' ') AS Ovrd " & _
    "FROM ExhibitData WHERE NCAT = '" & Instrg & "' ORDER BY ExhibitData.SCORE DESC"
  End If
  DoTextBox (ChangedForm) ' false implies than the underlying data of the form has not been changed.
  ChangedForm = False
  btChairList.SetFocus  ' this removes the text select and shows the vert scroll bar..
  Set tempEx1 = CurrentDb().OpenRecordset(criteriaex, dbOpenDynaset)
  Stats = "Category Status for " & Instrg & " "
  ' Get Web site status
    ' rev 5.3.1  Add status of web site final etc for each category
  Dim RSTFairInfo As Recordset
  Dim MyWebdbPath As String
  Dim dbweb As DAO.Database
  Dim rsWebCat As Recordset
  Set RSTFairInfo = CurrentDb.OpenRecordset("SELECT * FROM FairInfo WHERE Fair_Year = " & FairYear())
  MyWebdbPath = RSTFairInfo!WebdbPath
  RSTFairInfo.Close
 '  open remote table
  Set dbweb = DBEngine.OpenDatabase(MyWebdbPath)
  Set rsWebCat = dbweb.OpenRecordset("Select * from NatCategories WHERE NCAT = '" & Instrg & "'")
  Set RSWebEx = dbweb.OpenRecordset("Select * from ExhibitScores Where NCAT = '" & Instrg & "'")
  Dim ChairWebFinal As String
  If rsWebCat!InputFinal = True Then
    If Not IsNull(rsWebCat!LocFinal) Then
      ChairWebFinal = "Web Entries Final and Downloaded! ***"
    Else
      ChairWebFinal = "Web Entries Final - NEEDS DOWNLOAD! ***"
    End If
  End If
  rsWebCat.Close
  ' Get statatistics
  NumForms = 0
  NumInvalid = 0
  NumExhibits = 0
  NumComplete = 0
  NoShows = 0       ' Rev 5.3.1  Number with TO_STATE = "N"
  NoScoresExh = ""
  With tempEx1
  If tempEx1.EOF Then
     tempEx1.Close
     TextBox.SetFocus
     TextBox.Text = "No Exhibits in this Category"
     Screen.MousePointer = 0
     btnDoNothing.SetFocus
     dbweb.Close
     Exit Sub
  End If
  If Not tempEx1.EOF Then
    Do While Not .EOF
      cStatus = !tStatus    ' this loop forces new exhibits
      .MoveNext
    Loop
  End If
   .MoveFirst
   .sort = "tscore DESC"
   .Requery
   NumExhibits = .RecordCount
   ' ------------------  start the report ----------------------------
   'Rev 540  reformat header to show teams 'Tm'
   Abcs = Abcs & vbCrLf & "    T  Loc   Rec Web Web  Rec  "
   Abcs = Abcs & vbCrLf & "EXN m  Scr   TSt TOC Scr  ISEF Status" & vbCrLf
   If Not tempEx1.EOF Then
    Do While Not tempEx1.EOF
      WebTOC = "   "
      WebState = "  "
      WebScore = "      "
      WebISEF = " "
      RSWebEx.FindFirst ("[ExNo] = " & !tEXN)
      If Not RSWebEx.NoMatch Then
        WebTOC = IIf(IsNull(RSWebEx!TOC), "   ", IIf(Len(RSWebEx!TOC) = 3, RSWebEx!TOC, " " & RSWebEx!TOC & " "))
        WebState = IIf(IsNull(RSWebEx!TO_STATE), "  ", IIf(RSWebEx!TO_STATE = "", "  ", RSWebEx!TO_STATE & " "))
        WebScore = Format(RSWebEx!Override, "00.00")
        Do While Len(WebScore) < 7
           WebScore = WebScore & " "
        Loop
        WebISEF = IIf(RSWebEx!TO_ISEF = True, "*", " ")
      End If
      NumForms = NumForms + !tNUMJUDGES
      cStatus = !tStatus 'NOTE  tstatus is a string returned from a call to exhscore([Exn]) function
                         ' which calculates the score for the exhibit and returns other status stuff
      If !tToState = "N" Then
           NoShows = NoShows + 1
      Else
        If Mid(cStatus, 8, 7) = "Invalid" Then
            NumInvalid = NumInvalid + 1
            NoScoresExh = NoScoresExh & !tEXN & " "
        End If
        If Len(cStatus) <= 8 Or Mid(cStatus, 8, 5) = "Final" Then  'Rev 5.3.3  Overide changed to Final
            NumComplete = NumComplete + 1
        End If
      End If
      If Len(Abcs) < 2000 Then
        ' Rev 540  indicate team with a T
        Dim tScorestr As String
        tScorestr = Format(!tScore, "00.00")
        If tScorestr <> "100.00" Then
          tScorestr = " " & tScorestr
        End If
        ExhScr = !tEXN & " " & IIf(!TeamEx = True, "T ", "  ") & tScorestr & !Ovrd
        Do While Len(ExhScr) < 12  ' rev 5.3.7  align for rest of row
            ExhScr = ExhScr & " "
        Loop
        Abcs = Abcs & ExhScr
        Abcs = Abcs & WebState & " " & WebTOC & " " & WebScore & " " & WebISEF
        Abcs = Abcs & " " & IIf(!tToState = "N", "NoShow", Mid(cStatus, 8, Len(cStatus) - 7)) & vbCrLf
      End If
      .MoveNext
    Loop
   NumIncomplete = NumExhibits - NumInvalid - NumComplete
   End If
  End With
  dbweb.Close
  tempEx1.Close
  Stats = Stats & " " & NumExhibits & " Exhibits; " & NoShows & " No Shows; " & _
          NumInvalid & " Not Scored; (" & NoScoresExh & ")" & vbCrLf & _
          NumComplete & " Complete; " & (NumIncomplete - NoShows) & " Incomplete; " & _
          IIf((NumExhibits - NoShows) <= 0, 0, Int(100 * (NumComplete / (NumExhibits - NoShows)))) & _
         "% Complete;  " & ChairWebFinal & vbCrLf
  msg = Stats & Abcs
  If Len(msg) > 2000 Then
    msg = Mid(msg, 1, 1980)
    msg = msg & vbCrLf & "List Too Long, Text Truncated"
  End If
  'Form.Recordset.MoveFirst
  TextBox.FontName = "Courier"  ' this is so the columns line up.
  DoTextBox (ChangedForm) ' false implies than the underlying data of the form has not been changed.
  ChangedForm = False
  TextBox.SetFocus
  TextBox.SelStart = 0
  'btnChairReport.SetFocus
  Screen.MousePointer = 0
  Exit Sub
SubError:
   dbweb.Close  ' rev 546 5.4.6  this cannot happen if error caused by wrong location for SciFairWebData. so
                ' makes a nasty system error.  not good.  Fixed in Form Open
   MsgBox "Error in btChairList_Click(): " & Err.Description
   Screen.MousePointer = 0
End Sub
 
Private Sub btFindForm_Click()
   On Error GoTo SubError
   Dim intCnt As Integer
   Dim strJun As String
   Dim FndJun As Boolean
   FndJun = True
   strJun = InputBox("enter Judge Number or Judge Last Name", "List Judge's Batch Sequence Numbers")
   If strJun = "" Then Exit Sub
   If Asc(Mid(strJun, 1, 1)) < 48 Or Asc(Mid(strJun, 1, 1)) > 58 Then    ' this is a NOT a number
       FndJun = False
   End If
   msg = ""    ' this variable use to hole text box data
   With Scores
     intCnt = 0
     .MoveFirst
     Do While Not .EOF
         If FndJun = True Then
           If !JUN = strJun Then
              msg = msg & "Judge " & !JUN & " " & !FNAME & " " & !LNAME & _
              " Exn: " & !EXN & " Batch-Sequence: " & !BSeq & vbCrLf
              intCnt = intCnt + 1
           End If
         Else
           If !LNAME = strJun Then
              msg = msg & "Judge " & !JUN & " " & !FNAME & " " & !LNAME & _
              " Exn: " & !EXN & " Batch-Sequence: " & !BSeq & vbCrLf
              intCnt = intCnt + 1
           End If
         End If
         .MoveNext
     Loop
'     .Filter = ""
'     .Requery
   End With
   If intCnt = 0 Then msg = "Not Found"
   DoTextBox (ChangedForm)
   ChangedForm = False
   btnImport.SetFocus
   Exit Sub
SubError:
'   Scores.Filter = ""
'   Scores.Requery
   MsgBox "FindForm error: " & Err.Description
End Sub

Private Sub btnAddLateExhibitJudges_Click()
  MsgBox "Use 'xJudge Assignments Form' and " & vbCrLf & _
         "Select the 'Assign New Exhibits' button."
 ' if time, add a call to open the form from here
End Sub

Private Sub btnBuildStuData_Click()
   On Error GoTo ErrorExit
   Dim PreSlug As Recordset
   Dim SQLstr As String
   Dim Cnt As Integer
   Dim fnames As String
   Dim lnames As String
   Dim idval As Long
   Dim FileName As String
   Dim Strfilter As String
   Dim Answ As Integer
   Dim cleantitle As String ' rev 5.4.2
   Dim ii As Integer  ' rev 5.4.2
   ' changed wording no more option to not include exhibit title rev 5.3.7
   Answ = MsgBox("This builds the 'Student Database' file that needs to be imported" & vbCrLf & _
   " into DataLink for each of the Benchmark 3000 scanner stations." & vbCrLf & _
   "Do this only once and ONLY after all late Exhibits are assigned Judges." & vbCrLf & vbCrLf & _
   " The file should be placed in the '..\1_Application_Scoring_Etc\Scoring\'  or " & vbCrLf & _
   "..\App_Data\ Folder on the Same Mapped Drive where SciFairData is located." & vbCrLf & _
   "  (The folder is initially selected for you)    " & vbCrLf & vbCrLf & _
   " DO YOU WANT TO CONTINUE? ", vbYesNo, "Build Student Data?")
   If Answ = vbNo Then Exit Sub
 '  rev 5.3.3     find the location of the data base that is linked  (Categories is a linked table).
   Dim strFullPath As String
   strFullPath = Mid(DBEngine.Workspaces(0).Databases(0).TableDefs("Categories").Connect, 11)
   ' the above returns directory for SciFairData.   I.E.   X:\App_Data\SciFairData.mdb
   Dim i As Integer
   Dim LinkedDataDir As String
   LinkedDataDir = "Not found"
   ' rev 547 5.4.  find the scoredata folder   else  use the App_Data folder   start of add
      Cnt = InStr(1, strFullPath, "App_Data")  ' find location of app_data
      If Cnt > 3 Then    ' should return 4
         LinkedDataDir = Mid(strFullPath, 1, Cnt - 1) & "1_Application_Scoring_Etc\Scoring\"
      Else   ' rev 5.4.7    end of add    keep the next in case someone changes the above folder name.
        For i = Len(strFullPath) To 1 Step -1
        If Mid(strFullPath, i, 1) = "\" Then
            LinkedDataDir = Left(strFullPath, i)
            Exit For
        End If
        Next
     End If   ' rev 5.4.7    added also
Strfilter = ahtAddFilterItem(Strfilter, "CSV Files (*.csv)", "*.csv")
FileName = ahtCommonFileOpenSave( _
           OpenFile:=False, _
           DialogTitle:="Please Save StudentData.csv in " & LinkedDataDir, _
           FileName:="StudentData.csv", _
           InitialDir:=LinkedDataDir, _
           Filter:=Strfilter, _
           Flags:=ahtOFN_OVERWRITEPROMPT Or ahtOFN_READONLY)
If IsNull(FileName) Then GoTo ErrorHandler1
If FileName = "" Then GoTo ErrorHandler1
On Error GoTo ErrorExit   ' This all other errors
'See if file exisits
On Error GoTo NeedNewFile
  Open FileName For Input As #311
  Close #311
  GoTo FileExisits
NeedNewFile:    ' Create an empty file
  Open FileName For Output As #311  ' Should never get here because the dailog creates the file
  Close #311
FileExisits:
   On Error GoTo ErrorExit
   Open FileName For Output As #311
   Print #311, """Student ID""" & "," & """FirstName""" & "," & """LastName""" '   CR/LF add by Print command
   ' format will be
   '  id,  firstname,  lastname
   '     id = ID in query = TEEEEJJJJ where T = 1 for Non-team, 2 for Team, EEEE = Exhibit nu,  JJJJ = Judge number
   '      lastname = Judge last name and Judge Number in a string
   '      firstname = 'Exhibit' & EXN in a string
   '    The above presents the judge name and number and exhibit number in DataLink scanner data.
   ' open the query preslug
   
   SQLstr = "SELECT * from xScoreFormsPreSlug"
   Set PreSlug = CurrentDb().OpenRecordset(SQLstr, , dbOpenDynaset)
   If PreSlug.RecordCount > 0 Then
    With PreSlug
     .MoveFirst
     Do While Not .EOF
       'do the set up work here
       idval = !ID
        '  removed option rev 5.3.7
     '  If Answ = vbNo Then  ' have not installed the modified student database must limit to 25 characters
     '    fnames = Left("EXN " & Format(!EXN, "0000") & IIf(idval > 199999999, " Team", ""), 25)
     '    lnames = Left("JUN " & Format(!JUN, "0000") & " " & !LNAME & ", " & !FNAME, 25)
     '  Else ' have the special database with longer fields - add the exhibit title
     '  rev 5.4.1  changed iif from checking first digit or idval to check team
     '  rev 5.4.2  must check title for quotations and if any, replace with single quote
         cleantitle = !EXHB_TITLE
         For ii = 1 To Len(cleantitle)
           If Mid(cleantitle, ii, 1) = Chr(34) Then
             Mid(cleantitle, ii, 1) = Chr(39)
           End If
         Next ii
         fnames = Left("EXN " & Format(!EXN, "0000") & IIf((!TeamEx Or !TEAM), " Team - ", " -   ") & _
              cleantitle, 100)
         lnames = Left("JUN " & Format(!JUN, "0000") & " " & !LNAME & ", " & !FNAME, 100)
     '  End If
       ' write !ID, fanmes, lnames
      fnames = """" & idval & """" & "," & """" & fnames & """" & "," & """" & lnames & """"
      Print #311, fnames   ' this prints the CR/LF
      Cnt = Cnt + 1
      .MoveNext
     Loop
     .Close
    End With
   Else
     MsgBox "There are no assigned judge records from query xScoreFormsPreSlug"
     Close #311
     Exit Sub
   End If
  ' MsgBox "Count = " & Cnt
   Close #311
   MsgBox Cnt & " records written! (One for each score card.)" & vbCrLf & _
                "If this is a new Student Database File " & vbCrLf & _
                "Import it into DataLink Now - as follows:" & vbCrLf & _
                " In DataLink: " & vbCrLf & _
                " 1. Click the Student Database icon. " & vbCrLf & _
                " 2. Select and delete all records." & vbCrLf & _
                "     * Select (click) first record. " & vbCrLf & _
                "     * Scroll to last record. " & vbCrLf & _
                "     * Hold Shift and click last record.     " & vbCrLf & _
                "     * Click the red X (Delete Button)" & vbCrLf & _
                "   Newer Versions - Click the Delete Student Database Icon" & vbCrLf & _
                " 3. Click 'Import Students Wizard' " & vbCrLf & _
                "  * follow the dialog steps!     " & vbCrLf & _
                "    Be sure to select the same file you just created!" & vbCrLf & _
                "               "

   Exit Sub
ErrorHandler1:
   MsgBox "Canceled"
   Close #311
   Exit Sub
ErrorExit:

   Close #311
   MsgBox "Error: Build Student Data " & Err.Description
End Sub

Private Sub btnChairReport_Click()
  Dim CatRS As Recordset
  On Error GoTo SubError
  'MsgBox "Use xCategory Exhibit Ranking Report"
  
 ''  Added rev 5.2.4  so 'all' does every category report
  Dim Instrg As String
  On Error GoTo XedChoice
  Instrg = ""
  If ChairReportCat = "" Then
    DoCmd.OpenForm "xCategory Exhibit Ranking Selector", , , , , acDialog
    Instrg = Forms("xCategory Exhibit Ranking Selector").Form.Tag
    DoCmd.Close acForm, "xCategory Exhibit Ranking Selector"
XedChoice:  '  used closed form versus choose ncat
   Else      ' called the chairlist with a cat to list
     Instrg = ChairReportCat
     ChairReportCat = ""
   End If
   On Error GoTo SubError
   If Instrg = "" Then
      MsgBox "You did not select a category"
      Exit Sub
   End If
   If Instrg <> "All" Then
       Tag = Instrg    ' sets a tag associated with this form
     '  The next line was the pre rev 5.2.4 call when the Ranking Selector was called from within the report.
      DoCmd.OpenReport "xCategory TOC & Ranking Report"
      Tag = ""  'Rev 5.3.1
   Else
      ' Print all of the reports one after another
      If MsgBox("Print ALL of the Individual Category Reports?", vbYesNo + vbDefaultButton1, _
               "Print All Category Reports") = vbNo Then
         Exit Sub
      Else
        Set CatRS = CurrentDb().OpenRecordset("Categories", dbOpenDynaset)
        With CatRS
        .MoveFirst
        Do While Not .EOF
          Scores.MoveFirst
          Scores.FindFirst ("ExhibitData.NCAT = '" & !NCAT & "'")
          If Scores.NoMatch = False Then
             Tag = !NCAT
             DoCmd.OpenReport "xCategory TOC & Ranking Report"  'Rev 543 5.4.3  Fixed - was wrong report name
          Else
             ' Do Not call the report file if there are no exhbitits in any category
          End If
          .MoveNext
        Loop
        .Close
        End With
      End If
      Tag = ""  ' Rev 5.3.1   prevents report from using the old tag if report run manually
   End If
  Exit Sub
SubError:

  If Err.Number <> 2501 Then  ' No error message if report fails
     MsgBox "Chair Category Print Request Error: " & Err.Description
  End If
End Sub

Private Sub ClearAllOvr()
  On Error GoTo SubError
  Dim Instrg1 As String
  Dim tempExh1 As Recordset
  Dim Criter As String
  Dim dbweb As DAO.Database
  Dim MyWebdbPath  As String
  Criter = "SELECT ExhibitData.EXN, ExhibitData.NCAT, ExhibitData.SCORE_OVERRIDE " & _
           " FROM ExhibitData"      ' ORDER BY ExhibitData.SCORE DESC"
  Set tempExh1 = CurrentDb().OpenRecordset(Criter, dbOpenDynaset)
  With tempExh1
  Screen.MousePointer = 11
     .MoveFirst
     Do While Not .EOF
        If !SCORE_OVERRIDE = True Then
          .Edit
           !SCORE_OVERRIDE = False
          .Update
          ExhScore (!EXN)    '   recalculate the score
        End If
   ' these fields removed rev 5.3.7
   '     .Edit
   '     !WebTo_State = Null
   '     !WebTo_ISEF = Null
   '     .Update
       .MoveNext
     Loop
   .Close
   End With
   '  Need to clear the flags in Categories and in website NatCategories so chair can make changes and
   '    so another download can occur.
   Set tempExh1 = CurrentDb().OpenRecordset("Select * From Categories", dbOpenDynaset)
   With tempExh1
     Dim t As String
     t = !NCAT
     .MoveFirst
     Do While Not .EOF
       .Edit
       !LocFinal = Null  ' This will allow another download from the web or re-do overrides locally without messages
       .Update
       .MoveNext
     Loop
     .Close
   End With
   '  open the NatCategories Table on the web site
   ' clear most of the flags but LEAVE FinalInput set so can download again if need to.
   Set tempExh1 = CurrentDb().OpenRecordset("SELECT * FROM FairInfo WHERE Fair_Year = " & FairYear())
   MyWebdbPath = tempExh1!WebdbPath
   Set dbweb = DBEngine.OpenDatabase(MyWebdbPath)
   Set tempExh1 = dbweb.OpenRecordset("Select * from NatCategories", dbOpenDynaset)  ' Get all fields for this category
   tempExh1.MoveFirst
   Do While Not tempExh1.EOF
     tempExh1.Edit
     tempExh1!LastDld = Null  ' this will indicate that NO download has been done.
     tempExh1!LocFinal = Null ' This will unlock the website for changes
     tempExh1.Update
     tempExh1.MoveNext
   Loop
   tempExh1.Close
   dbweb.Close
   SCORE.Requery
   Form.Refresh ' Update the form from the altered data tables
   ChangedForm = True  ' assume changed so text dotextbox does not create error
   Screen.MousePointer = 0
  ' MsgBox "All Finals for ALL Categories have been CLEARED!"
   Exit Sub
SubError:
     Screen.MousePointer = 0
     MsgBox "Error in ClearALLOvr: " & Err.Description
   
End Sub

Private Sub btnClearScores_Click()
  Dim HoldFilter As String
  On Error GoTo SubError
  If MsgBox("Clears To_State Status, ALL Scores, Final Scores, Web Site Scores and Score Status Information!" & vbCrLf & _
  " ARE YOU SURE?", vbYesNo + vbDefaultButton2, "Clear ALL Score Data") = vbNo Then
    Exit Sub
  End If
 
  ' Rev 5.4.6   will clear the To_State = N fields (the no shows) because are going to enter later anyway.
  If MsgBox("LAST WARNING!  Are you sure? This will do the following:" & vbCrLf & _
   "Clears SCORE, SCORE_OVERRIDE, TO_STATE (Y, N or A), TOC in ExhibitsData Table (No Shows Removed)!" & vbCrLf & _
   "Clears score marks (CR1, CR2, ETC. and NTR (number times read) in ExhibitJudges Table " & vbCrLf & _
   "Clears the final ranking status (LocFinal) in the Categories Table. " & vbCrLf & _
   "IN Short PREPARES the application to start the scoreing process! " & vbCrLf & _
   "YOU MAY WANT TO BACKUP SciFairData data base file FIRST!" & vbCrLf & vbCrLf & _
   " CONTINUE WITH CLEAR?", vbYesNo + vbDefaultButton2, "Clear ALL Score Data") = vbNo Then
    Exit Sub
  End If
  EnableButtons (False)
  Screen.MousePointer = 11
  ' note rev 5.4.6  546   Moved this after Enable Buttons (False) so it works.
  
   With Scores  '  moved this to after the If MsgBox...
  
    ' .Filter = ""  ' not required since I never do filter on SCORES
    ' .Requery
     .MoveFirst
     Do While Not .EOF
        .Edit
       '  Rev 5.4.6  546   I will always remove the No Shows because instructions say to enter after this
       '     process anyway.
       ' If Not IsNull(!TO_STATE) Then  'Rev 546 5.4.6 note only: this does not clear the N for now show??
       '   If !TO_STATE <> "N" Then
            !TO_STATE = Null
       '   End If
       ' End If
     '   !WebTo_State = Null  'Rev 5.3.3   removed rev 5.3.7
     '   !WebTo_ISEF = Null   ' 5.3.3      removed rev 5.3.7
     'Rev 5.4.8DES  548DES
        !LocFinal = Null    ' 5.3.3 In Categories Table Clears the single entry for each category many times
        !CR1 = 0  ' 0 is default when add a record
        !CR2 = 0  ' This was SR2 so changed to CR2  5.5.0  550 DES
        !CR3 = 0
        !CR4 = 0
        !CR5 = 0
        !CR6 = 0
        !NTR = 0
        !SCORE = Null   ' 0 is default when add a record
        !SCORE_OVERRIDE = False
        !BSeq = ""   ' DES 4.0.4
        !TOC = ""    '  DES  Rev 5.4.6   546   TOC gets downloaded from web
         .Update
        .MoveNext
     Loop
   '.Filter = HoldFilter
   End With
   Form.Refresh ' Update the form from the altered data tables
   Screen.MousePointer = 0
  
   ' Rev 5.3.3
   MsgBox "All Local Scores and related entries have been cleared! " & vbCrLf & _
           "Next, you must clear the exhibit scores data on the website!" & vbCrLf & _
          "Click the [Clear + Reset Web Exhibit Scores] button on the 'xWebsite Sync' form displayed next."
   ChangedForm = True  ' assume changed so text dotextbox does not create error
   DoCmd.Close acForm, "xWebsite Sync"  ' In case it it already open need to close so all works as expected
   DoCmd.OpenForm "xWebSite Sync", , , , , acDialog, OpenArgs:="CLWS"       ' or acWindowNormal
   EnableButtons (True)
   '  do this in xwebsitesync MsgBox "Done!"
   Me.Requery

   Scores.Requery
   Exit Sub
SubError:
     EnableButtons (True)
     Screen.MousePointer = 0
     MsgBox "Error in ClearScores: " & Err.Description
End Sub

Private Sub btnClearText_Click()
   msg = ""
   DoTextBox (ChangedForm)
   ChangedForm = False
   btChairList.SetFocus
End Sub

Private Sub btnClrOverridesOneCat_Click()
  On Error GoTo SubError
  Dim Instrg1 As String
  Dim tempExh1 As Recordset
  Dim Criter As String
  Dim dbweb As DAO.Database
  Dim MyWebdbPath  As String
  On Error GoTo XedChoice
  Instrg1 = ""
  '  -------------------- first select the category  (all not allowed) ----------
  DoCmd.OpenForm "xCategory Exhibit Ranking Selector", , , , , acDialog
  Instrg1 = Forms("xCategory Exhibit Ranking Selector").Form.Tag
  DoCmd.Close acForm, "xCategory Exhibit Ranking Selector"
XedChoice: '  user closed form versus choose ncat
  On Error GoTo SubError
  If Instrg1 = "" Then
    MsgBox "You Did Not Select a Category"
    Exit Sub
  End If
  If Instrg1 = "all" Then
    If MsgBox("Clear ALL CATEGORY Finals!" & vbCrLf & _
     "Clears ALL CATEGORIES 'Local' Final Scores (overrides) and Category 'Final' flags ('Local' and 'Web')" & vbCrLf & _
     " This does NOT clear the website 'Final Scores' entries - It just allows edits. " & vbCrLf & _
     "You will need to DOWNLOAD ALL categories after the web edits are complete and ALL are marked Final again!" & vbCrLf & _
     " ARE YOU SURE?", vbYesNo + vbDefaultButton2, "Clear ALL Category Finals ") = vbNo Then
     Exit Sub
    End If
    If MsgBox("LAST WARNING! Clear Finals 'ALL CATEGORIES'! Are you sure? " & vbCrLf & _
           "Clears All ExhibitsData table Final Scores (Score_Override) and " & vbCrLf & _
            "Clears All Categories table LocFinal fields. " & vbCrLf & _
            "Clears All Website NatCategories table lstdld and LocFinal fields. " & vbCrLf & _
            "Later, you will have to [Download Web Final Scores] or [Enter Final Scores Local] For ALL Categories!" & vbCrLf & _
            "CLEAR ALL CATEGORIES' FINALS?", vbYesNo + vbDefaultButton2, "Clear ALL Category Finals") = vbNo Then
      Exit Sub
    End If
    ' note only rev 543 5.4.3  ClearAllOver does exactly the same as the code below for one category execept it
    '                          does it for all categories.  It allows edits
    Call ClearAllOvr       ' button deleted  this is only way to get to that routine
    Scores.Requery
    Me.Requery
    MsgBox "All 'Local' Final Scores and Flags Cleared! " & vbCrLf & _
           " All Website Categores can now be edited." & vbCrLf & _
           "You MUST AGAIN 'Download All categories From the website!"
   ' Forgot to remove these last revision so.. do it now
   ' Rev 543  5.4.3  No need to do thes as we do NOT want to delete the final score entries on the website. just allow edits.
   ' DoCmd.Close acForm, "xWebsite Sync"  ' In case it it already open need to close so all works as expected
   ' DoCmd.OpenForm "xWebSite Sync", , , , , acDialog, OpenArgs:="ULSF" & Instrg1 ' or acWindowNormal
   ' DoCmd.Close acForm, "xWebsite Sync"
    Scores.Requery
    Me.Requery
    Exit Sub
  End If
 '  comes here for one category ---------------------------------------------
  Dim Testmsgbox As String
  '  rev 5.4.6  546  cleaned up the messages to be more user friendly
  Testmsgbox = MsgBox("Clear Category " & Instrg1 & " Finals!" & vbCrLf & _
  "This Removes the downloaded Final results and allows further edits on the website." & vbCrLf & _
  "  (The currnet website entries are not changed) " & vbCrLf & _
  "You will need to [Download WebSite Final Entries] again after the web edits are Final!" & vbCrLf & vbCrLf & _
  " DO YOU WANT MORE INFORMATION?", vbYesNoCancel + vbDefaultButton2, "Clear Category Finals ")
  If Testmsgbox = vbCancel Then
    MsgBox "Canceled - Nothing Done!"
    Exit Sub
  Else
      If Testmsgbox = vbYes Then
        If MsgBox("DETAILS!  Are you sure? For " & Instrg1 & ":" & vbCrLf & _
            "Clears Local ExhibitsData table Final Scores (Score_Overrides)" & vbCrLf & _
            "Clears Local Categories table LocFinal field. " & vbCrLf & _
            "Clears Website NatCategories table InputFinal, LstDld and LocFinal fields. " & vbCrLf & _
            " This does NOT clear the website final scores entries - It just allows edits. " & vbCrLf & _
            "Later, You will need to [Download Web Final Scores] or [Enter Final Scores Local]" & vbCrLf & _
            "CLEAR CATEGORY " & Instrg1 & " FINALS?", vbYesNo + vbDefaultButton2, "Clear Category Finals") = vbNo Then
         Exit Sub
        End If
      End If
  End If
  ' rev 5.4.6 546  added TOC to clear
  Criter = "SELECT ExhibitData.TOC, ExhibitData.EXN, ExhibitData.NCAT, ExhibitData.SCORE_OVERRIDE " & _
           "FROM ExhibitData WHERE ExhibitData.NCAT = '" & Instrg1 & _
           "'"      ' ORDER BY ExhibitData.SCORE DESC"
  Set tempExh1 = CurrentDb().OpenRecordset(Criter, dbOpenDynaset)
  With tempExh1
  Screen.MousePointer = 11
     .MoveFirst
     Do While Not .EOF
        .Edit
        If !SCORE_OVERRIDE = True Then
           !SCORE_OVERRIDE = False
          ExhScore (!EXN)    '   recalculate the score
        End If
        !TOC = Null   ' rev 5.4.6  546
        .Update
      ' These fields to be removed rev 5.3.7
      '  .Edit
      '  !WebTo_State = Null
      '  !WebTo_ISEF = Null
      '  .Update
       .MoveNext
     Loop
   .Close
   End With
   '  Need to clear the flags in Categories and in website NatCategories so chair can make changes and
   '    so another download can occur.
   Set tempExh1 = CurrentDb().OpenRecordset("Select * From Categories where Categories.NCAT = '" & _
              Instrg1 & "'", dbOpenDynaset)
   With tempExh1
     Dim t As String
     t = !NCAT
     .Edit
     !LocFinal = Null  ' This will allow another download from the web or re-do overrides locally
     .Update
     .Close
   End With
   '  open the NatCategories Table on the web site
   
   Set tempExh1 = CurrentDb().OpenRecordset("SELECT * FROM FairInfo WHERE Fair_Year = " & FairYear())
   MyWebdbPath = tempExh1!WebdbPath
   Set dbweb = DBEngine.OpenDatabase(MyWebdbPath)
   Set tempExh1 = dbweb.OpenRecordset("Select * from NatCategories where NatCategories.NCAT = '" & _
              Instrg1 & "'", dbOpenDynaset)  ' Get all fields for this category
   tempExh1.Edit
   tempExh1!LastDld = Null  ' this will indicate that NO download has been done.
   tempExh1!LocFinal = Null ' this will unlock the website.
   tempExh1!InputFinal = Null  'rev 5.4.6  546 This forces Chair to make final again and prevents
                                ' a download until chair does so.
   tempExh1.Update
   tempExh1.Close
   dbweb.Close
   SCORE.Requery
   Form.Refresh ' Update the form from the altered data tables
   ChangedForm = True  ' assume changed so text dotextbox does not create error
   Screen.MousePointer = 0
   'MsgBox "Finals for " & Instrg1 & " have been CLEARED! "
   ' Scores.Requery
   ' Me.Requery
    MsgBox Instrg1 & " Final Scores and Flags Cleared!" & vbCrLf & _
           "Note: Website Final scores and other selections have NOT been changed!"
  '  rev 5.3.7  no need to upload scores again.  we just cleared the local stuff. - waiting for re-download
    
  '  DoCmd.Close acForm, "xWebsite Sync"  ' In case it it already open need to close so all works as expected
  '  DoCmd.OpenForm "xWebSite Sync", , , , , acDialog, OpenArgs:="ULSF" & Instrg1 ' or acWindowNormal
    Scores.Requery
    Me.Requery
    Exit Sub
SubError:
     Screen.MousePointer = 0
     MsgBox "Error in btnClrOverridesOneCat: " & Err.Description
End Sub



Private Sub btnEnterExhibitRanking_Click()
'   Button made not visible rev 5.3.3
 Exit Sub
 On Error GoTo SubError
 Dim Instrg As String
 Dim DidFirst As Boolean
 Dim DidLast As Boolean
 Dim FirstScore As Double  ' the score of the first ranked exhibit
 Dim LastScore As Double   ' the score of the last ranked exhibit
' Dim LastChgdScore As Double ' Exhibits with scores less than this never get score changes
 Dim nFirstScore As Double  ' the top avail next score
 Dim nLastScore As Double   ' the last avail next score
 Dim ChgCount As Integer
 Dim tExh As Integer
 Dim tempEx1 As Recordset
 Dim criteria
 Dim NumExhs As Integer
 Dim ChgExhs() As Integer
 Dim ChgScrs() As Double
 Dim Prompt As String
 Dim Catnam As String
 Dim RIncrement As Double
 Dim Answer
 Dim tii As Integer
 Dim tij As Integer
 Dim MoveDnCount As Integer
 Dim MoveDnIncrement As Double
 Dim tScore As Double
 Dim RestCnt As Integer
 Answer = MsgBox("CHANGE 'EXHIBIT RANKING' for a SELECTED CATEGORY (Scores Calulated)" & vbCrLf & _
  "IMPORTANT: Using this process will cause loss of important relative score" & vbCrLf & _
  "    differences between exhibits! Read the documentation before you use this process!" & vbCrLf & _
  " ** IF you can quickly determine score overrides to produce the desired ranking " & vbCrLf & _
  "    DO NOT USE THIS PROCESS - INSTEAD 'ENTER SCORE OVERRIDES' " & vbCrLf & _
  " ** IMPORTANT: Understand the process and plan carefully to produce valid results!" & vbCrLf & _
  " " & vbCrLf & _
  "DO YOU WANT INSTRUCTIONS (listed in the text box)?", vbYesNoCancel + vbDefaultButton2, " ")
  If Answer = vbCancel Then
    MsgBox "Operation Canceled"
    Exit Sub
  End If
  If Answer = vbYes Then
  msg = "--- Instructions and notes for 'Enter Exhibit Ranking' --- " & vbCrLf & _
  "IMPORTANT: Using this process will cause loss of important relative score" & vbCrLf & _
  "    differences between exhibits! Read this documentation before you use this process!" & vbCrLf & _
  " ** IF you can quickly determine score overrides to produce the desired ranking " & vbCrLf & _
  "    DO NOT USE THIS PROCESS - INSTEAD 'ENTER SCORE OVERRIDES' " & vbCrLf & _
  " ** IMPORTANT: Understand the process and plan carefully to produce valid results!" & vbCrLf & _
  "NOTE1: If the currently top ranked exhibits are in the correct ranked order at this time," & vbCrLf & _
  "      do not include them in your entries. Start with the first exhibit NOT ranked as desired! " & vbCrLf & _
  "NOTE2: Starts with current scores & current Overrides! To start fresh, clear overrides for this Category!" & vbCrLf & _
  " 1. Plan a score range and a list of exhibits you want to force into that score range." & vbCrLf & _
  "    (Do not include the top ranked exhibits if their scores do not need changes.)" & vbCrLf & _
  " 2. Enter the 'first score' and 'last score' to be applied to the exhibit list you will enter next." & vbCrLf & _
  " 3. Enter (in rank order - high to low ) exhibit numbers to force into the score range entered." & vbCrLf & _
  " The following calculations and actions are performed: " & vbCrLf & _
  " 4. Exhibits whose scores are higher than 'first score' are not be changed - They remain the top ranked exhibits." & vbCrLf & _
  "    (This is why you do not include the top ranked exibits that do not need score changes.)" & vbCrLf & _
  " 5. The first entered exhibit gets 'first score', the last entered gets 'last score'" & vbCrLf & _
  "    and all the others will get scores spread evenly in the range 'first score' to 'last score'." & vbCrLf & _
  " 6. Exhibits 'not in the entered rank list' but whose current scores ARE in the range 'first score' to 'last score'" & vbCrLf & _
  "    will have their scores lowered and spread evenly between 'last score' and the score" & vbCrLf & _
  "    of the first exhibit 'not in the entered rank list' with a score lower than 'last score'. " & vbCrLf & _
  " 7. Score Override will be set for each changed score."
  DoTextBox (ChangedForm)
  ChangedForm = False
  btnEnterExhibitRanking.SetFocus
  End If
  'MsgBox "Not Implemented. I need a Math PHD to figure this out!"\
  ' exit sub
  On Error GoTo XedChoice
  Instrg = ""
  '  -------------------- first selete the category  (all not allowed) ----------
  DoCmd.OpenForm "xCategory Exhibit Ranking Selector", , , , , acDialog
  Instrg = Forms("xCategory Exhibit Ranking Selector").Form.Tag
  DoCmd.Close acForm, "xCategory Exhibit Ranking Selector"
XedChoice: '  user closed form versus choose ncat
  On Error GoTo SubError
'  Msg = ""
'  DoTextBox (ChangedForm)
'  ChangedForm = False
  If Instrg = "" Then
    MsgBox "You Did Not Select a Category"
    Exit Sub
  End If
  If Instrg = "ALL" Then
    MsgBox "You Can Not Rank 'ALL' Exhibits, Select a Category"
    Exit Sub
  End If
  Catnam = Instrg
  Screen.MousePointer = 11
  ' ------------------------- get just this category into a record set
  Dim Criter As String
  Criter = "SELECT ExhibitData.EXN, ExhibitData.NCAT, ExhibitData.SCORE_OVERRIDE, ExhibitData.SCORE, " & _
           "exhscore([EXN]) AS tSTATUS FROM ExhibitData WHERE ExhibitData.NCAT = '" & Catnam & _
           "' ORDER BY ExhibitData.SCORE DESC"
           
  Set tempEx1 = CurrentDb().OpenRecordset(Criter, dbOpenDynaset)
  With tempEx1
     .MoveFirst
     .MoveLast
     NumExhs = .RecordCount
  End With
  Screen.MousePointer = 0
    '  ------------ Get the desired score of top ranked and last ranked Exhibits---------
AgainFScore:
  Instrg = InputBox("Enter the Desired Score for the First Exhibit in your list." & vbCrLf & _
                    "Or [Cancel] to Abort this process", _
                    "Exhibit Ranking First Score Input " & Catnam, 0)
   If Instrg = "" Then
       tempEx1.Close
       Exit Sub
   End If
   FirstScore = Instrg
   If FirstScore = 0 Or FirstScore > 100 Then
     MsgBox "Out of Range"
     GoTo AgainFScore
   End If
AgainLScore:
  Instrg = InputBox("Enter the Desired Score for the Last Exhibit in your list." & vbCrLf & _
                    "Or [Cancel] to Abort this process", _
                    "Exhibit Ranking Last Score Input " & Catnam, 0)
   If Instrg = "" Then
       tempEx1.Close
       Exit Sub
   End If
   LastScore = Instrg
   If LastScore = 0 Or LastScore >= FirstScore Then
     MsgBox "Out of Range, Must be less than First Score"
     GoTo AgainLScore
   End If
  '  First,--------get all the entered exhibits in order 1,2,3,4,5 where first entered  = 1------------
  ReDim ChgExhs(NumExhs + 10) As Integer
  ReDim ChgScrs(NumExhs + 10)
  ChgCount = 1
  Do
    If ChgCount = 1 Then
      Prompt = "Enter the FIRST Exhibit Number " & vbCrLf & "(Assigned the highest Score of your score range.)" & vbCrLf
    Else
      Prompt = "Enter NEXT Exhibit Number (#" & ChgCount & " in your list)" & vbCrLf & "(Assigned the next lower score in you score range.)" & vbCrLf
    End If
    Prompt = Prompt & "Enter '0' or Click [Cancel] to END YOUR LIST (Stop Entry)"
GetAgain:
    Instrg = InputBox(Prompt, "Exhibit Ranking Exhibit List Input " & Catnam, 0)
    If Instrg = "0" Or Instrg = "" Then Exit Do
    With tempEx1
      .FindFirst ("EXN = " & Instrg)
      If .NoMatch Then
           MsgBox "Exhibit Not In " & Catnam & " Category"
           GoTo GetAgain
      End If
      ChgExhs(ChgCount) = !EXN
    End With
    ChgCount = ChgCount + 1
  Loop
  ' reset to actual count
  ChgCount = ChgCount - 1
  If ChgCount <= 0 Then
    MsgBox "No Exhibits Entered. No Action"
    tempEx1.Close
    Exit Sub
  End If
  '  ---------------- Set the scores for those in rank list --------------
  Screen.MousePointer = 11
   'RIncrement = first - last/count - 1
   ' e1 score = topscore, e2 score  = topscore - RIncrement  ...  elast score = LastScore
  If ChgCount = 1 Then
    RIncrement = 0.01
  Else
    RIncrement = (FirstScore - LastScore) / (ChgCount - 1)  ' represents even spread
  End If
  nFirstScore = FirstScore
  'For tii = 1 To ChgCount - 1
  If ChgCount = 1 Then
    ChgScrs(1) = nFirstScore
    nFirstScore = nFirstScore - RIncrement
  Else
    For tii = 1 To ChgCount - 1
     ChgScrs(tii) = nFirstScore
     nFirstScore = nFirstScore - RIncrement
    Next
    ChgScrs(ChgCount) = LastScore
  End If
 ' --------- FIND OUT HOW MANY NEED TO BE MOVED DOWN OUTOF THE ENTERED SCORE RANGE
 ' --------- and ALSO find the first unlisted exhibit with a score less than LastScore
 ' IMPORTANT,  tempEx1 must be sorted by score descending for this to work
  MoveDnCount = 0
  nLastScore = 0
  With tempEx1
    .MoveFirst
    Do While Not .EOF
      For tii = 1 To ChgCount  ' see if in current list (i.e. not move down)
        If ChgExhs(tii) = !EXN Then GoTo InTheList ' This one is in the entered list so do not check for nextlowscore
             ' and do not check if one to movedown
      Next
      ' ---- OK exhibit is not in the list to be rescored in the range firstscore to lastscore so
      '  CHECK if needs moved and or if is first with lowerscore than lastscore
      tScore = IIf(IsNull(!SCORE), 0, !SCORE)
      If tScore <= FirstScore And tScore >= LastScore Then  ' NOT in LIST, but Score in list range (move down)
           MoveDnCount = MoveDnCount + 1
      End If
      If tScore <= LastScore - 1# Then  ' This one is not in the list and has a score < (lastScore-1)
            nLastScore = tScore   ' GOT THE NEXT ONE DOWN WITH SCORE < Last Score - 1
            ' and, since scores are below lastscore, we have counted all that need to be moved down, so
            Exit Do
      End If
      If tScore <= LastScore And tScore > LastScore - 1# Then   ' User did not plan well
          Screen.MousePointer = 0
          MsgBox "Exhibit " & !EXN & " Score " & tScore & " is equal to or less than 1 from your entered 'Last Score'" & vbCrLf & _
                 "There are not enough 'available scores' to assign exhibits requiring lower scores" & vbCrLf & _
                 "Sorry, I can not continue! Suggest you increase the value of your 'Last Score' by 1."
          Screen.MousePointer = 0
          btnEnterExhibitRanking.SetFocus
         .Close
          Exit Sub
      End If
InTheList:
      .MoveNext
    Loop
 ' ---------  Calculate the increment for the exhibits moved down out of range
  If nLastScore = 0 Then
    MsgBox "No exibit found with a score less than Last Score of your list" & vbCrLf & _
           " Sorry, I can not continue - Process Aborted"
           btnEnterExhibitRanking.SetFocus
           .Close
           Screen.MousePointer = 0
           Exit Sub
  End If
  MoveDnIncrement = 0.01
  If MoveDnCount > 0 Then
     MoveDnIncrement = (LastScore - nLastScore) / (MoveDnCount + 1)
  End If
   '  --- add the MOVE Downs to the list of changes
  .MoveLast
  .MoveFirst
   RestCnt = 1
   nFirstScore = LastScore - MoveDnIncrement
   Do While Not .EOF
     For tii = 1 To ChgCount
       If !EXN = ChgExhs(tii) Then GoTo SkipThis  ' already added to change list so don do again
     Next
     ' this EXN not yet rescored so do it now
     tScore = IIf(IsNull(!SCORE), 0, !SCORE)
     If tScore >= LastScore And tScore <= FirstScore Then  'not in list but in score range
       'must move score down so add it to the changed list
       ChgCount = ChgCount + 1
       ChgExhs(ChgCount) = !EXN
       ChgScrs(ChgCount) = nFirstScore
       nFirstScore = nFirstScore - MoveDnIncrement
     Else  ' not in list and score NOT in range
       If tScore < LastScore Then  ' Do not add unchanged if score higher than FirstScore but add to bottom of list for listing only
         ChgExhs(ChgCount + RestCnt) = !EXN
         ChgScrs(ChgCount + RestCnt) = tScore
         RestCnt = RestCnt + 1
       End If
     End If
SkipThis:
     .MoveNext
   Loop
   RestCnt = RestCnt - 1  ' reset to actual count of exhibits without changes
   '  ---at this point chgexhs and chgscrs have all the exhibits that require a score change
   '  in locations 1 to ChgCount
   ' From location ChgCount +1 to Chgcount+1 + RestCnt  are all the rest (no changes)
   ' Top ranked exhibits without score changes are not in ChgExhs()
   ' ------------------  view the changes for verification -------
   msg = "New Ranking Results " & vbCrLf & _
         "EXN   Score  Changed" & vbCrLf
   tii = 0
   .MoveFirst
   '  ------ get those with scores higer than firstscore that will not change
   Do While Not .EOF
      If !SCORE > FirstScore Then
        For tij = 1 To ChgCount
          If !EXN = ChgExhs(tij) Then GoTo DoNotList  ' This one will change, do not list it
        Next
        tii = tii + 1
        msg = msg & !EXN & "  " & Format(!SCORE, " 00.00") & vbCrLf
      Else
        Exit Do
      End If
DoNotList:
      .MoveNext
   Loop
   If tii = 0 Then
   '  Msg = ""   '  for get this - there were no exhibits with scores > FirstScore and not in list
   End If
  ' Msg = Msg & "Exhibits with Changed Scores " & vbCrLf
   For tii = 1 To ChgCount
     msg = msg & ChgExhs(tii) & "  " & Format(ChgScrs(tii), " 00.00") & "   ***" & vbCrLf
   Next
  ' Msg = Msg & "Exhibits with No Changes" & vbCrLf
   For tii = ChgCount + 1 To ChgCount + RestCnt
     msg = msg & ChgExhs(tii) & "  " & Format(ChgScrs(tii), " 00.00") & vbCrLf
   Next
   DoTextBox (ChangedForm)
   ChangedForm = False
   Form.Refresh
   Screen.MousePointer = 0
   If MsgBox("Do you want to accept the Changed Ranking?", vbYesNo + vbDefaultButton2, "Exhibit Ranking Verification") _
             = vbNo Then
       btnEnterExhibitRanking.SetFocus
       .Close
       Exit Sub
   End If
   ' ----------------if OK, then write the changes ----------------
   Screen.MousePointer = 11
   For tii = 1 To ChgCount
     .FindFirst "EXN = " & ChgExhs(tii)
     If .NoMatch Then
        MsgBox "Code error in BtnEnterExhibitRanking - Exhibit in list not found in list"
        btnEnterExhibitRanking.SetFocus
        Screen.MousePointer = 0
        .Close
        Exit Sub
     End If
     .Edit
     !SCORE = ChgScrs(tii)
     !SCORE_OVERRIDE = True
     .Update
     ChangedForm = True
   Next
  End With
  tempEx1.Close
  Screen.MousePointer = 0
  ChairListCat = Catnam
  btnEnterExhibitRanking.SetFocus
  Call btChairList_Click
  Exit Sub
SubError:
  MsgBox "Error in btnEnterExhibitRanking_Click(): " & Err.Description
  Screen.MousePointer = 0
End Sub
'Private Function GetExhNu(RankNum As Integer) As Integer
'  ' gets a number from inputbox, checks that is a good exhibit.
'  ' if good returns the exhibit number, if not returns -1
'  ' if operator says stop, the returns 0
'  Dim Instrg As String
'  Dim Prompt As String
'  If RankNum = 1 Then
'  Prompt = "Enter the TOP RANKED (#1) Exhibit Number"
'  Else
'  Prompt = "Enter the Exhibit Number with Rank = " & RankNum & vbCrLf
'  End If
'  Prompt = Prompt & "Enter 0 or Click 'Cancel' to Stop Entry"
'GetAgain:
'  Instrg = InputBox(Prompt, "Exhibit Ranking Input", 0)
'  If Instrg = "0" Or Instrg = "" Then GetExhNu = 0: Exit Function
'  With Scores
'    .FindFirst ("EXN = " & Instrg)
'    If .NoMatch Then
'      MsgBox "No Such Exhibit"
'      GetExhNu = -1
'      GoTo GetAgain
'    Else
'      GetExhNu = Instrg
'      Exit Function
'    End If
'  End With
'  Exit Function
'FuncError:
'  MsgBox "Error in Function GetExhNu() : " & Err.Description
'  GetExhNu = -1
'  Exit Function
'End Function

Private Sub btnPrint_Click()
   MsgBox "Sorry, Not Implemented. Use a Pencil and make a note of what you need."

   
End Sub

Private Sub btnNoShows_Click()
'  Sets the TO_STATE values in Exhibits data to 'N'
' open Exhibits Table
 ' input an exhibit number or "" to end or cancel
 'find first
   'update TO_State - 'N'
 On Error GoTo SubError
 Dim noShowEx As String
 Dim Last As String
 Dim Exnum As Integer
 Dim rsExh As Recordset
 ' rev 5.4.3. 543   Find if have any no-shows at this time  (usually not) If so, list and give instructions
 Set rsExh = CurrentDb().OpenRecordset("Select * from ExhibitData WHERE TO_STATE = 'N' ORDER by EXN", dbOpenDynaset)
 If Not rsExh.EOF Then
   If MsgBox("Some 'No Shows' have been entered" & vbCrLf & _
         "Do you want a list of current 'No Shows'?", vbYesNo, "List Current No Shows?") = vbYes Then
      msg = "'No Show' Exhibit numbers. (current list)" & vbCrLf & _
            "New entries added to end of list. (Click here to scroll down)" & vbCrLf
      rsExh.MoveFirst
      Do While Not rsExh.EOF
         msg = msg & rsExh!EXN & vbCrLf
         rsExh.MoveNext
      Loop
      TextBox.SetFocus
      TextBox.FontName = "Courier"  ' this is so the columns line up.
      TextBox.Text = msg
     ' btnDoNothing.SetFocus
      MsgBox "If you need to remove one or more 'No Shows' From this list do the following:" & vbCrLf & _
                "1. Open the ExhibitsData table." & vbCrLf & _
                "2. Find the Exhibit number(s) (EXN) in question." & vbCrLf & _
                "3. Clear the 'To_State' field entry. (Set it blank)." & vbCrLf & _
                "4. Return to Judge Scores Form (this form) and click [Update Web Scores]" & vbCrLf & _
                "    That will update the website with the changed no-shows list" ' rev 5.4.6 546 added item 4.
      End If
 End If
 rsExh.Close
 Set rsExh = CurrentDb().OpenRecordset("Select * from ExhibitData", dbOpenDynaset)
 noShowEx = ""
 Last = ""
 Do
   If noShowEx <> "" Then
     Last = "Exhibit # " & noShowEx & " Set as 'No Show'" & vbCrLf & vbCrLf & "Enter Next 'No Show' or Cancel to Exit"
   Else
     Last = "This will place 'N' in the TO_STATE field for each exhibit entered. " & vbCrLf & vbCrLf & _
            "Enter the first 'No Show' Exhibit Number or Cancel to Exit"
   End If
DoMore:
   noShowEx = InputBox(Last, "No Show Entries (Sets TO_STATE = 'N')")
   If noShowEx = "" Then
     Me.Requery
     Scores.Requery
     MsgBox "Done!" & vbCrLf & _
            "If you added one or more No Show exhibits.." & vbCrLf & _
            "Click [Update Web Scores] button to update the No Shows on the web."  ' rev 5.4.6  546
     rsExh.Close
     ' rev 5.4.3 543
     If Mid(msg, 1, 9) = "'No Show'" Then
       TextBox.SetFocus
       TextBox.FontName = "Courier"  ' this is so the columns line up.
       TextBox.Text = msg
     End If
     Exit Sub
   End If
   On Error GoTo BadEntry
   Exnum = noShowEx
   ' do the update
   rsExh.FindFirst ("[EXN] = " & Exnum)
   If Not IsNull(rsExh!SCORE) Then   ' hum is score set or what
     If rsExh!SCORE > 0 Then ' has a score is this ok
       MsgBox "Exhibit " & Exnum & " has a score!" & vbCrLf & _
                "Resolve this issue!" & vbCrLf & "NOT SET AS NO-SHOW!", vbOKOnly, "No Show with score?"
     Last = "Exhibit # " & noShowEx & " Skipped!" & vbCrLf & vbCrLf & "Enter Next 'No Show' or Cancel to Exit"
      GoTo DoMore
     End If
   End If
   If Not rsExh.NoMatch Then  ' Found the exhibit entered as no show
      rsExh.Edit
      rsExh!TO_STATE = "N"
      ' rev 543 5.4.3
      If Mid(msg, 1, 9) = "'No Show'" Then   '  Update the current list
        msg = msg & Exnum & vbCrLf
      End If
      rsExh.Update
   Else
BadEntry:
    MsgBox "Exhibit " & noShowEx & ":  No such Exhibit"
    noShowEx = ""
   End If
 Loop
   Exit Sub
SubError:
   MsgBox "Error Setting No Show " & Err.Description
End Sub
' rev 547 5.4.7  made this public so can call from the subform
Public Sub btnRecalculateScore_Click()
  ScoreStatus = ExhScore(EXN)
  Form.Refresh
End Sub

Private Sub btnScoresOverrides_Click()
  Dim Instrg1 As String
  On Error GoTo XedChoice
  Instrg1 = ""
  '  -------------------- first selete the category  (all not allowed) ----------
  DoCmd.OpenForm "xCategory Exhibit Ranking Selector", , , , , acDialog
  Instrg1 = Forms("xCategory Exhibit Ranking Selector").Form.Tag
  DoCmd.Close acForm, "xCategory Exhibit Ranking Selector"
XedChoice: '  user closed form versus choose ncat
  On Error GoTo SubError
  If Instrg1 = "" Then
    MsgBox "You Did Not Select a Category"
    Exit Sub
  End If
  ' changed message rev 5.3.7
  If MsgBox("Please use the Stem Website 'Chair Category Ranking Form' to enter Final results! " & vbCrLf & vbCrLf & _
           "This provides a last resort method to enter Final scores and/or mark a category 'Final'." & vbCrLf & _
            "Use this method ONLY if the Website is down or cannot be used for some reason." & vbCrLf & _
            " This method does not capture Top of Category awards, or recommendations for State and ISEF!" & vbCrLf & _
            "Note: Always verify final ranking with a Category Report!" & vbCrLf & vbCrLf & _
           "CONTINUE with " & Instrg1 & "?", _
           vbYesNo, "Enter Final Scores") = vbNo Then Exit Sub
 ' MsgBox "Not implemented. Use 'Override Score' button in subform (Lower part if this form)." & vbCrLf & _
 '        " First select the exhibit number so that it's record is displayed. " & vbCrLf & _
 '        " Then click the 'Override Score' button and enter the new score."
 Dim pair As String
 Dim Exns As String
 Dim Scrs As String
 Dim Exni As Integer
 Dim Scrd As Double
 Dim TC As String
 Dim Numdone As Integer
 Dim didgood As Boolean
 Dim iLE As Integer
 Dim ilS As Integer
 Dim curNCAT As String
 curNCAT = Instrg1
 'MsgBox "Enter final scores for ONLY Category " & curNCAT & "!" & vbCrLf & _
 '       "Enter ALL of the scores for this category at this time."
 ' See if the category has overrides from the web  LocFinal = "W" or previous entries = "L"
  Dim MyWebdbPath As String
  Dim dbweb As Database
  Dim Temp As Recordset
  Set Temp = CurrentDb().OpenRecordset("SELECT * FROM FairInfo WHERE Fair_Year = " & FairYear())
  MyWebdbPath = Temp!WebdbPath
  Temp.Close
  Set dbweb = DBEngine.OpenDatabase(MyWebdbPath)
  Set Temp = dbweb.OpenRecordset("Select * from NatCategories where NatCategories.NCAT = '" & _
                curNCAT & "'", dbOpenDynaset)  ' Get all fields for this category
   
 Scores.FindFirst "NCAT = '" & curNCAT & "'"
  If Not IsNull(Scores!LocFinal) Then
    If Scores!LocFinal = "W" Then   '  never allow any changes if web downloaded and not cleared
       MsgBox "Category " & curNCAT & " has Web-Site Final Download Scores (NOT CLEARED)!" & vbCrLf & _
            "Use button [Clear Finals One Category] First!"
       Temp.Close
       dbweb.Close
       Exit Sub
     End If
  End If
  If Temp!InputFinal = True Then
      'Website seems to be active by a chair  - give warning
       If MsgBox("Category: " & curNCAT & " Web-site marked 'Final' " & vbCrLf & _
         " (Web-Site has been used!)" & vbCrLf & vbCrLf & _
         "Do you want to Manually Enter Final scores for Category " & curNCAT & "?", vbYesNo, "Enter Final Scores") = vbNo Then
         Temp.Close
         dbweb.Close
         Exit Sub
       End If
  End If
  If Scores!LocFinal = "L" Then   ' Some work has been done,   continue with work.
       If MsgBox("Category " & curNCAT & " Has already been set final from local staff. " & _
       "Do you want to add to or change final scores?", vbYesNo + vbDefaultButton2, "Already Final") = vbNo Then
         Temp.Close
         dbweb.Close
         Exit Sub
       End If
      ' entries already want to add more??
  End If
 ' Go ahead now and enter the pairs to add to webfinals or start a local final scores entry
 
 Numdone = 0
Getpair:
 On Error GoTo SubError
 If Numdone > 0 And didgood = True Then
   pair = InputBox("Success! Set " & curNCAT & " Exn " & Exni & " final score to " & Scrd & vbCrLf & _
                 "Enter next pair or {Cancel to exit", "Enter Final Exhibit Score", "   ")
 
 Else
   pair = InputBox("Enter 'ExhibitNum, NewScore' Then Click [OK]" & vbCrLf & _
                 "Example:" & vbCrLf & _
                 "207,78.34" & vbCrLf & _
                 "Click [Cancel] to Exit", "Enter Final Exhibit Score", "   ")
 End If
 didgood = False
 If pair = "" Then  '  exiting the sub
    If Numdone = 0 Then
     If MsgBox("MARK category " & curNCAT & " FINAL without changing final scores?", vbYesNo, _
     "Make category final?") = vbYes Then Numdone = 1
    End If
   ' set LocFinal = 'L' if had any entries
    If Numdone > 0 Then  ' Finished and Had at least one entry
      Scores.FindFirst "NCAT = '" & curNCAT & "'"   'Find any record linked to this ncat
      Scores.Edit
      Scores!LocFinal = "L"  '  Rev 5.3.3  flag this category as final by local staff
      Scores.Update
      ' open the website and set LocFinal = L
      Temp.Edit
      Temp!LocFinal = "L"   ' this will indicate that finals are set locally
      Temp.Update
      Temp.Close
      dbweb.Close
    End If

    Me.Requery
    Scores.Requery   'This should update the overrides and resort the scores

    If Numdone > 0 Then
      ' rev 540  need to add the TOC to the local file (is it already sorted?)
      '  Add this on next revision
         ' sort by scores
         ' first three = 1st, 2nd, 3rd  then ask if any Honorable mention.
         Set Temp = CurrentDb().OpenRecordset("SELECT * FROM ExhibitData WHERE NCAT = '" & curNCAT & "' ORDER by SCORE DESC")
         Temp.MoveFirst
         Dim Ranknu As Integer
         Ranknu = 1
         Do While Not Temp.EOF
           If Temp!NCAT = curNCAT Then
              Dim curscore As String
              curscore = IIf(IsNull(Temp!SCORE), "", Temp!SCORE)
              If Ranknu = 1 Then
                Temp.Edit
                Temp!TOC = "1st"
                Temp.Update
              End If
              If Ranknu = 2 Then
                Temp.Edit
                Temp!TOC = "2nd"
                Temp.Update
              End If
              If Ranknu = 3 Then
                Temp.Edit
                Temp!TOC = "3rd"
                Temp.Update
              End If
              If Ranknu > 3 Then
                Temp.Edit
                Temp!TOC = Null
                Temp.Update
              End If
              Ranknu = Ranknu + 1
           End If
           Temp.MoveNext
         Loop
         Temp.Close
         MsgBox "Category " & curNCAT & " Marked Final (local entries)" & vbCrLf & _
            " The Top of Categories 1st, 2nd, 3rd have been set!" & vbCrLf & _
            " You MUST manually Enter any Honorable Mention Exhibits (if any) in the " & vbCrLf & _
            " ExhibitData table BEFORE you print any Category TOC and Ranking report for " & curNCAT

         '  OK I have set 1st, 2nd third  just have Honorable mentions left
    End If

    Me.Requery     ' get the results in form
    Scores.Requery
    Exit Sub
 End If
 Exns = ""
 Scrs = ""
 For iLE = 1 To Len(pair)
   TC = Mid(pair, iLE, 1)
   If TC = "," Then Exit For
   Dim re As Integer
   re = Asc(TC)
   If Asc(TC) > 57 Or Asc(TC) < 48 Then
     MsgBox "Non Numeric Exhibit Entered": GoTo Getpair
   End If
   Exns = Exns & TC
 Next iLE
 ' ile =  position of comma
 For ilS = iLE + 1 To Len(pair)
   TC = Mid(pair, ilS, 1)
   If Not (Asc(TC) <= 57 And Asc(TC) >= 48 Or Asc(TC) = 46) Then  ' '46' is period
     MsgBox "Non Numeric Score Entered": GoTo Getpair
   End If
   Scrs = Scrs & TC
 Next
 On Error GoTo BadNums
 Exni = Val(Exns)
 Scrd = Val(Scrs)
 On Error GoTo SubError
 If Exni > 9999 Or Exni < 100 Or Scrd < 0# Or Scrd > 100# Then
   MsgBox "Value Out Of Range"
   GoTo Getpair
 End If
 With Scores
   .FindFirst "EXN = " & Exns
   If .NoMatch Then
     MsgBox "No Such Exhibit"
     GoTo Getpair
   End If
   If !tNCAT <> curNCAT Then
     MsgBox "Wrong NCAT"
     GoTo Getpair
   End If
   .Edit
   !SCORE = Scrd
   !SCORE_OVERRIDE = True
   .Update
   Numdone = Numdone + 1
   didgood = True
   Form.Refresh
   ChangedForm = True  ' assume changed so text dotextbox does not create error
 End With
 GoTo Getpair  ' get another or exit
Exit Sub
' -------------------------------
BadNums:
  MsgBox "Bad Entry"
GoTo Getpair
' --------------------------------
SubError:
 MsgBox "Error in btnScoresOverrides_Click: " & Err.Description

End Sub

Private Sub btnStatus_Click()
  On Error GoTo SubError
  ' Rev 5.2.4  For each NCAT list %forms read, %Exhibits Complete, %Exhibits vaiable score.
  Dim CatRS As Recordset
  Dim ExJuRS As Recordset
  Dim TtlFrms As Integer
  Dim TtlExn As Integer
  Dim PercEComp As String
  Dim ExnComp As Integer
  Dim ScnFrms As Integer
  Dim ErrFrms As Integer
  Dim msg As String
  Dim CurEx As Integer
  Dim CurExComp As Boolean
  Dim CATNAME As String
  Dim FoundOneEX As Boolean
  Dim RSTFairInfo As Recordset
  Dim rsLCat As Recordset
  Dim rsWebCat As Recordset
  Dim dbweb As DAO.Database
  Dim db As DAO.Database
  Dim TestNoshow As Boolean    ' Rev 5.3.7
  Dim ShowExh As Integer       ' rev 5.3.7 count exhibits not noshows
  Dim TtlNoShow As Integer     ' rev 5.3.7
  Dim RSWebEx As Recordset    ' rev 5.3.7
  Dim MyWebdbPath As String
  Dim WebDone As String
  Dim CatFinal As String
  'Dim dbweb As Database
  TextBox.SetFocus
  TextBox.Text = "Please Wait"
  ' rev 5.3.1  Add status of web site final etc for each category
  Set RSTFairInfo = CurrentDb.OpenRecordset("SELECT * FROM FairInfo WHERE Fair_Year = " & FairYear())
  MyWebdbPath = RSTFairInfo!WebdbPath
  RSTFairInfo.Close
 '  open remote table
  Set dbweb = DBEngine.OpenDatabase(MyWebdbPath)
  Set rsWebCat = dbweb.OpenRecordset("Select * from NatCategories")  ' Get all fields
  rsWebCat.MoveLast
  rsWebCat.MoveFirst
  Set CatRS = CurrentDb().OpenRecordset("Categories", dbOpenDynaset)
  'Rev 540  added exhibit.teamex
  'Rev 548DES  5.4.8 DES  mods for CR1,2,3,4,5,6
  msg = " SELECT ExhibitJudges.EXN, ExhibitJudges.CR1, ExhibitJudges.CR2, ExhibitJudges.CR3, ExhibitJudges.CR4, " & _
  "ExhibitJudges.CR5, ExhibitJudges.CR6, ExhibitJudges.NTR, ExhibitData.NCAT, ExhibitData.SCORE, " & _
  "ExhibitData.TeamEx, ExhibitData.SCORE_OVERRIDE, ExhibitData.TO_STATE " & _
  "FROM ExhibitData RIGHT JOIN ExhibitJudges ON ExhibitData.EXN = ExhibitJudges.EXN ORDER BY ExhibitData.NCAT, ExhibitJudges.EXN;"
  Set ExJuRS = CurrentDb().OpenRecordset(msg, dbOpenSnapshot)
  'Msg = "NCAT, %complete,  # ex to judge (ttl - noshows), # complete, ttl forms,  scanned forms, ScnErs, webrdy Final etc.
  
  msg = "NCAT     %Comp #Ex Cmp Frms Scnd ScnErs WebRdy Final" & vbCrLf & vbCrLf
  Do While Not CatRS.EOF
     WebDone = ""
     TtlExn = 0
     ExnComp = 0
     TtlFrms = 0
     ErrFrms = 0
     ScnFrms = 0
     ShowExh = 0   ' rev 5.3.7
     TtlNoShow = 0
     TestNoshow = False
     CurEx = 0
     With ExJuRS
     ExJuRS.MoveFirst
     FoundOneEX = False
     Do While Not .EOF         '  find all the records (one per assigned judge) for this exhibit
       FoundOneEX = False
       If !NCAT = CatRS!NCAT Then
         FoundOneEX = True
         If CurEx = !EXN Then  ' still on current exhibit number NOTE Must sort by Exhibit number for this
           If !NTR = 0 Then CurExComp = False  ' at least one form is not scanned so this EXN not complete
         Else   ' Do this once for each new exhibit number
           TtlExn = TtlExn + 1
           ShowExh = ShowExh + 1
           ExnComp = ExnComp + 1   '  Assume complete unless proven otherwise
           CurEx = !EXN             ' set so this else not done again for this exn
           CurExComp = True  ' assume complete unless NTR = 0 for any form
           If !NTR = 0 Then CurExComp = False
           If !TO_STATE = "N" Then   '  rev 5.3.7  in case of eof need to set this prior to movenext
             TtlNoShow = TtlNoShow + 1
             TestNoshow = True
             ShowExh = ShowExh - 1   '  use this in % comp calc
           Else
             TestNoshow = False
           End If
         End If
         If CatRS!NCAT = !NCAT Then
           TtlFrms = TtlFrms + 1
           If !NTR > 0 Then ScnFrms = ScnFrms + 1
         End If
         If !NTR > 0 Then
            ' Rev 5.4.0
            'If (!CAS = 0 Or !CAS = 7) Or _
            ' (!STS = 0 Or !STS = 7) Or _
            ' (!THS = 0 Or !THS = 7) Or _
            ' (!SKS = 0 Or !SKS = 7) Or _
            ' (!CLS = 0 Or !CLS = 7) Or _
            '  (CatRS!TEAM = True And (!TWS = 0 Or !TWS = 7)) Then
            ' Rev 548DES 5.4.8DES   mods for CR1 -- CR6
            If (!CR1 = 0 Or !CR1 = 7) Or _
             (!CR2 = 0 Or !CR2 = 7) Or _
             (!CR3 = 0 Or !CR3 = 7) Or _
             (!CR4 = 0 Or !CR4 = 7) Or _
             (!CR5 = 0 Or !CR5 = 7) Or _
             (!CR6 = 0 Or !CR6 = 7) Then      ' rev 547 5.4.7    always include this mark
 '             ((!TeamEx = True Or CatRS!TEAM = True) And (!TWS = 0 Or !TWS = 7)) Then
                
                ErrFrms = ErrFrms + 1
            End If
         End If
       End If  '   is NCAT a match
       .MoveNext   ' next record for this exhibit
       If FoundOneEX = True Then  ' curexcom has been incremented
         If .EOF Then   '    Added to-state check rev 5.3.7  a no show should never be counted even if read cards
             If CurExComp = False Or TestNoshow = True Then
               ExnComp = ExnComp - 1
             End If
         Else
             If CurEx <> !EXN Then
                If CurExComp = False Or TestNoshow = True Then
                   ExnComp = ExnComp - 1
                End If
             End If
         End If
       End If
     Loop
     End With
     If TtlExn = 0 Then
        PercEComp = "  N/A"
     Else  ' rev 5.3.7 changed TtlExn to ShowExh to give better % complete results
        PercEComp = Format(CInt((ExnComp * 100) / ShowExh), " @@@") & "%"
     End If
    CATNAME = CatRS!NCAT
    Do While Len(CATNAME) < 8
      CATNAME = CATNAME & " "
    Loop
    ' Find if web is final
    rsWebCat.FindFirst ("[NCAT] = '" & CATNAME & "'")
    If Not rsWebCat.NoMatch Then
      If rsWebCat!InputFinal = True Then
        WebDone = "Yes"
      Else
        If TtlExn = 0 Then
          WebDone = "n/a"    ' rev 5.3.7
        Else
          WebDone = "  "
        End If
      End If
    End If
    CatRS.FindFirst ("[NCAT] = '" & CATNAME & "'")
    If Not CatRS.NoMatch Then
       If IsNull(CatRS!LocFinal) Then
          If TtlExn = 0 Then
            CatFinal = "n/a"   ' rev 5.3.7
          Else
             CatFinal = "    "
          End If
       Else
         If CatRS!LocFinal = "W" Then
           CatFinal = "Web  "
         End If
         If CatRS!LocFinal = "L" Then
           CatFinal = "Local"
         End If
       End If
    End If
    msg = msg & CATNAME & PercEComp & _
    Format(TtlExn - TtlNoShow, "@@@@") & Format(ExnComp, " @@@@") & _
    Format(TtlFrms, " @@@@") & _
    Format(ScnFrms, " @@@@") & _
    Format(ErrFrms, " @@@@") & _
    "    " & WebDone & "  " & CatFinal & vbCrLf
    CatRS.MoveNext
  Loop
  ExJuRS.Close
  CatRS.Close
  TextBox.SetFocus
  TextBox.FontName = "Courier"  ' this is so the columns line up.
  TextBox.Text = msg
  btnDoNothing.SetFocus
'  TextBox.FontName = "Arial" Can not do this here - must wait until next time change textbox text.
  Exit Sub
SubError:
  MsgBox "Status Button Error: " & Err.Description
End Sub

Private Sub btnToState_Click()  ' Verify the Number to state etc.
  MsgBox "The number of exhibits allocated to attend the state fair (N_TO_STATE)" & vbCrLf & _
       " and the number of alternates (N_ALT) should be set in the Categories Table." & vbCrLf & _
       " These values will be visible on the web site Chairs Ranking page to be used " & vbCrLf & _
       " by the chairpersons when selecting exhibits to recommend to attend the state fair." & vbCrLf & vbCrLf & _
       "The values are probably already set (Check with the Director!)  " & vbCrLf & _
       " If not, or if the numbers change you should do these steps:" & vbCrLf & _
       "   - Open the Categories Table and set N_TO_STATE and N_ALT values there." & vbCrLf & _
       "   - Open the xWebsite Sync Form and click [Update Categories] button - then Exit that form."
End Sub

Private Sub btnUpdateCats_Click()
    If MsgBox("Clears Categories data locally and on the website - preparing for Judge Scoring!" & vbCrLf & _
  " ARE YOU SURE?", vbYesNo + vbDefaultButton2, "Clear ALL Category Data") = vbNo Then
    Exit Sub
  End If
  DoCmd.Close acForm, "xWebsite Sync"  ' In case it it already open need to close so all works as expected
  DoCmd.OpenForm "xWebSite Sync", , , , , acDialog, OpenArgs:="UDCATS" ' or acWindowNormal
  '  NOTE  OpenArgs = UDCATS is what causes the Update categories button to do all the clearing.
  '  N_TO_STATE and N_ALT are not cleared but are uploaded to web as set in the local Categories table
  'MsgBox "Categories have been cleared!"  ' put this message in website sync form.
  Me.Requery
  Scores.Requery
End Sub
Private Sub btnDownloadWeb_Click()
 ' MsgBox "This is ONE method to enter override scores. " & vbCrLf & _
 '        " The other method is to use [Enter Score Overrides]" & vbCrLf & _
 '        "This method will Clear all current overrides in Categories Downloaded!" & vbCrLf & _
 '        "If the Chair of a category has entered all the Final Scores .. and" & vbCrLf & _
 '        "the Chair has indicated the web page is final, then you can do this:" & vbCrLf & _
 '        "Use form 'xWeb Sync' [Download Category Finals] " & vbCrLf & _
 '        " Enter the NCAT of the category you want to download." & vbCrLf & vbCrLf & _
 '        " Note: Always Verify Final Scores with a Category Report!"
    DoCmd.Close acForm, "xWebsite Sync"  ' In case it it already open need to close so all works as expected
    DoCmd.OpenForm "xWebSite Sync", , , , , acDialog, OpenArgs:="DLWEB" ' or acWindowNormal
    Scores.Requery
    Me.Requery
End Sub
Private Sub btnUploadScoresFinal_Click()
    DoCmd.Close acForm, "xWebsite Sync"  ' In case it it already open need to close so all works as expected
    DoCmd.OpenForm "xWebSite Sync", , , , , acDialog, OpenArgs:="ULSF"  ' could use acWindowNormal
   ' DoCmd.Close acForm, "xWebsite Sync"
    Me.Requery
    Scores.Requery
End Sub

Private Sub btUpDateWebScores_Click()
    DoCmd.Close acForm, "xWebsite Sync"  ' In case it it already open need to close so all works as expected
    DoCmd.OpenForm "xWebSite Sync", , , , , acDialog, OpenArgs:="ULS"
   ' DoCmd.Close acForm, "xWebsite Sync"
    Me.Requery
    Scores.Requery
    btUpDateWebScores.SetFocus
    btUpDateWebScores.Caption = "Update Website  Scores"
    btUpDateWebScores.ForeColor = &H22B14C
    btnImport.SetFocus
End Sub

Private Sub cbListMissingDbl_Click()
  If cbListMissingDbl.Value = -1 Then
     ListMsgDbl = True
  Else
     ListMsgDbl = False
  End If
  cbListMissingDbl.Requery
End Sub


Private Sub Form_Close()    '  Rev 5.5.2  DES   Never closed Scores on exit
  Scores.Close
End Sub

'Private Sub CkbSeqNum_Click()
'   If CkbSeqNum.Value = -1 Then
'      CkbSeqNumValue = 0
'   Else
'      CkbSeqNumValue = -1
'   End If
'   CkbSeqNum.Requery
'  End Sub
Private Sub Form_Open(Cancel As Integer)
  On Error GoTo SubError
  ' 5.0.0  removed COMDLG32 common dialog so this will run in Vista without having to
  '  add and register COMDLG32.OCX
  ' Open a record set with the most possible information that can be editied
  ' NOTE: The FORM has a record set (a nd a sub form) with all needed information that is
  '  Read Only.   Remember to do Form.Refresh after each edit of the Scores recordset
  ' to Update the form query data
  
  ' Set ScoresQuery = CurrentDb().QueryDefs("xJudge Scores & Exhibit Ranking Edit Query")
  ' Set Scores = ScoresQuery.OpenRecordset()
  ' replace above with same thing hard coded (incase someone eliminates the query
  Screen.MousePointer = 11
  '  rev 5.4.1  get the value of UseTeamworkMark for this fairyear.
  Dim temprs As Recordset
  Set temprs = CurrentDb().OpenRecordset("SELECT UseTeamworkMark, WebDbPath FROM FairInfo WHERE Fair_Year = FairYear()", , dbOpenDynaset)
  temprs.MoveFirst
  ' rev 547  5.4.7
  If temprs!UseTeamworkMark = False Then
     temprs.Edit
     temprs!UseTeamworkMark = True
     temprs.Update
  End If
  LblTeamworkmark.Caption = ""  ' rev 547  5.4.7     ' no need for this lable anymore.
 ' UseTeamworkMark = temprs!UseTeamworkMark
 ' If UseTeamworkMark = True Then
 '   LblTeamworkmark.Caption = "Team Scores use Teamwork Mark."
 ' Else
 '   LblTeamworkmark.Caption = "Team Scores Do Not use Teamwork Mark."
 ' End If
 '    end rev 5.4.7 changes
  ' rev 5.4.6  546   Check that the website is correctly mapped in the FairInfo table
  Dim TestWebDir As String
  TestWebDir = temprs!WebdbPath
  temprs.Close
  '   end of 5.4.1 addition
  ' rev 5.4.6  546  addition
  ' see if can see the SciFairWebData database
  If (Dir$(TestWebDir) <> "") Then
    'ok
  Else
    ' not exist
    MsgBox "** ERROR: SciFairWebData.mdb is not correctly mapped in FairInfo Table!" & vbCrLf & _
            "      Set the location of SciFairWebData.mdb correctly in the FairInfo Table!" & vbCrLf & _
            "      Place the location in the WebDbPath field for the current Fair Year" & vbCrLf & _
            "      Failure to fix this issue will result in nasty problems." & vbCrLf & vbCrLf & _
            "    FORM WILL NOT OPEN.", _
            , "Can' Find SciFairWebData.mdb"
    ' rev 5.5.7  changed wording above and close the form.   Don't want to introduce issues.
    Cancel = True   '  this will close the form
    Screen.MousePointer = 0
    Exit Sub
  End If
  ' end of rev 546 5.4.6 addition
  Dim crit As String
  'Rev 5.4.0  added ExhibitData.TeamEx and exhibitdata.To_ISEF (not sure I use it)
  ' Rev 5.4.6 added ExhibitData.TOC  so can clear when clear all scores.
  ' 5.4.8DES
  crit = "SELECT ExhibitJudges.EXN, ExhibitJudges.JUN, ExhibitJudges.CR1, ExhibitJudges.CR2, ExhibitJudges.BSeq, " & _
  "ExhibitData.TOC, ExhibitData.JCAT, ExhibitData.NCAT, ExhibitData.TeamEx, ExhibitJudges.CR3, ExhibitData.To_ISEF, " & _
  "ExhibitJudges.CR4, ExhibitJudges.CR5, ExhibitJudges.CR6, ExhibitJudges.NTR, ExhibitData.EXHB_TITLE, " & _
  "ExhibitData.SCORE_OVERRIDE, ExhibitData.SCORE, ExhibitData.TO_STATE, ExhibitData.FLOOR, Persons.FNAME, " & _
  "Persons.LNAME, Categories.LocFinal, Categories.TEAM, Categories.NCAT as tNCAT, Categories.LocFinal, Categories.CATNAME, Categories.FIRST_EX, Categories.LAST_EX, Judges.NUMEX " & _
  "FROM Persons RIGHT JOIN (Judges RIGHT JOIN ((Categories RIGHT JOIN ExhibitData ON Categories.NCAT = " & _
  "ExhibitData.NCAT) RIGHT JOIN ExhibitJudges ON ExhibitData.EXN = ExhibitJudges.EXN) ON Judges.JUN = " & _
  "ExhibitJudges.JUN) ON Persons.PID = Judges.PID;"
  Set Scores = CurrentDb().OpenRecordset(crit, , dbOpenDynaset)
  If Scores.EOF Then     ' Rev 5.5.7  changed all of this to close if no assignments
    MsgBox "No Judge Assignments! " & vbCrLf & _
    " You need to assign judges before using this form." & vbCrLf & vbCrLf & "FORM WILL NOT OPEN"
    'Close            'This closes this form but the subform still loads.   Rev 5.5.7  do not close - wont get the textbox text
    Cancel = True   '  this will close the form  added the exit rev 5.5.7  since the textbox seems to not work at all,  can't set focus
    Screen.MousePointer = 0
    Scores.Close
    
    Exit Sub
  End If
  Dim JuTyCat As Recordset
  Set JuTyCat = CurrentDb().OpenRecordset("JudgeTypeCategories", dbOpenDynaset)
  With Scores
     If Not .EOF Then
       .MoveFirst
       Do While Not .EOF
           With JuTyCat
              .MoveFirst
              Do While Not .EOF
                 If !JCAT = Scores!JCAT Then
                   If !NCAT = Scores!NCAT Then
                     GoTo foundit
                   End If
                 End If
              .MoveNext
              Loop
               MsgBox "Exhibit " & Scores!EXN & " JCAT= " & Scores!JCAT & " does not match NCAT= " & _
               Scores!NCAT & "- Fix Problem!"
               Screen.MousePointer = 0
               Cancel = True
               .Close
               Exit Sub
foundit:
           End With
       .MoveNext
       Loop
       .MoveFirst
     End If
   End With
   JuTyCat.Close    ' rev 5.2.4
   ' rev 5.4.9DES  549DES  make sure we capture any changes in the SForm or Categories tables re changes in scoring criteria
   CRWeight(0, 0) = 0    ' this also makes it easier to debug because don't have to end Access and restart to test ExhScore function code
  'CkbSeqNumValue = -1
  'CkbSeqNum.Value = CkbSeqNumValue
  cbListMissingDbl.Value = -1
  ListMsgDbl = True
  lblRevision.Caption = "Rev " & Revision()
  ChairListCat = ""
    '  changed text rev 5.3.1   changed text rev 5.5.7  557      put  a number on item 6 so it is more obvious.
  msg = " Welcome: A quick summary of the process: (See Help for details!)" & vbCrLf & _
        " ** BEFORE SCANNING FORMS complete these items in sequence (click buttons):" & vbCrLf & _
        "  - Click [Clear All Scores] ONCE ONLY " & vbCrLf & _
        "  - Click [Clear / Update Categories] ONCE ONLY " & vbCrLf & _
        "  - Click [Build DataLink Student Data] ONCE ONLY, Load into Datalink for both scanners. Then  " & vbCrLf & _
        "  - Click [Enter No Shows] to set TO_STATE = 'N' for all No Show Exhibits)" & vbCrLf & _
        "  - Click [Verify To State Values] and follow the instructions." & vbCrLf & "  - Import the Student Data into DataLink!" & vbCrLf & _
        " ** SCAN FORMS (Repeat Steps 1. thru 6. until all forms are scanned):" & vbCrLf & _
        "  1. Scan Forms using Apperson BenchMark3000 and DataLink software:" & vbCrLf & _
        "    - Forms with missing marks or double marks or other errors should be fixed in that process." & vbCrLf & _
        "    - Forms with errors should be re-scanned after they are corrected. (In same or future session.)" & vbCrLf & _
        "    - Do not sort the data in DataLink by Name or ID or ANYTHING - DO NOT SORT DATA!" & vbCrLf & _
        "  2. Export the DataLink results using the 'Book' Icon - 'Transfer data to Science Fair'" & vbCrLf & _
        "    - Save the .txt files Exported from DataLink into a folder that can be accessed by this application. " & vbCrLf & _
        "  3. Click [Get Judges Score File] to import the .txt files IN THE SAME SEQUENCE THEY WERE CREATED!" & vbCrLf & _
        "  4. Click [Update Website Scores] to upload the Scores and Status to the Web." & vbCrLf & _
        "  5. Click [Overall Status] or [Category Status] to get a quick look at progress." & vbCrLf & _
        "  6. Near the end of scanning Click [Download Web 'Final' Entries] often to check for final Category results" & vbCrLf & _
        " ** FINALIZE:" & vbCrLf & "  - Click [Final Update Website Scores] " & vbCrLf & _
        "  - Click [Download Web Final Scores] until all Categories are Final" & vbCrLf & _
        "     - [Print Category Results] as they are finalized and Verify. Obtain Category Chairs' signatures." & vbCrLf & _
        "  - [Print Category Results] for all Chairs and Verify with TOC Forms from Chairs." & vbCrLf & _
        "  - Monitor Final Caucus to determine To_State/Alternates/To_ISEF exhibits until complete. " & vbCrLf & _
        "  - Set the To_State/Alternates/To_ISEF values in ExhibitData using form 'xSet Final To_State/ISEF'"
  DoTextBox (ChangedForm)
  ChangedForm = False
  Screen.MousePointer = 0
  btnImport.SetFocus
  Exit Sub
SubError:
  Screen.MousePointer = 0
  MsgBox "Error in Form_Load: " & Err.Description
  Cancel = True
End Sub

Private Sub EnableButtons(Enable As Boolean)
 On Error GoTo SubError
 btnDoNothing.SetFocus
 If Enable = False Then
   btFindForm.Enabled = False
   btnClrOverridesOneCat.Enabled = False
   btnDownloadWeb.Enabled = False
   btnNoShows.Enabled = False
   btnStatus.Enabled = False
   btnToState.Enabled = False
   btnUpdateCats.Enabled = False
   btnUploadScoresFinal.Enabled = False
   btUpDateWebScores.Enabled = False
   
   
   
    btnImport.Enabled = False
    btnRemoveOverride.Enabled = False
    btnOverrideScore.Enabled = False
    btnRecalculateScore.Enabled = False
    btnEnterExhibitRanking.Enabled = False
    btnAddLateExhibitJudges.Enabled = False
   ' btnClearAllOvr.Enabled = False
    btnClearScores.Enabled = False
    btnScoresOverrides.Enabled = False
    btnImport.Enabled = False
    btnChairReport.Enabled = False
    'CkbSeqNum.Enabled = False
    btnBuildStuData.Enabled = False
    btChairList.Enabled = False
    btnClearText.Enabled = False
 Else
 
   btFindForm.Enabled = True
   btnClrOverridesOneCat.Enabled = True
   btnDownloadWeb.Enabled = True
   btnNoShows.Enabled = True
   btnStatus.Enabled = True
   btnToState.Enabled = True
   btnUpdateCats.Enabled = True
   btnUploadScoresFinal.Enabled = True
   btUpDateWebScores.Enabled = True
   
    btnImport.Enabled = True
    btnRemoveOverride.Enabled = True
    btnOverrideScore.Enabled = True
    btnRecalculateScore.Enabled = True
    btnEnterExhibitRanking.Enabled = True
    btnAddLateExhibitJudges.Enabled = True
   ' btnClearAllOvr.Enabled = True
    btnClearScores.Enabled = True
    btnScoresOverrides.Enabled = True
    btnImport.Enabled = True
    btnChairReport.Enabled = True
    'CkbSeqNum.Enabled = True
    btnBuildStuData.Enabled = True
    btChairList.Enabled = True
    btnClearText.Enabled = True
 End If
 Exit Sub
SubError:
  MsgBox "Error in EnableButtons; " & Err.Description
End Sub

Private Sub DoTextBox(FormDataChanged As Boolean)
   ' FormDataChanged is true if the underlying data for the form has changed
   ' calling routine should set this true if this is the case. If true a one second delay
   ' and a form update will occur if the delay and form.refresh is not done prior to the
   ' textbox change, and error 7878 will occur
   On Error GoTo SubError1
   Dim trace As Integer  ' this may be removed after no more error 7878
   If FormDataChanged = True Then
         Form.Refresh  ' command the form to update from the changed underlying data
         ' the timer is set to 500 MS so if i do two loops, then min delay = 500ms, max delay = 1 sec
  Form.TimerInterval = 200  ' set timer interval Milliseconds
         TimerDone = False  ' this is turned true every time the timer clicks
         Do While TimerDone = False
           DoEvents
         Loop
         TimerDone = False  ' this is turned true every time the timer clicks
         Do While TimerDone = False
           DoEvents
         Loop
  Form.TimerInterval = 0    ' turn it off after use
         FormDataChanged = False
   End If
   trace = 0
'   Form.Refresh   ' If changed a value of the form, update the form
'   DoEvents   ' and wait for events to end. added this to see if the error 7878 goes away - it may have worked unless
   '  that error is seen again
   trace = 1
   TextBox.SetFocus
   'TextBox.FontName = "Ariel"   ' removed rev 5.3.7
   trace = 2
   TextBox.Text = msg
 '  Notes = Msg  ' This is the version that uses a memo field Notes in Category Table ...
    trace = 3
   'TextBox.Text = Msg  ' rev 4.0.4 removed this duplicate entry Did I just forget
   '                    to remove before or was it needed??
   trace = 4
   Form.Refresh ' update the text box
   DoEvents     ' proccess the event, wait until done
   Form.TimerInterval = 0
   Exit Sub
SubError1:
   
   If Err.Number = 2176 Then
      ' rev 5.4.2 542  allow to clear and continue added
     If MsgBox("Text Box Full! No More Text Can Be Displayed!" & _
     "Do you want to clear the text?", vbYesNo + vbDefaultButton2, "ClearText?") = vbNo Then
         Exit Sub
     Else
         msg = "Previous Text Deleted. Continuing..." & vbCrLf
         Exit Sub
     End If
   End If
   If Err.Number = 7878 Then
   ' this error always occures after msg has had the end of file info attached so that is a clue of
   ' where to look to fix it.  Data does not seem to be missed so not sure I need the message even
   ' web search finds has something to do with sql events and textbox events and .. out of sync.
   ' or getting processed in wrong order or ????
     MsgBox "Error, Unknown Cause:" & vbCrLf & _
     "Until Code is De-bugged, Re-Read This file until no error occurs." & vbCrLf & _
     "Error 7878: " & Err.Description & " after trace " & trace
     msg = msg & " Err7878 "
     Resume  ' this is error Data has changed ' can not find any reason try doin textbox.text = msg again
   End If
   '  that that error has any effect on the data being read in.
   ' This is a non-modal text box.  I thought I could clear out the box but not really
      
  ' MessageBox &O0, _
  ' "Text Box overflow! error: " & Err.Description & vbCrLf & _
  ' "  " & vbCrLf & _
  ' " IMPORTANT: To view current errors, you must do so BEFORE YOU CLICK [OK]" & vbCrLf & _
  ' "       Note: When you click anywhere outside this box this message will go to the background." & vbCrLf & _
  ' "       To re-display this message, click on 'Text Overflow' in the Task Bar" & vbCrLf & _
  ' "         (The Bar at the bottom of your PC's Display)", "Text OverFlow", vbOKOnly
  ' Msg = CurFile & vbCrLf & CurLine
  ' Resume Next
  MsgBox "Error in DoTextBox Code: " & "Error Num = " & Err.Number & " - " & Err.Description & " text length = " & Len(msg)
  Exit Sub
End Sub
Private Sub btnImport_Click()
  ' DES 5.4.0  Fixed bug if tries to increment file name and same file exists
  '   I.E.  Import Imp03-JAA0001 to JAA0086.txt and Imp04-JAA0001 to JAA0086.txt  exists
  ' DES 4.0.4 This routine is now hardcoded for the Apperson Benchmark 3000 scanner WITH ScienceFair Firmware and
  ' the Apperson DataLink software with Science Fair upgrades.
  ' 4.0.4 Removed the option to have input files without the SeqNo  (Sequence Number)
  'read data file here by inputing data
  ' process data from a file and send the data to ExhibitJudges Table
  ' SFData1.CardUpdate(exhibit, judge, scores())
  ' Scores has 6 (sfNumSubScores) colums
  ' 1=CA  2=ST  3=Thor  4=skill 5=clar  6= teamwk (teamwork exhibits in any category after 2006
  '  so teamwork will be marked (should check is marked) for ANY exhibit with TEAM
  '  set true in Categories Table
  ' scores are:
  ' 0 = No mark, do not use in exhibit average
  ' 7 = double mark do not use
  ' 1 acceptable, 2=good 3=very good 4=excelent, 5 = exceptional
  ' 6 not used, 8 and higher Not used = Errors
  ' Exhibit and Judge must be PRE-checked as OK else error message
  'IMPORTANT.  This process modifies actual data in tables that have any data in the form. It does not
  ' change the data 'in the form' thus, BEFORE text is changed in any text box on the form, the form
  ' must be updated with data from the changed data tables or an error 7878 will be generated. Debugging
  ' this issue took many hours.  The correct sequence seems to be  that the form needs be updated
  ' ONLY if data has changed for the particular exhibit displayed in the form prior to a textbox update.
  ' ALSO, since I used the DoEvents to process system events to complete the form update, this routine will
  ' disable other buttons on the form.
 Dim FileName As String
 Dim HadOneWithMsgMark As Boolean
 Dim DebugTrace As Integer
 Dim SeqNo As String   ' DES 4.0.4 the 7 character string at the end of each record
                       '   From AAA0000 to ZZZ9999 (ZZZ9999) indicates Misssing or Multiple marks in record)
                       '    ZZZ9999 is just the way the Apperson Benchmark scanners work.
                       '
 Dim RecNo As Integer  ' the last four digits of the Sequence number (SeqNo) in each record read
 Dim IEx As Long  ' Current Exhibit Number
 Dim IJu As Integer  ' Current Judge Number
 Dim Imarkes(8) As Integer ' The data from the CSV input file
 Dim NumRecordsRead As Integer
 Dim NumBadRecords As Integer
 'Dim LOCATION As Integer   '  Forms are stacked in reverse order of file records so this is to help locate forms
 Dim CSVRecordcount As Integer
 Dim CurrentRec As Integer
 Dim IExs As String    ' DES 4.0.4    Apperson export includes quotation marks on each input (i.e. as strings)
 Dim IJus As String
 Dim stImarkes(6) As String
 Dim iIgg As Integer  '   to fill score array
 Dim FmtOk As Boolean
 Dim strFileName As String
 Dim StrFilePath As String
 Dim StrFilePathName As String
 Dim Strfilter As String
 Dim LastSeqStr As String  ' rev 547   5.4.7
 Dim FirstSeqStr As String
 Dim FirstSeqAlpha As String
 Dim FirstSeqInt As Integer
 ' Also added for rev 5.4.7
   Dim strFullPath As String
   strFullPath = Mid(DBEngine.Workspaces(0).Databases(0).TableDefs("Categories").Connect, 11)
   ' the above returns directory for SciFairData.   I.E.   X:\App_Data\SciFairData.mdb
   Dim i As Integer
   Dim LinkedDataDir As String
   LinkedDataDir = "Not found"
   i = InStr(1, strFullPath, "App_Data")  ' find location of app_data
   If i > 3 Then    ' should return 4
         LinkedDataDir = Mid(strFullPath, 1, i - 1) & "1_Application_Scoring_Etc\Scoring\"
   Else   ' rev 5.4.7    end of add    keep the next in case someone changes the above folder name. Use App_Data folder
     For i = Len(strFullPath) To 1 Step -1
     If Mid(strFullPath, i, 1) = "\" Then
         LinkedDataDir = Left(strFullPath, i)
         Exit For
      End If
      Next
   End If   ' End of add for rev 5.4.7   Also adde the InitialDir:=LinkedDataDir, _ in SetFilePathName below.
' ------------------------------------
Strfilter = ahtAddFilterItem(Strfilter, "Text Files (*.txt)", "*.txt")
StrFilePathName = ahtCommonFileOpenSave( _
                Filter:=Strfilter, OpenFile:=True, _
                InitialDir:=LinkedDataDir, _
                DialogTitle:="Select Score Data File", _
                Flags:=ahtOFN_HIDEREADONLY)
     
If IsNull(StrFilePathName) Then GoTo ErrorHandler1
If StrFilePathName = "" Then GoTo ErrorHandler1
'  ' Go get the file name to open and read
'  ImportDataDialog.CancelError = True
'On Error GoTo ErrorHandler1 ' user cancel fileload dialog box
'  '  ' Set flags
'    ImportDataDialog.Flags = cdlOFNFileMustExist + cdlOFNPathMustExist
'    ' Set filters
'    'ImportDataDialog.Filter = "All Files (*.*)|*.*|CSV Files (*.csv)|*.csv"
'    ImportDataDialog.Filter = "All Files (*.*)|*.*|Text Files (*.txt)|*.txt|CSV Files (*.csv)|*.csv"
'    ' Specify default filter
'    ImportDataDialog.FilterIndex = 2 'default filter is TXT files (comma separated values)
'    ImportDataDialog.FileName = "" ' set default filename
'    ImportDataDialog.DialogTitle = "Open Score Data CSV File"
'    ImportDataDialog.ShowOpen
'    StrFilePathName = ImportDataDialog.FileName
On Error GoTo SubError  ' This all other errors
  ' Open the file
  DebugTrace = 8877  ' so can close if error
  Open StrFilePathName For Input As #41
    ' Set up for reading the file
    NumRecordsRead = 0
    NumBadRecords = 0
    msg = "Reading File " & StrFilePathName & vbCrLf
    CurFile = "Continued Reading File " & StrFilePathName
    DoTextBox (ChangedForm)
    ChangedForm = False
    CSVRecordcount = 0
' This code just gets the actual number of records (assumes file is of correct format) and
'    checks for major format errors
On Error GoTo GotEOF  ' Trap the EOF if in a record
   FmtOk = True
   FirstSeqInt = 0           ' rev 547  5.4.7
   FirstSeqStr = "NoCheck"   'rev 547 5.4.7  leave as this unless find a good one
    Do While Not EOF(41)
     '  If CkbSeqNum.Value = -1 Then
        Input #41, IExs, IJus, stImarkes(1), stImarkes(2), stImarkes(3), stImarkes(4), stImarkes(5), stImarkes(6), SeqNo
     ' Do these checks for Apperson Benchmark 3000 DES 4.0.4.  Do here and do not have to repeat in actual data read
        If Len(SeqNo) <> 7 Then  ' length is always 7 characters
             FmtOk = False
        Else   'length ok
             For iIgg = 1 To 3
               IEx = Asc(Mid(SeqNo, iIgg, 1))
               If Asc(Mid(SeqNo, iIgg, 1)) < 65 Or Asc(Mid(SeqNo, iIgg, 1)) > 90 Then FmtOk = False   ' Not 'A' to 'Z'
                 Next iIgg
              For iIgg = 4 To 7
               IEx = Asc(Mid(SeqNo, iIgg, 1))
               If Asc(Mid(SeqNo, iIgg, 1)) < 48 Or Asc(Mid(SeqNo, iIgg, 1)) > 57 Then FmtOk = False  ' Not numeric
              Next iIgg
        End If
        If FmtOk = False Then
             MsgBox "Data File has incorrect format!" & vbCrLf & _
             "The last variable in one or more records is not the expected" & vbCrLf & _
             "BatchSequence string ('AAA0000' to 'ZZZ9999')" & vbCrLf & _
             "NO DATA READ - Input Aborted!"
             EnableButtons (True)
             Close #41
             Exit Sub
        End If
        RecNo = Mid(SeqNo, 4, 4)
     '  Else
     '    Input #41, IExs, IJus, stImarkes(1), stImarkes(2), stImarkes(3), stImarkes(4), stImarkes(5), stImarkes(6)
     '  End If
       IEx = IExs
       IJu = IJus
       If IEx > 0 And IJu > 0 Then
          CSVRecordcount = CSVRecordcount + 1
       End If
       If EOF(41) Then Exit Do
       If IEx = 0 And IJu = 0 And CSVRecordcount > 0 Then Exit Do 'column headers as 1st record iex=0,ju = 0
       If Mid(SeqNo, 1, 3) <> "ZZZ" And FirstSeqInt = 0 Then  ' rev 547 5.4.7  we found the first good sequence number.
            ' FileLen = FileLen + 1  ' rev 547  5.4.7   only count the good sequence numbers.
            If IsNumeric(Mid(SeqNo, 4, 4)) Then
              FirstSeqInt = Val(Mid(SeqNo, 4.4))
              FirstSeqAlpha = Mid(SeqNo, 1, 3)
              FirstSeqStr = SeqNo
            End If
       End If   ' end rev 547 5.4.7 add
    Loop
GotEOF:
  On Error GoTo SubError
  If CSVRecordcount = 0 Then
       MsgBox "Empty Data FILE - or Incorrect File Format!  No Records Read"
       Close #41
       EnableButtons (True)
       Exit Sub
  End If
  Close #41
  DebugTrace = 8876   ' closed 411 if error
  ' ----------------------------------------------
  '  rev 547  5.4.7  This code will attempt to see if we missed reading the previous file from this scanner
  '  at this point we may or may not have the first good sequence number in this file.

  If FirstSeqStr <> "NoCheck" Then
      ' If I could not find a good FirstSeqStr then skip all tests
   If FirstSeqInt > 1 Then
      ' If I found a good firstSeqStr and this is not the first file read (seq 000  or 001 is first
      ' form the previous sequence number to search for in the files
      LastSeqStr = FirstSeqAlpha & Format(FirstSeqInt - 1, "0000")
      ' Start a file search in the same path for a file that has this in it that has impxx as the first characters
      '  TBD later
      Dim foundFile As String
      Dim fso As New FileSystemObject
      Dim myfolder As folder
      Set myfolder = fso.GetFolder(FilePath(StrFilePathName))
      Dim thefiles As Files
      Set thefiles = myfolder.Files
      Dim afile As File
      Dim foundit As Boolean
      foundit = False
      For Each afile In thefiles
       foundFile = afile.Name
       If (Mid(foundFile, 1, 3)) = "imp" Then ' this is an imported file
          If InStr(foundFile, LastSeqStr) Then  '   great found it right away
             foundit = True
             Exit For
          End If
       End If
      Next
      If foundit = False Then   ' have to search each file for the string
        For Each afile In thefiles
          foundFile = afile.Name
          If (Mid(foundFile, 1, 3)) = "imp" Then ' this is an imported file
             Dim TxtStream As TextStream
             Dim line As String
             Set TxtStream = afile.OpenAsTextStream
             Do
                If TxtStream.AtEndOfStream Then Exit Do
                line = TxtStream.ReadLine
                If line = "" Then
                  Exit Do
                Else
                  If InStr(1, line, LastSeqStr) Then
                     foundit = True
                     Exit Do
                  End If
                End If
             Loop
             TxtStream.Close
          End If
          If foundit = True Then Exit For
        Next
      End If  ' end of searcing text in files
      If foundit = False Then
       MsgBox "Warning Only:  You may have skiped importing a file" & vbCrLf & _
       "I could not find an imported file with the previous sequence number (" & LastSeqStr & ")" & vbCrLf & _
       " I will continue importing this file, You may want to look for file not imported."
      End If
   End If  ' if firstseqint > 1
  End If   ' if FirstSeqStr <> "NoCheck"

  ' end of checking for prev file   rev 547  5.4.7
  ' ------------------------------------------------------------
 
  Open StrFilePathName For Input As #411
  CurrentRec = 0
  ChangedForm = False  ' set true if the underlying data for the form displayed exhibit changes
  HadOneWithMsgMark = False
  '  Form.TimerInterval = 200  ' set timer interval Milliseconds
  ' moved to other locations timer is active so every interval it does the timer event
  EnableButtons (False)
  tbRecord.SetFocus
  tbRecord.Text = "Rec " & CurrentRec & "/" & CSVRecordcount
'  For iIgg = Len(ImportDataDialog.FileName) To 1 Step -1
'   If Mid(ImportDataDialog.FileName, iIgg, 1) = "\" Or _
'    Mid(ImportDataDialog.FileName, iIgg, 1) = ":" Then Exit For
'  Next
'  FileName = Mid(ImportDataDialog.FileName, iIgg + 1, Len(ImportDataDialog.FileName))
  tbLastFile.SetFocus
  tbLastFile.Text = FileNameOnly(StrFilePathName)
  btnDoNothing.SetFocus
  RecNo = 0   ' set this in case we are not reading the Form ID Number
 With Scores
 DebugTrace = 0  ' ALL the debugtrace's may be eliminated after the error 7878 is eliminated
' Read all the data in the file and process each 'record' (given number of values)
  Do
      ' This is used to see if I can figure out if sequence (record) numbers are included
      ' Not needed - SeqNo is always included
      RecNo = -31477  '
      IEx = -1
      IExs = ""
      FmtOk = True
      'If CkbSeqNum.Value = -1 Then   ' -1 = checked    0 = unchecked   ???
      'NOTE  DES 4.0.4  With the Apperson scanner export data we get an EOF error 62 after the last record
      ' so no code is executed past the input on the last input try
          Input #411, IExs, IJus, stImarkes(1), stImarkes(2), stImarkes(3), stImarkes(4), stImarkes(5), stImarkes(6), SeqNo
          RecNo = Mid(SeqNo, 4, 4)  'will be a number from 0000 to 1000 (0999 if operators set up scanner per instructions)
      'Else
      '    Input #411, IExs, IJus, stImarkes(1), stImarkes(2), stImarkes(3), stImarkes(4), stImarkes(5), stImarkes(6)
      'End If
     ' Should never get an error here because checked entire file above to get record count etc
      IEx = IExs
      IJu = IJus
      For iIgg = 1 To 6                   ' Imarkes are as read from the file
        Imarkes(iIgg) = stImarkes(iIgg)
      Next iIgg
      
      'If IJus = 829 Then
      '  IJus = 829       ' debug remove later
      'End If
 '     For iIgg = 1 To 6            '  REVERSE THE CODES FROM THE Beta Test version of APPERSON SCANNER
 '        Imarkes(iIgg) = 6 - Imarkes(iIgg)  '0->6, 1->5, 2->3,  3->3, 4->4, 5->1, 6->0, 7->-1
 '        If Imarkes(iIgg) = -1 Then Imarkes(iIgg) = 7
 '        If Imarkes(iIgg) = 0 Then Imarkes(iIgg) = 8   ' hold the previous 6 for now should never happen
 '        If Imarkes(iIgg) = 6 Then Imarkes(iIgg) = 0
 '        If Imarkes(iIgg) = 8 Then Imarkes(iIgg) = 6    ' should never happen
 '     Next iIgg
     ' Next should never happen with Apperson scanner
      If IEx > 0 And IJu > 0 Then  '4.0.4 never have 0,0,0,0,0,0 records
         CurrentRec = CurrentRec + 1
       '  LOCATION = CSVRecordcount - CurrentRec + 1
      End If
      DebugTrace = 101
'rev 4.0.3      If EXN <> IEx Then  ' I think this solved the 7878 error on setting tbRecord.Text when
      If ChangedForm = False Then   ' I think this solved the 7878 error on setting tbRecord.Text when
                          ' anytime after any change in the Form Data. The 'Else' statement
                          ' below does a refresh then the doevents lets the update finish.
                          ' I even put in a wait to make sure events finish prior to
                          ' the next record causing a textbox update
         tbRecord.SetFocus
         DebugTrace = 102
         tbRecord.Text = "Rec " & CurrentRec & "/" & CSVRecordcount
         DebugTrace = 103
         'Form.Refresh is not needed to make the text box show.
         DebugTrace = 104
         DoEvents
         DebugTrace = 105
      Else   ' here we must do the form.refresh and doevents loop to avoid error 7878
         Form.Refresh  ' command the form to update from the changed underlying data
         ' the timer is set to 200 MS so if i do two loops, then min delay = 200ms, max delay = 400 msec
         Form.TimerInterval = 200  ' set timer interval Milliseconds
         TimerDone = False  ' this is turned true every time the timer clicks
         Do While TimerDone = False
           DoEvents
         Loop
         TimerDone = False  ' this is turned true every time the timer clicks
         Do While TimerDone = False
           DoEvents
         Loop
         Form.TimerInterval = 0   ' turn it off after used it
         '  now should be ok to update the text
         tbRecord.SetFocus
         DebugTrace = 202
         tbRecord.Text = "Rec " & CurrentRec & "/" & CSVRecordcount
         DebugTrace = 203
         ChangedForm = False  '  refresh and doevents not required again until set true
      End If
      btnDoNothing.SetFocus
      RecStatus = ""
    DebugTrace = 1
   .MoveFirst
   DebugTrace = 3
   CurLine = ""
   .FindFirst ("EXN = " & IEx & " AND JUN = " & IJu)
   If .NoMatch Then
           ' --------------------------See if records are too short --------------------
    '  If NumRecordsRead = 1 And IJu < 8 And RecNo <> -31477 Then
    '        ' This assumes the first record has a valid Exhibit, Judge pair and reads OK
    '        ' rev 2.4.0 If the box IS checked and there is NO ID (Recno) in file then
    '        ' the second record read will have a judge number in Iex and a CAS score in Iju
    '        ' So there will be .NoMatch, perhaps no such exhibit, and no such judge for sure
    '          MsgBox "Incorrect File Format: If the import file does NOT have Form ID numbers then " & vbCrLf & _
    '                " you must Un-check the box titled 'Score Form ID in Score File' " & vbCrLf & _
    '                " AND.. You must RE-READ THIS FILE"
    '         Msg = Msg & "File Read TERMINATED!  Re-read this File"
    '         DoTextBox (ChangedForm)
    '         ChangedForm = False
    '         Close #411
    '         Form.TimerInterval = 0
    '         EnableButtons (True)
    '         btnImport.SetFocus
    '         Exit Sub
    '  End If
    '  -------------   see if records are too long  ------------------------------
            ' This assumes the first record has a valid Exhibit, Judge pair and reads OK
           ' I.E. the box is NOT checked but recNo (form id) IS  in the file.  In this case RecNo in not in input
           ' statement and will not be changed. The second read will put a file RecNo into the Iex and
         '  Iju will probably be and exhibit number and CAS will be a Judge number.
     ' If RecNo = -31477 Then  ' rev 2.4.0  the box is not checked and there may be a sequence num in
     '                                 ' the imported data.  if so, the next imarkes (1) will prob be > 8
     '     If NumRecordsRead = 1 And Imarkes(1) > 8 Then
     '        MsgBox "Incorrect File Format: If the import file HAS Form ID numbers then " & vbCrLf & _
     '               " You must CHECK the box titled 'Xcore Form ID in Score File' " & vbCrLf & _
     '               " AND.. You must RE-READ THIS FILE"
     '        Msg = Msg & "File Read TERMINATED!  Re-read this File"
     '        DoTextBox (ChangedForm)
     '        ChangedForm = False
     '        Close #411
     '        Form.TimerInterval = 0
     '        EnableButtons (True)
     '        btnImport.SetFocus
     '        Exit Sub
     '     End If
     ' End If
        ' ----------------Check Exhibit and Judge Numbers ----------------------------
      .FindFirst ("EXN = " & IEx)
      '  AT THIS POINT RecStatus is ""
      If .NoMatch Then
          RecStatus = RecStatus & " **No Such Exhibit: "
      End If
      .MoveFirst
      .FindFirst ("JUN = " & IJu)
      If .NoMatch Then
          RecStatus = RecStatus & " **No Such Judge: "
      End If
      ' -----------------Very First Record has No match ----------------------
 '     If NumBadRecords = 0 And NumRecordsRead = 0 And Len(RecStatus) > 1 Then
 '           MsgBox "Incorrect File Format: First Record! Possible Causes:" & vbCrLf & _
 '                  "First record has the column names" & vbCrLf & _
 '                   "EXN, JUN are not a valid pair for this Fair" & vbCrLf & _
 '                  "Wrong number of values in the record - Must be 8 or 9(if Record ID)" & vbCrLf & _
 '                  "'Score Form ID in Score' Check Box set wrong." & vbCrLf & _
 '                  "Non-Numeric values, values not separated by commas, ETC." & vbCrLf & _
 '                  "CHECK THE FILE VALUES AND FORMAT!" & vbCrLf & _
 '                  "NO RECORDS READ, FIX FILE AND READ AGAIN"
 '            Msg = Msg & "File Read TERMINATED!  Re-read this File"
 '            DoTextBox (ChangedForm)
 '            ChangedForm = False
 '            Close #411
 '            Form.TimerInterval = 0
 '            EnableButtons (True)
 '            btnImport.SetFocus
 '            Exit Sub
 '     End If
        '--4.0.4 should not happen with apperson scanner -- SEE IF RECORD SIGNIFIES EOF  (last record contains all zeroes)
      If EOF(411) Or IEx = 0 And IJu = 0 Then '
          CurLine = "EOF Record (0,0,0..):  " & NumRecordsRead & _
           " Valid Records Read   "
          msg = msg & CurLine
           If NumBadRecords > 0 Then
             CurLine = "(" & NumBadRecords & " Bad records)"
             msg = msg & CurLine
           End If
           CurLine = CurLine & vbCrLf
           msg = msg & vbCrLf
           Exit Do
      End If
      NumBadRecords = NumBadRecords + 1   'rev 2.4.0
      If RecStatus = "" Then  ' both exh and jun exist
         RecStatus = " **Judge Not Assigned: "
      End If
      CurLine = RecStatus & "Ex " & IEx & ", Ju " & IJu & " Marks: " & _
                       Imarkes(1) & ", " & Imarkes(2) & ", " & Imarkes(3) & ", " & _
                       Imarkes(4) & ", " & Imarkes(5) & ", " & Imarkes(6)
        
      'If CkbSeqNum.Value = -1 Then
           CurLine = CurLine & " BSeq = " & SeqNo & vbCrLf ' " Loc= " & LOCATION & " " & vbCrLf
      'Else
      '     CurLine = CurLine & " Loc= " & LOCATION & " " & vbCrLf
      'End If
      msg = msg & CurLine
      DoTextBox (ChangedForm)
      ChangedForm = False
      If MsgBox("Input Error or Bad Record" & vbCrLf & _
                "Do you want to Continue Reading?" & vbCrLf & vbCrLf & _
                "Normally [Yes]", vbYesNo + vbDefaultButton1, "Error in Import File") = vbNo Then
           MsgBox "All Remaining Records will be skipped!" & vbCrLf & _
                  "Fix the problem and RE-READ the File!"
           CurLine = CurLine & " USER ABORTED READ " & _
                     NumRecordsRead & " Valid Records Read   " & vbCrLf
           msg = msg & " USER ABORTED FILE READ! " & _
                     NumRecordsRead & " Valid Records Read   " & vbCrLf
           Exit Do
      End If
   Else   ' ---- Have a Record with data that jun and Exn match a record in ExhibitJudges
        ' DO NOT list the good records or errors here - will overflow the text box
       DebugTrace = 4
       CurLine = "Good Rec: Ex= " & IEx & " Ju= " & IJu & " Mks " & Imarkes(1) & " " & Imarkes(2) & " " & Imarkes(3) & " " & Imarkes(4) & " " & _
        Imarkes(5) & " " & Imarkes(6) & " " & SeqNo & vbCrLf
        ' The Format of the Records is:
        'Exhibit Number, Judge Number, Creative Ability, Scientific Thought, Thoroughness, Skill, Clarity, Teamwork, RecNum (new 2008)
        'rev 547  5.4.7  new as of 2014 RC  The order may change when we redesign the form.
        'Exhibit Number, Judge Number, Research, Design/Methodology, Datacollection/construction, Creativity, Display, Interview(with teamwork if Applicable
        DebugTrace = 5
        .Edit
        DebugTrace = 6
        ' REV 548DES  5.4.8DES
        Scores!CR1 = Imarkes(1)
        !CR2 = Imarkes(2)
        DebugTrace = 7
        !CR3 = Imarkes(3)
        !CR4 = Imarkes(4)
        DebugTrace = 8
        !CR5 = Imarkes(5)
        !CR6 = Imarkes(6)
        DebugTrace = 9
        !NTR = IIf(IsNull(!NTR), 0, !NTR) + 1
        !BSeq = SeqNo      'DES 4.0.4      this will help locate judges forms if they want them back!
        DebugTrace = 10
         .Update
        DebugTrace = 11
        ' Does not update or change SCORE_OVERRIDE.
        ' IF Invalid or SCORE_OVERRIDE then does not change SCORE
        If IEx = EXN Then  ' Try this to avoid err 7878
           ChangedForm = True   ' NOW, dotext will refresh the form, wait up to 1 second for doevents to process
                             ' the refresh  - to avoid error 7878
'           Form.Refresh  ' This is probably redundant but I will do it anyway
'           DoEvents
        End If
        ' Rev 5.4.1 ScoreStaus updated to check UseTeamworkMark
        ScoreStatus = ExhScore(IEx)
        DebugTrace = 12
     If ListMsgDbl = True Then '  -------------------------  REPORT MISSING/Multiple MARKS ---------------------------------------
       ' remove  ALL OF THIS and replace with below   rev 5.4.7  547
       ' If Imarkes(1) = 0 Or Imarkes(2) = 0 Or Imarkes(3) = 0 Or Imarkes(4) = 0 Or Imarkes(5) = 0 Then     '
       '   DebugTrace = 18
       '   If Imarkes(1) = 0 And Imarkes(2) = 0 And Imarkes(3) = 0 And Imarkes(4) = 0 And Imarkes(5) = 0 Then
       '     '  all marks missing
       '       msg = msg & "No Marks EXN: " & IEx & "  JUN: " & IJu & _
       '          " Marks: " & Imarkes(1) & " " & Imarkes(2) & " " & Imarkes(3) & " " & Imarkes(4) & " " & _
       '          Imarkes(5) & " " & Imarkes(6)
       '       HadOneWithMsgMark = True
       '   Else
       '     '  one or more missing
       '     'Rev 5.4.0  Changed TEAM to TeamEx or TEAM
       '     ' rev 5.4.1  need to check if we are using teamwork (global option)
       '      msg = msg & _
       '      "Missing " & IIf(Imarkes(1) = 0, "CAS ", "") & IIf(Imarkes(2) = 0, "STS ", "") & IIf(Imarkes(3) = 0, "THS ", "") & _
       '      IIf(Imarkes(4) = 0, "SKS ", "") & IIf(Imarkes(5) = 0, "CLS ", "") & _
       '      IIf((UseTeamworkMark = True And (TeamEx = True Or TEAM = True)), IIf(Imarkes(6) = 0, "TWS", ""), "") & " Mark(s) EXN: " & IEx & "  JUN: " & IJu & _
       '      " Marks: " & Imarkes(1) & " " & Imarkes(2) & " " & Imarkes(3) & " " & Imarkes(4) & " " & _
       '      Imarkes(5) & " " & Imarkes(6)
       '
       '      DebugTrace = 19
       '      HadOneWithMsgMark = True
       '   End If
       '   ' If CkbSeqNum.Value = -1 Then
       '       msg = msg & " BSeq= " & SeqNo & vbCrLf   '" Loc= " & LOCATION & " " & vbCrLf
       '   ' Else
       '   '    Msg = Msg & " Loc= " & LOCATION & " " & vbCrLf
       '   ' End If
       '    DoTextBox (ChangedForm)
       '    ChangedForm = False
       ' Else  ' ALL MARKS in nonteam scores so see if team if teamscore is blank
       '   'Rev 5.4.0
       '
       '   'If !TEAM = True And Imarkes(6) = 0 Then    ' verify team score not blank
       '   ' Rev 5.4.1   must check if using teamwork in evaluations for teams
       '
       '   If (!TeamEx = True Or !TEAM = True) And UseTeamworkMark = True And Imarkes(6) = 0 Then   ' verify team score not blank
       '     DebugTrace = 20
       '     msg = msg & _
       '      "NO Teamwork Mark Team EXN: " & IEx & "  JUN: " & IJu & _
       '       " Marks: " & Imarkes(1) & " " & Imarkes(2) & " " & Imarkes(3) & " " & Imarkes(4) & " " & _
       '       Imarkes(5) & " " & Imarkes(6)
       '     '  If CkbSeqNum.Value = -1 Then
       '         msg = msg & " BSeq= " & SeqNo & vbCrLf '" Loc= " & LOCATION & " " & vbCrLf
       '     ' Else
       '     '    Msg = Msg & " Loc= " & LOCATION & " " & vbCrLf
       '     ' End If
       '       DebugTrace = 21
       '      DoTextBox (ChangedForm)
       '      ChangedForm = False
       '       HadOneWithMsgMark = True  ' do only one message later
       '   End If
       ' End If
       ' '  -------------------------  REPORT MULTIPLE MARKS ---------------------------------------
       ' If Imarkes(1) = 7 Or Imarkes(2) = 7 Or Imarkes(3) = 7 Or Imarkes(4) = 7 Or Imarkes(5) = 7 Then     ' verify team score not blank
       '   DebugTrace = 181
       '   If Imarkes(1) = 7 And Imarkes(2) = 7 And Imarkes(3) = 7 And Imarkes(4) = 7 And Imarkes(5) = 7 Then
       '     '  all marks doubleg
       '       msg = msg & "ALL Double Marks EXN: " & IEx & "  JUN: " & IJu & _
       '          " Marks: " & Imarkes(1) & " " & Imarkes(2) & " " & Imarkes(3) & " " & Imarkes(4) & " " & _
       '          Imarkes(5) & " " & Imarkes(6)
       '       HadOneWithMsgMark = True
       '   Else
       '     '  one or more missing
       '     'Rev 5.4.0  changed TEAM to TeamEx or TEAM
       '     'Rev5.4.1  need to have option for using or NOT using teamwork (Imarkes(6)  )
       '      msg = msg & _
       '      "Multiple " & IIf(Imarkes(1) = 7, "CAS ", "") & IIf(Imarkes(2) = 7, "STS ", "") & IIf(Imarkes(3) = 7, "THS ", "") & _
       '      IIf(Imarkes(4) = 7, "SKS ", "") & IIf(Imarkes(5) = 7, "CLS ", "") & _
       '      IIf((UseTeamworkMark = True And (TEAM = True Or TeamEx = True)), IIf(Imarkes(6) = 7, "TWS", ""), "") & " Mark(s) EXN: " & IEx & "  JUN: " & IJu & _
       '     " Marks: " & Imarkes(1) & " " & Imarkes(2) & " " & Imarkes(3) & " " & Imarkes(4) & " " & _
       '      Imarkes(5) & " " & Imarkes(6)
       '      DebugTrace = 191
       '      HadOneWithMsgMark = True
       '   End If
       '  '  If CkbSeqNum.Value = -1 Then
       '       msg = msg & " BSeq= " & SeqNo & vbCrLf '" Loc= " & LOCATION & " " & vbCrLf
       '  '  Else
       '  '     Msg = Msg & " Loc= " & LOCATION & " " & vbCrLf
       '  '  End If
       '    DoTextBox (ChangedForm)
       '    ChangedForm = False
       ' Else  ' No multilple MARKS in nonteam scores so see if team if teamscore is multiple marked
       '   ' Rev 5.4.0
       '   'If !TEAM = True And Imarkes(6) = 7 Then    ' verify team score not blank
       '   ' rev 5.4.1  need to check option if we are using teamwork in evaluation for teams
       '   If (!TeamEx = True Or !TEAM = True) And UseTeamworkMark = True And Imarkes(6) = 7 Then    ' verify team score not blank
       '     DebugTrace = 201
       '     msg = msg & _
       '      "Multiple Teamwork Mark Team EXN: " & IEx & "  JUN: " & IJu & _
       '       " Marks: " & Imarkes(1) & " " & Imarkes(2) & " " & Imarkes(3) & " " & Imarkes(4) & " " & _
       '       Imarkes(5) & " " & Imarkes(6)
       '     '  If CkbSeqNum.Value = -1 Then
       '         msg = msg & " BSeq= " & SeqNo & vbCrLf   '" Loc= " & LOCATION & " " & vbCrLf
       '     ' Else
       '     '    Msg = Msg & " Loc= " & LOCATION & " " & vbCrLf
       '     ' End If
       '
       '       DebugTrace = 211
       '      DoTextBox (ChangedForm)
       '      ChangedForm = False
       '       HadOneWithMsgMark = True  ' do only one message later
       '   End If
       ' End If
      ' end of section deleted rev 547  5.4.7
      '  Start of new code for rev 5.4.7  547
        If Imarkes(1) = 0 Or Imarkes(2) = 0 Or Imarkes(3) = 0 Or Imarkes(4) = 0 Or Imarkes(5) = 0 Or Imarkes(6) = 0 Then     ' have one or more
          DebugTrace = 18
          If Imarkes(1) = 0 And Imarkes(2) = 0 And Imarkes(3) = 0 And Imarkes(4) = 0 And Imarkes(5) = 0 And Imarkes(6) = 0 Then
            '  all marks missing
              msg = msg & "No Marks EXN: " & IEx & "  JUN: " & IJu & _
                 " Marks: " & Imarkes(1) & " " & Imarkes(2) & " " & Imarkes(3) & " " & Imarkes(4) & " " & _
                 Imarkes(5) & " " & Imarkes(6)
          Else
            '  one or more missing but not all  rev 550DES 5.5.0DES Changed R-1, R-2... to Cr1,Cr2  etc for better clarity to user
             msg = msg & _
             "Missing " & IIf(Imarkes(1) = 0, "Cr1 ", "") & IIf(Imarkes(2) = 0, "Cr2 ", "") & IIf(Imarkes(3) = 0, "Cr3 ", "") & _
                          IIf(Imarkes(4) = 0, "Cr4 ", "") & IIf(Imarkes(5) = 0, "Cr5 ", "") & IIf(Imarkes(6) = 0, "Cr6 ", "") & _
             " Mark(s) EXN: " & IEx & "  JUN: " & IJu & _
             " Marks: " & Imarkes(1) & " " & Imarkes(2) & " " & Imarkes(3) & " " & Imarkes(4) & " " & _
             Imarkes(5) & " " & Imarkes(6)
          End If
          HadOneWithMsgMark = True
          msg = msg & " BSeq= " & SeqNo & vbCrLf '" Loc= " & LOCATION & " " & vbCrLf
          DebugTrace = 21
          DoTextBox (ChangedForm)
          ChangedForm = False
        End If
       ' '  -------------------------  REPORT MULTIPLE MARKS ---------------------------------------
        If Imarkes(1) = 7 Or Imarkes(2) = 7 Or Imarkes(3) = 7 Or Imarkes(4) = 7 Or Imarkes(5) = 7 Or Imarkes(6) = 7 Then  ' se if any double marks
          DebugTrace = 181
          If Imarkes(1) = 7 And Imarkes(2) = 7 And Imarkes(3) = 7 And Imarkes(4) = 7 And Imarkes(5) = 7 And Imarkes(6) = 7 Then
            '  all marks double
              msg = msg & "ALL Double Marks EXN: " & IEx & "  JUN: " & IJu & _
                 " Marks: " & Imarkes(1) & " " & Imarkes(2) & " " & Imarkes(3) & " " & Imarkes(4) & " " & _
                 Imarkes(5) & " " & Imarkes(6)
          Else
            '  one or more double but not all rev 550DES 5.5.0DES Changed R-1, R-2... to Cr1,Cr2  etc for better clarity to user
             msg = msg & _
             "Multiple " & IIf(Imarkes(1) = 7, "Cr1 ", "") & IIf(Imarkes(2) = 7, "Cr2 ", "") & IIf(Imarkes(3) = 7, "Cr3 ", "") & _
                           IIf(Imarkes(4) = 7, "Cr4 ", "") & IIf(Imarkes(5) = 7, "Cr5 ", "") & IIf(Imarkes(6) = 7, "Cr6", "") & _
                           " Mark(s) EXN: " & IEx & "  JUN: " & IJu & _
            " Marks: " & Imarkes(1) & " " & Imarkes(2) & " " & Imarkes(3) & " " & Imarkes(4) & " " & _
             Imarkes(5) & " " & Imarkes(6)
             DebugTrace = 191
          End If
          msg = msg & " BSeq= " & SeqNo & vbCrLf '" Loc= " & LOCATION & " " & vbCrLf
          DoTextBox (ChangedForm)
          ChangedForm = False
          DebugTrace = 211
          DoTextBox (ChangedForm)
          ChangedForm = False
          HadOneWithMsgMark = True  ' do only one message later - actually not used rev 547 5.4.7
        End If
      '  end of new code for rev 5.4.7  547
     End If ' ------------------------------  END REPORTS of MISSING or MULTIPLE MARKS ---------------------------
     NumRecordsRead = NumRecordsRead + 1   ' rev 2.4.0   number of good records
   End If  ' if .nomatch else
  Loop
 '  Msg = Msg & vbCrLf & "End Of File:  " & NumRecordsRead & _
 '  " Good Records Entered,    " & NumBadRecords & " Bad Records Skipped "
 ' Note:  We never get here importing data from the apperson scanner exported data
 '         Because the EOF causes an error 62 in the input statement.
HereIfEOF:
  End With
  Close #411
  Dim Badifbad As String
  Badifbad = ""
  If NumBadRecords > 0 Then
     Badifbad = ",   " & NumBadRecords & " Bad Records"
  End If
  msg = msg & vbCrLf & "End Of File:  " & NumRecordsRead & _
      " Good Records" & Badifbad
  DoTextBox (ChangedForm) ' ******** THIS IS THE ONE THAT SEEM TO CAUSE ERROR 7878 **************************
  ChangedForm = False
 ' -----   Rename the file as imported
  strFileName = StrFilePathName
  strFileName = FileNameOnly(strFileName)    ' get just the name
  If Mid(strFileName, 1, 3) = "Imp" Then
     ' this has already been imported at least once
     'Dim GetNum As String
     Dim IntNum As Integer
     IntNum = Mid(strFileName, 4, 2)
     IntNum = IntNum + 1
     strFileName = "Imp" & Format(IntNum, "00") & "-" & Mid(strFileName, 7, Len(strFileName) - 6)
  Else
     ' first time imported
     strFileName = "Imp01-" & strFileName     ' have the new name
  End If
  strFileName = FilePath(StrFilePathName) & strFileName  ' have complete new path name
  'Call My.computer.FileSystem.renamefile(ImportDataDialog.FileName, StrFileName)
  ' DES rev 540  the error trap seems to be disabled at this point.
  ' See if strFileName exists  error 58
  ' can not do On Error GoTo SubError since are already in an error state.
  If Dir(strFileName) <> "" Then
     MsgBox "Can not increment File Name. File " & strFileName & " Exists!"
  Else
     Name StrFilePathName As strFileName
  End If
' ---------------
  Form.Refresh
  Form.TimerInterval = 0
  EnableButtons (True)
  '  rev 5.3.7  highlight the upload scores button after an import.
  btUpDateWebScores.SetFocus
  btUpDateWebScores.Caption = "Update Website Scores Soon"
  btUpDateWebScores.ForeColor = &HFF
  tbLastFile.SetFocus
  tbLastFile.Text = FileNameOnly(strFileName)
  
  btnImport.SetFocus
  'Exit Sub
' DoTextBox (ChangedForm)  ' All done so do it here
' ChangedForm = False
' If HadOneWithMsgMark = True Then
'       MsgBox "One or more Exhibits With Missing OR Double Mark(s)" & vbCrLf & _
'              "No Action required if these were pulled at read station."
'      HadOneWithMsgMark = False
' End If
 'Close #411
 'Form.Refresh   ' Probably not needed since I do a form refresh every time .Update executes
 'Form.TimerInterval = 0
 'EnableButtons (True)
 'btnImport.SetFocus
 Exit Sub ' Good Exit
ErrorHandler1: ' User pressed cancel or other error in dialog box
   MsgBox "Canceled! No Action Taken"
   'SFMain.mProgressBar.Value = 0
   Form.TimerInterval = 0
   EnableButtons (True)
   btnImport.SetFocus
   Exit Sub ' no need to inform operator of her own aciton
SubError:
  ' already open , eof or input error
  ' If (DebugTrace = 102 Or DebugTrace = 202) And Err.Number = 7878 Then
   If DebugTrace = 8877 Then
     Close #41
   End If
   If Err.Number = 7878 Then
     MsgBox "Processing Faster than Updates @ step " & DebugTrace & " IEX=" & IEx & "  EXN = " & EXN & vbCrLf & _
            "Report this error to Dennis Spanogle" & vbCrLf & _
            "No Big Problem, Just Click [OK] and RE-READ the file!" & vbCrLf & _
            "READ INVALID, FILE READ ABORTED!" & vbCrLf & _
            " YOU MUST RE-READ THIS FILE until this message does not occur!"
    Close #411
    Form.TimerInterval = 0
    EnableButtons (True)
    btnImport.SetFocus
    Exit Sub
    ' Resume
   End If
   Close #411
   ' Notes if tries to read next variable and gets end of file, the variable is set to 0
   '  Thus if the last record has no CRLF, tries to read Iex, Iju ... then Iex is next
   '  expected so is returned as 0
   '  This is also when last record IS ended with end of record (Cr/Lf) and there is
   ' no ending record with 0,0,0,0,0,0
   If Err.Number = 62 And IEx = -1 Or IEx = 0 Then  ' Rev 2.3.7  Error 62 is file EOF
      GoTo HereIfEOF
    '   Dim Badifbad As String
    '   Badifbad = ""
    '   If NumBadRecords > 0 Then
    '     Badifbad = ",   " & NumBadRecords & " Bad Records"
    '   End If
    '    Msg = Msg & vbCrLf & "End Of File:  " & NumRecordsRead & _
    '    " Good Records" & Badifbad
    '   DoTextBox (ChangedForm) ' ******** THIS IS THE ONE THAT SEEM TO CAUSE ERROR 7878 **************************
    '   ChangedForm = False
    '  Form.TimerInterval = 0
    '  EnableButtons (True)
    '  btnImport.SetFocus
    '  Exit Sub
   End If
   ' comes here if EOF in middle of a record
   If Err.Number = 62 Then
      msg = msg & "Error: Unexpected CSV Format" & vbCrLf & NumRecordsRead & _
   " Good Records Entered,    " & NumBadRecords & " Bad Records Skipped "
      DoTextBox (ChangedForm)
      ChangedForm = False
       MsgBox "Unexpected CSV Import File format" & vbCrLf & _
             Err.Description & vbCrLf, vbCritical, "Import File Error"
      Form.TimerInterval = 0
      EnableButtons (True)
      btnImport.SetFocus
      Exit Sub
   End If
   If Err.Number = 2176 Then
      ' size of msg is too big for the textbox
      MsgBox "Too many Bad Records to display in the textbox." & vbCrLf & _
      "Please break this file into two parts and re-read it"
      Form.TimerInterval = 0
      EnableButtons (True)
      btnImport.SetFocus
      Exit Sub
   End If
   'Not one of the above
   MsgBox "Error in Import Code: " & Err.Description, , "Error in Import"
   Form.TimerInterval = 0
   EnableButtons (True)
   btnImport.SetFocus
   Exit Sub
      'SFMain.mProgressBar.Value = 0
End Sub

Private Sub btnOverrideScore_Click()
' This overrides one score - the one displayed in the form.
   Dim InputStr As String
   On Error GoTo SubError
   MsgBox "Disabled! Use Enter Final Scores Local.": Exit Sub    '  rev 547  5.4.7 changed text
DoAgain:
   InputStr = InputBox("Enter the New Score or [Cancel]" & vbCrLf & _
   "Enter '0' to 100.00 to Override" & vbCrLf & _
   "'Blank' is same as [Cancel]", "Score Override", IIf(IsNull(SCORE), "", SCORE))
   If Len(InputStr) = 0 Then
     Exit Sub
   Else
     If Val(InputStr) <= 100# And Val(InputStr) >= 0# Then
       SCORE = InputStr
       SCORE_OVERRIDE = True
       Form.Refresh
       ChangedForm = True  ' assume changed so text dotextbox does not create error
       Exit Sub
      Else
        GoTo DoAgain
      End If
   End If
   Exit Sub
SubError:
   MsgBox "Error Override Score Input: " & Err.Description
End Sub

Private Sub btnRemoveOverride_Click()
  ' Nothing happens unless SCORE_OVERRIDE = -1  (is checked)
    MsgBox "Disabled! Use Clear Category Final Download.": Exit Sub    ' rev 547 5.4.7 changed text
   
   If SCORE_OVERRIDE = -1 Then  ' checked = -1 unchecked = 0  (Tried to unset it)
           ScoreStatus = ExhScore(EXN)
           SCORE_OVERRIDE = 0
          ChangedForm = True  ' assume changed so text dotextbox does not create error
           Form.Refresh
   End If
End Sub
Private Sub cbEXN_AfterUpdate()
    ' Find the record that matches the control.
   On Error GoTo SubError
    If (IsNull(cbEXN)) Then
       'MsgBox "Nothing Selected!"
       'cbEXN.SetFocus
       Exit Sub
    End If
    Me.Recordset.FindFirst "EXN = " & Str(Me![cbEXN])
    Me.cbEXN = Null
    'Me.cbFindStudent = Null
Exit Sub
SubError:
   MsgBox Err.Description
End Sub

Private Sub Form_Timer()
  ' The Timer is turned on (and off) in the btnImport_Click routine.
  ' It is used to time a loop of doevents to allow database to update and form to refresh
  ' From underlying data - this avoiding errors 7878 (The Data Has Changed)
  ' The loops are exited when 'TimerDone' variable is set to true.
   TimerDone = True
End Sub


Private Sub TO_STATE_AfterUpdate()
   TO_STATE = UCase(TO_STATE)
   Me.Requery  ' rev 5.3.3  so puts into data base for scores upload to website
   
End Sub

Private Sub TO_STATE_BeforeUpdate(Cancel As Integer)
 
  If MsgBox("TO_STATE changes by Staff Only!  Are you sure you want to change this?" & vbCrLf & vbCrLf & _
       "If No, Click [No] then Press [Esc] Key for Origional Value.", vbYesNo + vbDefaultButton2, "Staff Only!") = vbNo Then
    Cancel = -1
  End If
End Sub
'Private Sub Command86_Click()
'On Error GoTo Err_Command86_Click
'    Screen.PreviousControl.SetFocus
'    DoCmd.FindNext
'Exit_Command86_Click:
'    Exit Sub
'Err_Command86_Click:
'    MsgBox Err.Description
'    Resume Exit_Command86_Click
'End Sub